<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta name="referrer" content="no-referrer"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2024 NewStar-Cryptoå¤ç° | Monday-Blog</title><meta name="author" content="Monday"><meta name="copyright" content="Monday"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="week1xoré¢˜ç›® 12345678910111213from pwn import xorfrom Crypto.Util.number import bytes_to_longkey &#x3D; b&#x27;New_Star_CTF&#x27;flag&#x3D;&#x27;flag&#123;*******************&#125;&#x27;m1 &#x3D; bytes_to_long(bytes(f">
<meta property="og:type" content="article">
<meta property="og:title" content="2024 NewStar-Cryptoå¤ç°">
<meta property="og:url" content="https://mondaying.cn/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="Monday-Blog">
<meta property="og:description" content="week1xoré¢˜ç›® 12345678910111213from pwn import xorfrom Crypto.Util.number import bytes_to_longkey &#x3D; b&#x27;New_Star_CTF&#x27;flag&#x3D;&#x27;flag&#123;*******************&#125;&#x27;m1 &#x3D; bytes_to_long(bytes(f">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mondaying.cn/img/51fde9041ff690de11db4c9dafbe0c01.jpg">
<meta property="article:published_time" content="2025-02-04T05:51:27.000Z">
<meta property="article:modified_time" content="2025-02-04T06:11:36.413Z">
<meta property="article:author" content="Monday">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="å¤ç°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mondaying.cn/img/51fde9041ff690de11db4c9dafbe0c01.jpg"><link rel="shortcut icon" href="/img/p1.png"><link rel="canonical" href="https://mondaying.cn/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 6 || hour >= 18
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æœªæ‰¾åˆ°ç¬¦åˆæ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2024 NewStar-Cryptoå¤ç°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-02-04 14:11:36'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="/css/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load', preloader.endLoading)

  if (true) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/p2.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/p1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> åˆ—è¡¨</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/51fde9041ff690de11db4c9dafbe0c01.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Monday-Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">2024 NewStar-Cryptoå¤ç°</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> åˆ—è¡¨</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">2024 NewStar-Cryptoå¤ç°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-02-04T05:51:27.000Z" title="å‘è¡¨äº 2025-02-04 13:51:27">2025-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-02-04T06:11:36.413Z" title="æ›´æ–°äº 2025-02-04 14:11:36">2025-02-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%8D%E7%8E%B0/">å¤ç°</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">7.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>33åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;flag&#123;*******************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag[:<span class="number">13</span>], encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">m2 = flag[<span class="number">13</span>:]</span><br><span class="line"></span><br><span class="line">c1 = m1 ^ bytes_to_long(key)</span><br><span class="line">c2 = xor(key, m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>,c2)</span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–ï¼Œpwnåº“é‡Œçš„xor()å‡½æ•°</p>
<p>åªè¦äº†è§£ä¸€ä¸‹å¼‚æˆ–è¿ç®—å°±å¯ä»¥è§£å†³ï¼Œè¿ç®—æ³•åˆ™ä¸ºï¼š0 âŠ• 0 = 0ï¼Œ1 âŠ• 0 = 1ï¼Œ0 âŠ• 1 = 1ï¼Œ1 âŠ• 1 = 0ï¼ˆåŒä¸º 0ï¼Œå¼‚ä¸º 1ï¼‰</p>
<p>ä¸€ä¸ªç‰¹ç‚¹æ˜¯pã€qå¼‚æˆ–çš„ç»“æœä¸å…¶ä¸­ä¸€ä¸ªå†è¿›è¡Œä¸€æ¬¡å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°å¦ä¸€ä¸ª</p>
<font style="color:rgb(60, 60, 60);">pwntools ä¸­</font>çš„ xor()ï¼Œå®ƒ<font style="color:rgb(60, 60, 60);">å¯ä»¥å°†ä¸åŒç±»å‹å’Œé•¿åº¦çš„æ•°æ®è¿›è¡Œå¼‚æˆ–</font>

<p>é¢˜ç›®å°†æ˜æ–‡åˆ†æˆä¸¤éƒ¨åˆ†m1å’Œm2,åˆ†åˆ«å’Œkeyè¿›è¡Œäº†å¼‚æˆ–è¿ç®—ï¼Œåªè¦å†æŠŠc1ã€c2å’Œkeyå¼‚æˆ–ä¸€æ¬¡ï¼Œç»“æœåˆèµ·æ¥ï¼Œå°±æ˜¯flagï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line"></span><br><span class="line">c1= <span class="number">8091799978721254458294926060841</span></span><br><span class="line">c2= <span class="string">b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = c1 ^ bytes_to_long(key)	<span class="comment"># è‡ªå¸¦çš„å¼‚æˆ–ç¬¦å·^åªèƒ½ç”¨äºæ•´æ•°ç±»å‹æ“ä½œ</span></span><br><span class="line">m2 = xor(key, c2)</span><br><span class="line">m1 = long_to_bytes(m1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m1+m2)</span><br><span class="line"><span class="comment"># flag&#123;0ops!_you_know_XOR!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h2><p><strong>é¢˜ç›®</strong></p>
<p>4C4A575851324332474E324547554B494A5A4446513653434E564D444154545A4B354D45454D434E4959345536544B474D5134513D3D3D3D</p>
<p><strong>è€ƒç‚¹</strong>ï¼šbaseç³»åˆ—ç¼–ç </p>
<p>ä¹‹å‰ç”¨çš„åœ¨çº¿ç½‘ç«™è¿›è¡Œè§£ç ï¼Œä½†è¯´å®è¯ï¼ŒæŒºå¤æ‚ï¼Œå› ä¸ºè¿™ä¸ªè¿›è¡Œäº†å¥½å‡ ä¸ªbaseç³»åˆ—çš„ç¼–ç ï¼Œçœ‹äº†å®˜æ–¹wpåçŸ¥é“äº†CyberChefï¼Œç”¨è¿™ä¸ªå°±å¯ä»¥ä¸€æŠŠæ¢­å“ˆ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1736225714200-dffbceb2-0045-48d7-a5bb-8e100fcb1739.png" alt=""></p>
<p>çœ‹äº†å®˜æ–¹wpåæ‰æƒ³èµ·æ¥æˆ‘å¯¹baseç¼–ç å…¶å®äº†è§£åˆ°ä¸å¤ªç†Ÿï¼Œçœ‹äº†ä¹‹åæ‰äº†è§£äº†ç¼–ç åŸç†</p>
<h2 id="ä¸€çœ¼ç§’äº†"><a href="#ä¸€çœ¼ç§’äº†" class="headerlink" title="ä¸€çœ¼ç§’äº†"></a>ä¸€çœ¼ç§’äº†</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> serct <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"><span class="comment"># 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šrsaï¼Œåˆ†è§£n</p>
<p>på’Œqéƒ½ä¸ç®—å¤ªå¤§ï¼Œç›´æ¥ç”¨åœ¨çº¿ç½‘ç«™åˆ†è§£ä¸€ä¸‹nï¼Œå¾—åˆ°pã€qåæŒ‰RSAè§£å¯†å°±è¡Œï¼ˆæ±‚phiï¼Œç„¶åæ±‚dï¼‰</p>
<p>ä½†æ˜¯è¡¥å……ä¸€ä¸‹yafuçš„ç”¨æ³•ï¼Œæ‰“å¼€cmdï¼Œè¾“å…¥yafu-x64.exeï¼Œä¹‹åè¾“å…¥factor(éœ€è¦åˆ†è§£çš„ç´ æ•°)ï¼Œå¦‚æœæ•°æ¯”è¾ƒå¤§ï¼Œå°±è¦æ”¾åˆ°txté‡Œï¼Œè®°å¾—å›è½¦ï¼Œç„¶åå†ä»cmdé‡Œè¾“å…¥yafu-x64.exe â€œfactor(@)â€ -batchfile D:\data.txtï¼Œæ¯æ¬¡ç”¨å®Œä¼šè‡ªåŠ¨åˆ é™¤è¿™ä¸ªtxtæ–‡ä»¶</p>
<p>æœ‰äº†på’Œqä¹‹åå°±æ²¡æœ‰éš¾åº¦äº†ï¼Œrsaè§£å¯†å°±è¡Œï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line">c=<span class="number">48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line">p=<span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421</span></span><br><span class="line">q=<span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;9cd4b35a-affc-422a-9862-58e1cc3ff8d2&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Strange-King"><a href="#Strange-King" class="headerlink" title="Strange King"></a>Strange King</h2><p><strong>é¢˜ç›®</strong></p>
<p>æŸå–œæ¬¢æŠ½é”åˆ» 5 çš„çš‡å¸æƒ³æ¯å¤©è¿›æ­¥ä¸€äº›ï¼Œç›´åˆ°ä»–å¨¶äº†ä¸ªæ¨¡ï¼Œå›åˆ°åŸç‚¹ï¼Œå…¨éƒ¨ç™½ç»™ğŸ˜… è¿™æ˜¯ä»–æœ€åç•™ä¸‹çš„è®¯æ¯ï¼š<code>ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;</code>ï¼Œflag åŒ…è£¹çš„æ˜¯å¯è¯»çš„æ˜æ–‡</p>
<p><strong>è€ƒç‚¹</strong>ï¼šå˜å¼‚å‡¯æ’’</p>
<p>æ˜¯å‡¯æ’’å¯†ç çš„å˜å½¢ï¼ŒæŠŠå¯†æ–‡å‰å››ä¸ªå­—ç¬¦å’Œflagå¯¹æ¯”å°±ä¼šå‘ç°ä»–ä»¬çš„asciiç å€¼åˆ†åˆ«å·®äº†5ã€7ã€9ã€11ï¼ˆå…¶å®é¢˜ç›®ä¹Ÿæé†’äº†é”åˆ»5å’Œæ¯å¤©è¿›æ­¥ä¸€ç‚¹ï¼Œè¯´æ˜ä¸€å¼€å§‹åç§»5ï¼Œé€æ¸åŠ 2ï¼‰ï¼Œç„¶åå–æ¨¡ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢è¶…å‡ºèŒƒå›´ï¼ˆä¸€å¼€å§‹æˆ‘æ¨¡æ²¡å–å¯¹ï¼Œæƒ³ç€æ˜¯å–asciiè¡¨çš„æ¨¡ï¼Œç„¶åå†™ä¸å¯¹ï¼Œå…¶å®åº”è¯¥å¤§å†™å­—æ¯å’Œå°å†™å­—æ¯åˆ†åˆ«å–26ï¼Œä½¿å…¶åœ¨å„è‡ªçš„èŒƒå›´é‡Œï¼‰ä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">&#x27;ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;&#x27;</span></span><br><span class="line">plain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> txt:</span><br><span class="line">    <span class="keyword">if</span> j.islower():</span><br><span class="line">        plain = plain + <span class="built_in">chr</span>(<span class="number">97</span> + (<span class="built_in">ord</span>(j) - i - <span class="number">97</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">elif</span> j.isupper():</span><br><span class="line">        plain = plain + <span class="built_in">chr</span>(<span class="number">65</span> + (<span class="built_in">ord</span>(j) - i - <span class="number">65</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plain = plain + j</span><br><span class="line">    i += <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="comment"># flag&#123;PleaseDoNotStopLearing&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ-ç–‘æƒ‘"><a href="#è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ-ç–‘æƒ‘" class="headerlink" title="è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ ç–‘æƒ‘"></a>è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ ç–‘æƒ‘</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">hint = p^e + <span class="number">10086</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[n, e] =&quot;</span>, [n, e])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint =&quot;</span>, hint)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line"><span class="string">[n, e] = [124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261, 65537]</span></span><br><span class="line"><span class="string">hint = 12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–ç¬¦å·çš„è¿ç®—ä¼˜å…ˆçº§</p>
<p>è¿™é“é¢˜éœ€è¦æ¸…æ¥šå¼‚æˆ–æ“ä½œçš„ä¼˜å…ˆçº§æ˜¯ä½äºä¹˜é™¤åŠ å‡çš„ï¼Œæ‰€æœ‰hintæ˜¯på’Œe+10086çš„å¼‚æˆ–ç»“æœï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°pï¼Œå†ç”¨næ•´é™¤å¾—åˆ°qï¼Œç„¶åå°±æ˜¯RSAè§£å¯†äº†ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Utill.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c = <span class="number">36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line">n = <span class="number">124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261</span></span><br><span class="line">hint = <span class="number">12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = hint ^ <span class="number">10086</span> + e</span><br><span class="line">q= n//p</span><br><span class="line">phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;yihuo_yuan_lai_xian_ji_suan_liang_bian_de2333&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Since-you-konw-something"><a href="#Since-you-konw-something" class="headerlink" title="Since you konw something"></a>Since you konw something</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment"># The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = ?? <span class="comment"># extremely short</span></span><br><span class="line">FLAG = <span class="string">&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line">c = bytes_to_long(xor(FLAG,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–</p>
<p>è¿™é“é¢˜è¦å†äº†è§£ä¸€ä¸‹pwntoolsåº“é‡Œçš„xorå‡½æ•°ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¿›è¡Œxor(data, key)ï¼Œé‚£ä¹ˆdataä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆå¯¹åº”çš„asciiå€¼ï¼Œåé¢åŒç†ï¼‰ä¼šå’Œkeyé‡Œçš„ç¬¬ä¸€ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œä¾æ­¤ç±»æ¨ï¼Œå½“dataçš„å­—èŠ‚æ•°è¶…è¿‡keyçš„é•¿åº¦æ—¶ï¼Œkeyä¼šä»å¤´å¼€å§‹é‡å¤ä½¿ç”¨ï¼Œç›´åˆ°dataä¸­çš„æ•°æ®å…¨éƒ¨å¤„ç†å®Œæ¯•</p>
<p>ä»é¢˜ç›®å¯ä»¥çŸ¥é“keyå¾ˆçŸ­ï¼Œæ°å·§æˆ‘ä»¬çŸ¥é“FLAGçš„å‰å‡ ä¸ªå­—èŠ‚ï¼ˆfalgï¼‰ï¼Œæ‰€ä»¥å¼‚æˆ–ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“keyæ˜¯â€™nsâ€™ï¼Œä¹‹åcå’Œkeyå†å¼‚æˆ–ä¸€æ¬¡å°±å¯ä»¥çŸ¥é“flagäº†ï¼ˆå¯¹ç§°æ€§ï¼‰ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment"># The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">c=<span class="number">218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line">FLAG = <span class="string">b&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line"><span class="built_in">print</span>(xor(c,FLAG))</span><br><span class="line">key = <span class="string">&#x27;ns&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(xor(c,key))</span><br><span class="line"><span class="comment"># flag&#123;Y0u_kn0w_th3_X0r_b3tt3r&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="èŒ¶é‡ŒèŒ¶æ°”"><a href="#èŒ¶é‡ŒèŒ¶æ°”" class="headerlink" title="èŒ¶é‡ŒèŒ¶æ°”"></a>èŒ¶é‡ŒèŒ¶æ°”</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;*****&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>( flag ) == <span class="number">25</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    a += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">int</span>(a,<span class="number">16</span>).bit_length()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;l  =&quot;</span> , l )</span><br><span class="line"></span><br><span class="line">v0 = <span class="built_in">int</span>(a,<span class="number">16</span>)&gt;&gt;(l//<span class="number">2</span>)</span><br><span class="line">v1 = <span class="built_in">int</span>(a,<span class="number">16</span>)-(v0&lt;&lt;(l//<span class="number">2</span>))</span><br><span class="line">p = getPrime(l//<span class="number">2</span>+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">v2 = <span class="number">0</span></span><br><span class="line">derta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line"><span class="keyword">assert</span> v1 &lt; p <span class="keyword">and</span> v0 &lt; p <span class="keyword">and</span> derta &lt; p <span class="keyword">and</span> v3 &lt; p <span class="keyword">and</span> v4 &lt; p <span class="keyword">and</span> v5 &lt; p <span class="keyword">and</span> v6 &lt; p </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v1 += (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line">    v0 += (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v2 += derta ; v2 %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;p  =&quot;</span> , p  )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v0 =&quot;</span> , v0 )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v1 =&quot;</span> , v1 )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">l  = 199</span></span><br><span class="line"><span class="string">p  = 446302455051275584229157195942211</span></span><br><span class="line"><span class="string">v0 = 190997821330413928409069858571234</span></span><br><span class="line"><span class="string">v1 = 137340509740671759939138452113480</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼š<font style="color:rgb(60, 60, 60);">TEAï¼ˆTiny Encryption Algorithmï¼‰åŠ å¯†ç®—æ³•</font></p>
<font style="color:rgb(60, 60, 60);">ä¸çŸ¥é“æ˜¯TEAåŠ å¯†ç®—æ³•ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºé€†æ¨å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼Œè‡ªå·±å†™ä¸€ä¸‹å°±å¾ˆæ¸…æ™°</font>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2025/jpeg/42554774/1736234814527-a03ceadd-3d09-4988-8361-ac5d3ea51057.jpeg" alt=""></p>
<font style="color:rgb(60, 60, 60);">æŠŠæœ€ç»ˆçš„V2æ±‚å‡ºæ¥åæŠŠé¡ºåºåè¿‡æ¥é€€å›å»å°±è¡Œï¼Œå°±æ”¹æˆå‡å·ï¼ŒæŠŠèµ·å§‹çš„V0å’ŒV1æ±‚å‡ºæ¥åï¼Œå°±å¯ä»¥æ±‚å‡ºæ¥aï¼ŒæŠŠaè½¬åå…­è¿›åˆ¶ï¼Œä¸¤ä½ä¸€ä¸ªè½¬å­—ç¬¦å°±å¯ä»¥æ±‚å‡ºflagï¼Œä»£ç å¦‚ä¸‹</font>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">v2 = <span class="number">0</span></span><br><span class="line">delta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line">l  = <span class="number">199</span></span><br><span class="line">p  = <span class="number">446302455051275584229157195942211</span></span><br><span class="line">v0 = <span class="number">190997821330413928409069858571234</span></span><br><span class="line">v1 = <span class="number">137340509740671759939138452113480</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( <span class="number">32</span> ):</span><br><span class="line">    v2 += delta ; v2 %= p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v2 -= delta ; v2 %= p</span><br><span class="line">    v0 -= (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v1 -= (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">hex</span>((v0&lt;&lt;((l//<span class="number">2</span>))) + v1)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(a[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;f14gg9_te2_1i_7ea_7&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Just-one-and-more-than-two"><a href="#Just-one-and-more-than-two" class="headerlink" title="Just one and more than two"></a>Just one and more than two</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q, r= (getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>))</span><br><span class="line">N=p*q*r</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\nr=<span class="subst">&#123;r&#125;</span>\nc1=<span class="subst">&#123;c1&#125;</span>\nc2=<span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line"><span class="string">q=11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line"><span class="string">r=12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line"><span class="string">c1=8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line"><span class="string">c2=1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šæ¬§æ‹‰å‡½æ•°</p>
<p>ä¸€é“RSAé¢˜ï¼Œflagè¢«åˆ†æˆä¸¤éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒåŠ å¯†ï¼Œc1æ˜¯m1é€šè¿‡eå’ŒpåŠ å¯†å¾—åˆ°ï¼Œc2æ˜¯m2é€šè¿‡eå’ŒNåŠ å¯†å¾—åˆ°ï¼Œè¦æ±‚m1å’Œm2å°±å¾—æ±‚å¯¹åº”çš„d1å’Œd2ï¼Œåªè¦äº†è§£ä¸€ä¸‹æ¬§æ‹‰å‡½æ•°å°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬å·²çŸ¥pã€qã€rï¼Œä¸”ä»–ä»¬éƒ½æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ</p>
<p>$ phi(p) = p - 1 $</p>
<p>$ phi(N) = (p -1)(q - 1)(r - 1) $</p>
<p>å†åˆ†åˆ«æ±‚ä¸€ä¸‹eå…³äºä»–ä»¬ä¸¤ä¸ªçš„é€†å…ƒå°±å¯ä»¥å¾—åˆ°d1å’Œd2ï¼Œåé¢å°±æ˜¯RSAè§£å¯†äº†ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line">q=<span class="number">11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line">r=<span class="number">12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line">c1=<span class="number">8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line">c2=<span class="number">1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">N = p*q*r</span><br><span class="line">d1 = gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">d2 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br><span class="line"><span class="comment"># flag&#123;Y0u_re4lly_kn0w_Euler_4nd_N3xt_Eu1er_is_Y0u!&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="æ²¡eè¿™èƒ½ç©"><a href="#æ²¡eè¿™èƒ½ç©" class="headerlink" title="æ²¡eè¿™èƒ½ç©"></a><strong>æ²¡eè¿™èƒ½ç©</strong></h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">h1 = <span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r</span><br><span class="line">h2 = <span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r</span><br><span class="line">h3 = <span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint_of_pqr=&quot;</span> , h1 , h2 , h3 )</span><br><span class="line"></span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">a_big_prime = getPrime( <span class="number">512</span> )</span><br><span class="line">hint = <span class="built_in">pow</span>(a_big_prime,e,<span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;big_prime is: &quot;</span> , a_big_prime )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint is: &quot;</span> , hint )</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">c = <span class="built_in">pow</span>( m , e , n )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;c=&quot;</span> , c )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">hint_of_pqr= 31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497 83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760 248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172 </span></span><br><span class="line"><span class="string">big_prime is:  10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line"><span class="string">hint is:  1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571 </span></span><br><span class="line"><span class="string">c= 999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šç¦»æ•£å¯¹æ•°</p>
<p>æ˜¯ä¸€é“RSAé¢˜ç›®ï¼Œnæ˜¯pã€qã€rçš„ä¹˜ç§¯ï¼Œè€Œé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬pqrä¹‹é—´çš„çº¿æ€§å…³ç³»ï¼ˆä¸‰ä¸ªæœªçŸ¥æ•°ï¼Œä¸‰ä¸ªæ–¹ç¨‹ï¼Œå¯ä»¥è§£å‡ºpã€qã€rï¼‰</p>
<p>é‚£æ¥ä¸‹æ¥å°±æ˜¯è¦æ±‚dï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰ç»™æˆ‘ä»¬eï¼Œç»™çš„æ˜¯a_big_prime<strong>e(mod 2</strong>512)</p>
<p>å‚è€ƒäº†ä¸€äº›åšå®¢ï¼ŒçŸ¥é“æ˜¯ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä¸å¤ªäº†è§£ç¦»æ•£å¯¹æ•°ï¼ˆä¹‹åä¼šå¤šçœ‹çœ‹çš„ï¼‰ï¼Œç„¶åç›´æ¥åœ¨ä¸€ä¸ªåšå®¢é‡Œå°±æ‰¾åˆ°äº†ä¸€ä¸ªåº“é‡Œçš„ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æ±‚å‡ºe</p>
<font style="color:rgb(77, 77, 77);">pythonçš„ sympyåº“discrete_logå‡½æ•°æ˜¯ä¸“é—¨æ±‚æŒ‡æ•°çš„ï¼Œdiscrete_log(x,y,z)ï¼Œxä¸ºæ¨¡æ•°ï¼Œyä¸ºä½™æ•°ï¼Œzä¸ºåº•æ•°</font>

<p>ç”¨è¿™ä¸ªå‡½æ•°æ±‚å‡ºæ¥eåå°±æ˜¯RSAè§£å¯†çš„ç»å…¸è¿‡ç¨‹äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">h1 = <span class="number">31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497</span></span><br><span class="line">h2 = <span class="number">83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760</span></span><br><span class="line">h3 = <span class="number">248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172</span></span><br><span class="line">big_prime= <span class="number">10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line">hint=      <span class="number">1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571</span></span><br><span class="line">c= <span class="number">999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">3</span> * h1 - h2</span><br><span class="line">r = (<span class="number">9</span> * h1 - h3)//<span class="number">3</span></span><br><span class="line">q = h1 - p - r</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e = sympy.discrete_log(<span class="number">2</span>**<span class="number">512</span>,hint,big_prime)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;th1s_2s_A_rea119_f34ggg&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ•…äº‹æ–°ç¼–"><a href="#æ•…äº‹æ–°ç¼–" class="headerlink" title="æ•…äº‹æ–°ç¼–"></a>æ•…äº‹æ–°ç¼–</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">zen1  = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">key1 = </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc1</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_char</span>(<span class="params">c, k</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(((<span class="built_in">ord</span>(c) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + (<span class="built_in">ord</span>(k) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    plaintext = plaintext.upper()</span><br><span class="line">    key = key.upper()</span><br><span class="line">    ciphertext = []</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            ciphertext.append(shift_char(char, key[key_index % <span class="built_in">len</span>(key)]))</span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc = \&#x27;\&#x27;\&#x27;&#x27;</span> + enc1(zen1, key1)+<span class="string">&#x27;\&#x27;\&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(zen1.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#----------------------------------------------</span></span><br><span class="line">enc = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">TYBNBBZNT WF TYUMMK NAIB HYFZ.</span></span><br><span class="line"><span class="string">XFIFBKWG AM CXBMYK BVNF CNITBWBB.</span></span><br><span class="line"><span class="string">GVEJMX QL VXBHRJ NITV VIFXZRP.</span></span><br><span class="line"><span class="string">WPFXEYQ QG OWNUXZ MBTV QBEJMBKTNXL.</span></span><br><span class="line"><span class="string">TYSN JL JXNMMF GZUO GMLNXL.</span></span><br><span class="line"><span class="string">GCSLTX QL VXBHRJ NITV WYGAS.</span></span><br><span class="line"><span class="string">SDUHT QL PXOSAWLF</span></span><br><span class="line"><span class="string">KMTXTJWYANZ VWNHMA.</span></span><br><span class="line"><span class="string">GCWWJTT VULMG NJYO&#x27;M AIYVQOY WHPNOA NH JFRSE UAM KOEMG.</span></span><br><span class="line"><span class="string">NDNIHCZB IZOPLCDTTBNR JSNLM QNZBNR.</span></span><br><span class="line"><span class="string">MFEGLT LPHOEL BRNYS IILM LQZRFNMR.</span></span><br><span class="line"><span class="string">CGFXAG RPJMBKBNEG GVDYOVMW.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šç»´å‰å°¼äºšçˆ†ç ´</p>
<p>é¢˜ç›®æ˜¯å®šä¹‰äº†ä¸€ä¸ªencå‡½æ•°ï¼Œå®ƒæ¥æ”¶æ˜æ–‡å’Œå¯†é’¥ï¼Œç„¶åå°†å®ƒä»¬å…¨éƒ¨å¤§å†™ï¼Œç„¶åæ˜æ–‡é‡Œçš„æ¯ä¸ªå­—ç¬¦ä¾æ¬¡ç§»åŠ¨å¯†æ–‡å¯¹åº”å­—ç¬¦çš„ASCIIå€¼ï¼ˆå‡å»â€™Aâ€™åçš„å€¼ï¼‰çœ‹åˆ°è¿™é‡Œï¼Œå¦‚æœå¤å…¸å¯†ç è®°å¾—ç†Ÿçš„è¯åº”è¯¥å°±èƒ½ååº”è¿‡æ¥è¿™æ˜¯ä¸€ä¸ªç»´å‰å°¼äºšå¯†ç <del>ï¼ˆæˆ‘å—ï¼Ÿæˆ‘è®°ä¸ä½ï¼Œæˆ‘é—®AIçš„ï¼Œå®ƒå‘Šè¯‰æˆ‘çš„ï¼‰</del></p>
<p>é‚£çŸ¥é“æ˜¯ç»´å‰å°¼äºšåŠ å¯†äº†ï¼Œæ‰¾åˆ°å¯†é’¥ä¸å°±è§£å‡ºæ¥äº†<del>ï¼Œå—¯ï¼Ÿæ²¡ç»™æˆ‘å¯†é’¥ï¼Ÿé‚£å°±è·Ÿä½ çˆ†äº†ï¼</del> æ˜¯çš„ï¼Œæ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹è¿ç”¨åœ¨çº¿ç½‘ç«™çˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°æ˜æ–‡äº†ï¼Œæˆ‘å°±æ˜¯ç”¨çš„<a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">é“¾æ¥</a>ç½‘å€çš„åœ¨çº¿å·¥å…·</p>
<p>ä¹‹åMD5åŠ å¯†åçš„åå…­è¿›åˆ¶è½¬å­—èŠ‚ï¼Œæ‰“å°å‡ºæ¥å°±æ˜¯äº†</p>
<p>è‡³äºæ•…äº‹æ–°ç¼–2ï¼Œæ˜¯<font style="color:rgb(60, 60, 60);">è‡ªåŠ¨å¯†é’¥å¯†ç ï¼Œä¸æ•…äº‹æ–°ç¼– 1 ç›¸ç±»ä¼¼ã€‚æ˜¯ç»´å‰å°¼äºšçš„å˜å¼‚ï¼Œåœ¨ä¸Šé¢é‚£ä¸ªç½‘ç«™ä¹Ÿèƒ½çˆ†ç ´ï¼Œéƒ½å¯ä»¥æ±‚å‡ºflag</font></p>
<font style="color:rgb(60, 60, 60);"></font>

<h2 id="ä¸ç”¨è°¢å–µ"><a href="#ä¸ç”¨è°¢å–µ" class="headerlink" title="ä¸ç”¨è°¢å–µ"></a><font style="color:rgb(60, 60, 60);">ä¸ç”¨è°¢å–µ</font></h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">b&quot;fake_key_fake_ke&quot;</span></span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;fake_flag_fake_flag&#125;&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    AES_ECB = AES.new(KEY, AES.MODE_ECB)</span><br><span class="line">    decrypted = AES_ECB.decrypt(long_to_bytes(c))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    AES_CBC = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">    encrypted = AES_CBC.encrypt(FLAG.encode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;iv:&#x27;</span>,iv.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iv.<span class="built_in">hex</span>() + encrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">c=encrypt()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;encrypt:&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;decrypt:&#x27;</span>,decrypt(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#encrypt: f2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line"><span class="comment">#ä»€ä¹ˆæ˜¯AESå•ŠğŸ˜­ï¼Œæ±‚æ±‚ä½ å¸®æˆ‘è§£å¯†å§ï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¼šåšçš„ï¼ï¼ï¼ï¼ï¼ğŸ˜­</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ä»€ä¹ˆéƒ½ä¼šåšï¼Ÿé‚£å°±å»å­¦ä¹ ä¸€ä¸‹AESçš„å·¥ä½œæ¨¡å¼å§â€¦â€¦</span></span><br><span class="line"><span class="string">æˆ‘è¿™æ¬¡å°±å…ˆç»™ä½ è§£ä¸€ä¸‹å¥½äº†ï¼Œä¸ç”¨è°¢å–µ</span></span><br><span class="line"><span class="string">decrypt: f9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"><span class="string">è¿™å¯¹å—ï¼Ÿå“¦ä¸å¯¹ä¸å¯¹ï¼Œå“¦å¯¹çš„å¯¹çš„ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šAESçš„ä¸åŒåˆ†ç»„æ¨¡å¼</p>
<p>è¿™é“é¢˜å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªCBCåˆ†ç»„æ¨¡å¼çš„AESåŠ å¯†å‡½æ•°ï¼›ä¸€ä¸ªæ˜¯ECBåˆ†ç»„æ¨¡å¼çš„AESè§£å¯†å‡½æ•°ã€‚</p>
<p>CBCæ¨¡å¼æ˜¯å¯¹æ¯ä¸ªå—éƒ½ä½¿ç”¨åŒä¸€ä¸ªkeyè¿›è¡Œå—åŠ å¯†ï¼Œä½†å—åŠ å¯†ä¹‹å‰ï¼Œå…ˆå°†æ˜æ–‡å—ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–è®¡ç®—ï¼Œç„¶åå†å¯¹å¼‚æˆ–è®¡ç®—ç»“æœè¿›è¡Œå—åŠ å¯†ã€‚å¯¹äºé¦–ä¸ªæ˜æ–‡å—ï¼Œå› ä¸ºä¸å­˜åœ¨å‰ä¸€ä¸ªå¯†æ–‡å—ï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„ä¸€ä¸ªå­—èŠ‚æ•°ç»„æ¥å……å½“â€å‰ä¸€ä¸ªå¯†æ–‡å—â€ï¼Œè¿™ä¸ªå­—èŠ‚æ•°ç»„è¢«ç§°ä¸ºåˆå§‹åŒ–å‘é‡ï¼ŒIVã€‚è§£å¯†æ—¶è¦æŠŠå’Œkeyè¿›è¡Œå—è§£å¯†æ“ä½œåçš„å—å’Œå‰ä¸€ä¸ªå¯†æ–‡å—ï¼ˆç¬¬ä¸€ä¸ªå¯†æ–‡å—å’Œivï¼‰å¼‚æˆ–åæ‰èƒ½å¾—åˆ°æ˜æ–‡å—ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1728642690114-23f34435-6fc5-4ece-9d53-aabee58c6680.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_1125%2Climit_0" alt=""></p>
<p>ECBæ˜¯æœ€ç®€å•çš„ä¸€ä¸ªåˆ†ç»„æ¨¡å¼ï¼ˆåº”è¯¥æ˜¯ï¼‰ï¼Œå¯¹æ¯ä¸€ä¸ªå—çš„åŠ å¯†éƒ½æ˜¯ä½¿ç”¨åŒæ ·çš„keyï¼ŒåŒæ ·çš„æ˜æ–‡å—ä¸€å®šä¼šè¢«åŠ å¯†æˆåŒæ ·çš„å¯†æ–‡å—ã€‚è§£å¯†è¿‡ç¨‹å°±æ˜¯æŠŠæ¯ä¸€ä¸ªå—å’Œkeyè¿›è¡Œå—è§£å¯†æ“ä½œå°±å¯ä»¥äº†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1728642677785-40fe2fba-9d49-48fc-a382-a271a009ed79.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_994%2Climit_0" alt=""></p>
<p>é‚£ä¹ˆå·²çŸ¥æ˜æ–‡æ˜¯è¢«encrypt()å‡½æ•°åŠ å¯†çš„ï¼Œæ˜¯ä¸€ä¸ªCBCæ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦çŸ¥é“ivå’Œkeyå°±å¯ä»¥è§£å¯†äº†ï¼Œivå…¶å®å¾ˆå¥½çŸ¥é“ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“encryptï¼Œå®ƒæ˜¯ivå’Œå¯†æ–‡çš„åå…­è¿›åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ivæ˜¯16ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆencryptçš„å‰32ä¸ªå­—ç¬¦å°±æ˜¯ivï¼ˆæ¯ä¸ªå­—èŠ‚å¯¹åº”ä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦æ•°ï¼‰</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“keyå‘€ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å–µå¸®æˆ‘ä»¬å¹²äº†ä»€ä¹ˆï¼Œå—¯ï¼Œå®ƒç”¨ECBæ¨¡å¼è§£å¯†äº†æˆ‘ä»¬çš„æ˜æ–‡ï¼Œè¿™ä¸å¯¹å§ï¼Ÿä½†æ˜¯åªè¦æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°ç”¨ECBæ¨¡å¼è§£å¯†å’ŒCBCæ¨¡å¼å°±å·®ä¸€æ­¥å¼‚æˆ–ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨çŸ¥é“keyäº†ï¼Œåªè¦å¼‚æˆ–å°±è¡Œäº†</p>
<p>å®˜æ–¹wpå¾ˆå·§å¦™ï¼ŒæŠŠæ‰€æœ‰è½¬æˆå­—èŠ‚å‹å†ç–‘æƒ‘ï¼Œåé¢æŸ¥äº†ä¸€ä¸‹å‘ç°åè¿›åˆ¶å’Œåå…­è¿›åˆ¶long_to_bytesçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯é•¿è§è¯†äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b , bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"></span><br><span class="line">c = <span class="number">0xf2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line">d = <span class="number">0xf9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"></span><br><span class="line">part1=l2b( b2l(l2b(c)[<span class="number">0</span>:<span class="number">16</span>]) ^ b2l(l2b(d)[<span class="number">16</span>:<span class="number">32</span>]))</span><br><span class="line">part2=l2b( b2l(l2b(c)[<span class="number">16</span>:<span class="number">32</span>]) ^ b2l(l2b(d)[<span class="number">32</span>:<span class="number">48</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(part1+part2)</span><br><span class="line"><span class="comment"># flag&#123;HOw_c4REfu1Ly_yOu_O65ERve!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³"><a href="#ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³" class="headerlink" title="ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³"></a>ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    delta = getPrime(<span class="number">1024</span>)</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    N = p * q</span><br><span class="line">    <span class="keyword">if</span> delta&lt;N:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;xxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">t1 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">t2 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line"><span class="keyword">assert</span> (t1 != t2)</span><br><span class="line">m1 = m + t1 * delta</span><br><span class="line">m2 = m + t2 * delta</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, N)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>, c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;delta = &quot;</span>, delta)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e =  683</span></span><br><span class="line"><span class="string">c1 =  56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line"><span class="string">c2 =  89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line"><span class="string">N =  147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line"><span class="string">delta =  93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šå…³è”ä¿¡æ¯æ”»å‡»ï¼Œå¤šé¡¹å¼gcd</p>
<p>æ€»çš„æ¥è¯´å°±æ˜¯æ‰¾åˆ°ä¸¤ä¸ªå¤šé¡¹å¼çš„å…¬å› å­ï¼Œè€Œè¿™ä¸ªå€¼å¤§æ¦‚ç‡å°±æ˜¯m1ï¼Œä¹‹åå°±å¯ä»¥æ±‚è§£å‡ºæ˜æ–‡ã€‚ä½†å…·ä½“åŸç†æœ‰ç‚¹å¤æ‚ï¼Œç”¨åˆ°äº†Half-GCD ç®—æ³•ï¼Œä¹‹åç»†æ‰£</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x ^ m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x ^ m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">related_message_attack</span>(<span class="params">a, b</span>):</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> related_message_attack(d, r)</span><br><span class="line"></span><br><span class="line">e =  <span class="number">683</span></span><br><span class="line">c1 =  <span class="number">56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line">c2 =  <span class="number">89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line">N =  <span class="number">147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line">delta =  <span class="number">93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"></span><br><span class="line">is_flag = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> delt <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">255</span>, <span class="number">255</span>, <span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">    f = x ^ e - c1</span><br><span class="line">    g1 = ((x + (delt + <span class="number">0</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">1</span>) * delta) ^ e - c2)</span><br><span class="line">    g2 = ((x + (delt + <span class="number">2</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">3</span>) * delta) ^ e - c2)</span><br><span class="line">    g3 = ((x + (delt + <span class="number">4</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">5</span>) * delta) ^ e - c2)</span><br><span class="line">    g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">7</span>) * delta) ^ e - c2)</span><br><span class="line">    <span class="keyword">if</span> delt == -<span class="number">7</span>:</span><br><span class="line">        g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2)</span><br><span class="line">    g = g1 * g2 * g3 * g4</span><br><span class="line">    res = related_message_attack(f, g)</span><br><span class="line">    m1 = <span class="built_in">int</span>(-res.monic().coefficients()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> t1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        m = (m1 % N - t1 * delta) % N</span><br><span class="line">        <span class="keyword">if</span> m &gt; <span class="number">0</span>:</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            <span class="keyword">if</span> flag[:<span class="number">4</span>] ==<span class="string">b&#x27;flag&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                is_flag = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_flag:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># flag&#123;V_me_the_flag&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h1><h2 id="åœ£çŸ³åŒ•é¦–"><a href="#åœ£çŸ³åŒ•é¦–" class="headerlink" title="åœ£çŸ³åŒ•é¦–"></a>åœ£çŸ³åŒ•é¦–</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">beta=<span class="number">0.37</span></span><br><span class="line">delta=<span class="number">0.01</span></span><br><span class="line">n=<span class="built_in">round</span>((<span class="number">1</span>-<span class="number">2</span>*beta-<span class="number">2</span>*delta)/((<span class="number">1</span>-beta)^<span class="number">2</span>-<span class="number">2</span>*delta-beta),<span class="number">6</span>)</span><br><span class="line">e= <span class="number">3668637434348843171145584606519031375027610199908169273169275927238735031431533260375377791001464799116453803408104076615710166171199990283470548282669948353598733020244755959461974603778630346457439345913209321194112256348302765254052193562603687450740346132207444615610078198488883539133291840346099727880587092122957231085658576850601488737629051252914095889313671875244094452330062619943781809984690384476868543570724769198985172300665613239047649089399919032152539462701309393130614829962670866062380816370571057536421400102100259975636785825540933280194583888638501981649650640939392658268133881679239293596283</span></span><br><span class="line">N= <span class="number">9748523098652101859947730585916490335896800943242955095820326993765071194474558998322598145898741779502734772138283011560029368500998354183150180904846368209977332058847768859238711047784703104535311583123388923571789764758869419482184613566672922481672444028753365755071127320541645016370072493604532087980626825687519083734367691341907014061379844209864141989961751681235215504772582878202048494707090104738899927036896915997556102574747166491969027546256022019959716418675672979328622656831990050058120299353807110233202113906317969377201045402271911946244076903611612303290556012512559696538977841061277173754331</span></span><br><span class="line">c= <span class="number">5374936627659221745209010619827617207565185520404653329184605916859755641352457088986635357806048863755173540232471505333583684733535121482637476692432365062808450583470788320547816186936317927449796090525477205337038591439577855884910604383190932340306435201976465543731935147881754136301375206828970248293731391543905441514528959500307972606931927112031018356411970001312995489429650903529877904694901310020882390008248466887950986326522740278880600110217817950511478637493101027659292006016454642135508207492151610829525082829566392116546434101694921106423469015683277992978077101831969525458693031031468092418427</span></span><br><span class="line">n=<span class="built_in">int</span>(n+<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(n)</span></span><br><span class="line">m=<span class="built_in">int</span>(n*(<span class="number">1</span>-beta))</span><br><span class="line">X=<span class="built_in">int</span>(<span class="built_in">pow</span>(N,delta))</span><br><span class="line">Y=<span class="built_in">int</span>(<span class="built_in">pow</span>(N,delta+beta))</span><br><span class="line">Z.&lt;x,y&gt;=ZZ[]</span><br><span class="line">L=Matrix(ZZ,n,n)</span><br><span class="line">f=e*x-y</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    g=<span class="built_in">list</span>(N^<span class="built_in">max</span>(<span class="number">0</span>,m-i)*x^(n-<span class="number">1</span>-i)*f^i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(g)):</span><br><span class="line">        L[i,j]=g[j][<span class="number">0</span>]*X^(n-<span class="number">1</span>-j)*Y^j</span><br><span class="line">L=L.LLL()[<span class="number">0</span>]</span><br><span class="line">coeff=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    coeff.append((L[i]//(X^(n-<span class="number">1</span>-i)*Y^i),<span class="string">&#x27;x&#x27;</span>+<span class="string">&#x27;**&#x27;</span>+<span class="built_in">str</span>(n-<span class="number">1</span>-i)+<span class="string">&#x27;*y&#x27;</span>+<span class="string">&#x27;**&#x27;</span>+<span class="built_in">str</span>(i)))</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(coeff)):</span><br><span class="line">    s+=<span class="built_in">str</span>(coeff[i][<span class="number">0</span>])+<span class="string">&#x27;*&#x27;</span>+coeff[i][<span class="number">1</span>]+<span class="string">&#x27;+&#x27;</span></span><br><span class="line">f=<span class="built_in">eval</span>(s[:-<span class="number">1</span>])</span><br><span class="line">factored_f = f.factor()</span><br><span class="line">first_polynomial = factored_f[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">first_coefficient = first_polynomial.coefficients()[<span class="number">0</span>]</span><br><span class="line">k = first_coefficient + <span class="number">1</span></span><br><span class="line">dp = first_polynomial.coefficients()[<span class="number">1</span>]</span><br><span class="line">p=(e*dp-<span class="number">1</span>)//k+<span class="number">1</span></span><br><span class="line">q=N//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯ä¸€ä¸ªsageæ–‡ä»¶ï¼Œåœ¨sagemathé‡Œé¢è¿è¡Œå°±è¡Œäº†ï¼Œå°±æ˜¯è¿è¡Œæ¯”è¾ƒä¹…ï¼ˆæˆ‘å°±å¤åˆ¶åˆ°Jupyterä¸Šè¿è¡Œä¸€ä¸‹å°±è¡Œäº†ï¼‰</p>
<p>flag{small_dp_is_not_secure_adhfaiuhaph}</p>
<h2 id="æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼"><a href="#æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼" class="headerlink" title="æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼"></a>æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*********&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        x = (<span class="number">1</span> &lt;&lt; bits) - <span class="number">1</span> ^ p</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">10</span>, <span class="number">11</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(x + i):</span><br><span class="line">                <span class="keyword">return</span> p, x + i, i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q, i = get_prime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i =&quot;</span>, i)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line"><span class="string">n = 18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line"><span class="string">i = -3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šäºŒè¿›åˆ¶åŠ æ³•ï¼Œé—´æ¥æ±‚æ¬§æ‹‰å‡½æ•°</p>
<p>æˆ‘ä»¬æœ‰ä»¥ä¸‹å¼å­</p>
<p>$ x = (1 &lt;&lt; bits) - 1 \text{^} p $</p>
<p>é‚£ä¹ˆå°±è¦äº†è§£ä¸€ä¸‹äºŒè¿›åˆ¶åŠ æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">0b1001</span></span><br><span class="line">b = a ^ <span class="number">0b1111</span> = <span class="number">0b0110</span></span><br><span class="line">a + b = <span class="number">1111</span></span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰æˆ‘ä»¬æœ‰$ x + p= (1 &lt;&lt; bits) - 1 $</p>
<p>ç„¶å1&lt;&lt;512æ˜¯$ 2^{512} $</p>
<p>æ‰€ä»¥$ x + p= 2^{512} - 1 $</p>
<p>æ‰€ä»¥$ p+q = p+x+i=2^{512}-1+i $</p>
<p>$ phi(n)=(p-1)(q-1)=pq-(p+q)+1=n-2^{512}+2-i $</p>
<p>åé¢å°±æ²¡æœ‰éš¾åº¦äº†ï¼Œæ±‚å‡ºdæ­£å¸¸æ±‚è§£å°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line">n = <span class="number">18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line">i = -<span class="number">3</span></span><br><span class="line">phi = n - <span class="number">2</span>**<span class="number">512</span> + <span class="number">2</span> - i</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;y0u_really_kn0w_the_phi&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ä¿±ä»¥æˆ‘ä¹‹å"><a href="#ä¿±ä»¥æˆ‘ä¹‹å" class="headerlink" title="ä¿±ä»¥æˆ‘ä¹‹å"></a>ä¿±ä»¥æˆ‘ä¹‹å</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">8</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    padded_msg = pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;\x00&quot;</span> + msg + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> padded_msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">All_in_my_name</span>(<span class="params">p, q</span>):</span><br><span class="line">    <span class="comment">#å¼€å¯ä¸‰æŠ€èƒ½&lt;ä¿±ä»¥æˆ‘ä¹‹å&gt;åï¼Œç»´å¨œç«‹å³åœ¨å‘¨å›´å…«æ ¼å¯éƒ¨ç½²åœ°é¢å¬å”¤â€œé»„é‡‘ç›Ÿèª“(Golden_Oath)â€;å¯¹RSAé€ æˆçœŸå®ä¼¤å®³ã€‚</span></span><br><span class="line">    Golden_Oath = (p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>)</span><br><span class="line">    x = bytes_to_long(pad(gift, random.randint(bytes_to_long(gift).bit_length(), <span class="number">512</span>)))</span><br><span class="line">    y = inverse(x, Golden_Oath)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">gift = <span class="string">b&#x27;?????&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> gift[:<span class="number">3</span>] == <span class="string">b&#x27;end&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;All_in_my_name = <span class="subst">&#123;All_in_my_name(p, q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line"><span class="string">c = 104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line"><span class="string">All_in_my_name = 217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šç»´å¨œæ”»å‡»</p>
<p>å½“eè¿‡å¤§æˆ–è¿‡å°çš„æ—¶å€™æˆ‘ä»¬éƒ½å¯ä»¥è€ƒè™‘ç»´çº³æ”»å‡»ï¼Œå½“ç„¶è¿˜è¦æ»¡è¶³$ d&lt;\frac{1}{3}n^{\frac{1}{4}} $,ä¸”$ q&lt;p&lt;2q $</p>
<p>æˆ‘ä»¬ç®€å•æ¨ä¸€ä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“$ n=p*q $</p>
<p>$ phi(n)=(p-1)(q-1)=pq -(p+q)+1 $</p>
<p>å› ä¸ºpå’Œqéƒ½æ˜¯éå¸¸å¤§çš„æ•°ï¼Œæˆ‘ä»¬è¿‘ä¼¼å¤„ç†ånå’Œphi(n)å°±å·®ä¸å¤šå¤§ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“$ ed=1 \mod phi(n) $</p>
<p>æ‰€ä»¥$ ed = k\times phi(n)+1 $ï¼Œä¸¤è¾¹åŒæ—¶é™¤ä»¥$ d*phi(n) $</p>
<p>å¾—åˆ°$ \frac{e}{phi(n)}=\frac{k}{d}+\frac{1}{d\times phi(n)} $</p>
<p>åŒæ ·çš„$ d*phi(n) $æ˜¯å¾ˆå¤§çš„æ•°ï¼Œ$ \frac{1}{d\times phi(n)} $å¯ä»¥å¿½ç•¥ï¼Œphi(n)ç”¨næ¥ä»£æ›¿ï¼Œå°±å¯ä»¥å¾—åˆ°$ \frac{e}{n}=\frac{k}{d} $</p>
<p>eå’Œnéƒ½æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿åˆ†æ•°å±•å¼€ï¼Œå¾—åˆ°kå’Œdçš„å¯èƒ½å€¼(åŸç†è¿˜æ²¡ææ‡‚ï¼Œç›®å‰åªèƒ½ç›´æ¥ç”¨)</p>
<p>è¿™é‡Œçš„â€ä¿±ä»¥æˆ‘ä¹‹åâ€å°±æ˜¯ä¸€ä¸ªç»´çº³æ”»å‡»(æ˜¯çš„ï¼Œæˆ‘ç©èˆŸ)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æ‰¾èƒ½è¿åˆ†æ•°å±•å¼€çš„å¼å­</p>
<p>$ xy=1\mod Golden_Oath $</p>
<p>æ‰€ä»¥$ \frac{y}{Golden_Oath}=\frac{k}{x} $</p>
<p>å…¶ä¸­$ Golden_Oath = (p-114)(p-514)(p+114)(p+514)(q-1919)(q-810)(q+1919)(q+810)<br> $æˆ‘ä»¬å¯ä»¥çœ‹æˆ$ n^4 $</p>
<p>é‚£æˆ‘ä»¬å¯¹è¿™ä¸ªå¼å­è¿›è¡Œè¿åˆ†æ•°å±•å¼€ï¼Œå°±èƒ½æ‰¾åˆ°ä¸€ç³»åˆ—è¿‘ä¼¼å€¼ï¼Œå†åˆ¤æ–­ä¸€ä¸‹â€™endâ€™åœ¨ä¸åœ¨æ±‚å‡ºæ¥çš„xé‡Œå°±å¯ä»¥æ‰¾åˆ°xäº†ï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line">c = <span class="number">104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line">y = <span class="number">217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="variable language_">self</span>.numberlist = []</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist = []</span><br><span class="line">        <span class="variable language_">self</span>.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        <span class="variable language_">self</span>.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            <span class="variable language_">self</span>.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist.append([<span class="variable language_">self</span>.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>.numberlist)):</span><br><span class="line">            numerator = <span class="variable language_">self</span>.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * <span class="variable language_">self</span>.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            <span class="variable language_">self</span>.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">pow</span>(n,<span class="number">4</span>)</span><br><span class="line">a = ContinuedFraction(y, n)</span><br><span class="line"><span class="keyword">for</span> k, x <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="comment"># åˆ¤æ–­å“ªä¸€ä¸ªæ˜¯æˆ‘ä»¬æ‰€éœ€çš„ x</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;end&#x27;</span> <span class="keyword">in</span> long_to_bytes(x):</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line">Golden_Oath = (x*y-<span class="number">1</span>)//k</span><br><span class="line"><span class="built_in">print</span>(Golden_Oath)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">103697213497220650500739251621743955651854455782387759691953279488676501281257640431561</span></span><br><span class="line"><span class="string">56398712132783063027132828918468670442692437484816382768162819797891220782528221182512</span></span><br><span class="line"><span class="string">b&#x27;5`\xf4\xf6t\xa3\x00end1n9_A_G2@nd_Ov3RTu2e\x1c\x13&quot;H\x0f\xc9&#x27;</span></span><br><span class="line"><span class="string">#400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æœ‰äº†Golden_Oathï¼Œä¹ŸçŸ¥é“n=p*qï¼Œè§£ä¸ªæ–¹ç¨‹å°±å¯ä»¥æ±‚å‡ºæ¥på’Œqäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Golden_Oath = <span class="number">400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">equation1 = Eq(p * q, n)</span><br><span class="line">equation2 = Eq((p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>), Golden_Oath)</span><br><span class="line">solutions = solve((equation1, equation2), (p, q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p å’Œ q çš„è§£: <span class="subst">&#123;solutions&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p å’Œ q çš„è§£: [(-11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, -12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151), (11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, 12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æœ‰äº†pï¼Œqåå°±æ ‡å‡†RSAè§£å¯†è¿‡ç¨‹æŠ¬èµ°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329</span></span><br><span class="line">q = <span class="number">12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;rE@L_d@m@9e_15_7h3_mo5t_au7hEn7ic_dam49E&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="week5"><a href="#week5" class="headerlink" title="week5"></a>week5</h1><h2 id="RSAï¼Ÿcmd5ï¼"><a href="#RSAï¼Ÿcmd5ï¼" class="headerlink" title="RSAï¼Ÿcmd5ï¼"></a>RSAï¼Ÿcmd5ï¼</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»€ä¹ˆï¼Ÿä½ è¯´ä½ ç”¨ MD5 ç»™ RSA ç­¾åäº†ï¼Ÿï¼</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;*******&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(m) == <span class="number">7</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_MD5</span>(<span class="params">m0</span>):</span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    md5_object = hashlib.md5(m0.encode())</span><br><span class="line">    md5_result = md5_object.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> md5_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_s</span>(<span class="params">m0, d0, n0</span>):</span><br><span class="line">    hm0 = get_MD5(m0)</span><br><span class="line">    hm1 = bytes_to_long(hm0.encode())</span><br><span class="line">    s0 = <span class="built_in">pow</span>(hm1, d0, n0)</span><br><span class="line">    <span class="keyword">return</span> s0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encode</span>(<span class="params">m0, e0, n0</span>):</span><br><span class="line">    m1 = bytes_to_long(m0.encode())</span><br><span class="line">    c0 = <span class="built_in">pow</span>(m1, e0, n0)</span><br><span class="line">    <span class="keyword">return</span> c0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">m0</span>):  <span class="comment"># è¯·ç”¨è¿™ä¸ªå‡½æ•°æ¥è½¬må¾—åˆ°flag</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m0 + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m0.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = get_s(m, d, n)</span><br><span class="line">c = rsa_encode(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¯†æ–‡c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç­¾ås =&quot;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å…¬é’¥[n,e] =&quot;</span>, [n, e])</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å¯†æ–‡c = 119084320846787611587774426118526847905825678869032529318497425064970463356147909835330423466179802531093233559613714033492951177656433798856482195873924140269461792479008703758436687940228268475598134411304167494814557384094637387369282900460926092035234233538644197114822992825439656673482850515654334379332</span></span><br><span class="line"><span class="string">ç­¾ås = 5461514893126669960233658468203682813465911805334274462134892270260355037191167357098405392972668890146716863374229152116784218921275571185229135409696720018765930919309887205786492284716906060670649040459662723215737124829497658722113929054827469554157634284671989682162929417551313954916635460603628116503</span></span><br><span class="line"><span class="string">å…¬é’¥[n,e] = [139458221347981983099030378716991183653410063401398496859351212711302933950230621243347114295539950275542983665063430931475751013491128583801570410029527087462464558398730501041018349125941967135719526654701663270142483830687281477000567117071676521061576952568958398421029292366101543468414270793284704549051, 65537]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šRSAæ•°å­—ç­¾å</p>
<p>ä¸€çœ¼çœ‹ä¸‹æ¥æ˜¯å¾ˆæ­£å¸¸çš„ä¸€ä¸ªRSAåŠ å¯†ï¼Œå¤šå°±å¤šåœ¨è¿™ä¸ªsï¼Œæ‰€ä»¥æˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹sçš„å‡½æ•°ï¼Œå®ƒä¼ å…¥m0ï¼Œæ±‚äº†m0çš„md5å€¼ï¼Œä¹‹åè¿›è¡Œä»¥ä¸‹æ­¥éª¤</p>
<p>$ s=(hm_1)^d\mod n $</p>
<p>æˆ‘ä»¬çŸ¥é“eï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è§£è¿™ä¸ªå¼å­</p>
<p>$ hm_1=s^e=(hm_1)^{ed}=(hm_1)^{k*phi+1}=hm_1\mod n $</p>
<p>çŸ¥é“hm1åï¼Œæˆ‘ä»¬è¦åœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹md5ï¼Œå°±å¯ä»¥çŸ¥é“m0äº†ï¼Œç„¶åç”¨æ¥è·å–flagçš„å‡½æ•°ä¸€ç”¨å°±å¯ä»¥è§£å‡ºflagäº†ï¼Œè§£å‡ºçš„m0å¦‚ä¸‹ï¼Œåœ¨çº¿ç½‘ç«™æ˜¯<a target="_blank" rel="noopener" href="https://cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737599382838-6cf1fd7c-001a-4ddb-bcbb-e53d56dc6138.png" alt=""></p>
<p>ä»£ç å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = <span class="number">7270513885194445005322518350289419893608325839878215682947885852347014936106128407554345668066935779849573932055239642406851308417046145495939362638652861562381316163080735160853285303356461796079298817982074998651099375222398758502559657988024308504098238446594559605603104540325738607539729848183025647146</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">118167767283404647838357773955032661171703847685597271116789633496884884504237966404005641401909577369476550625894333528860763752286157264860218284704704444830864099870199623580368198306940575628872723737071517733553706154898255520538220530675603850372384339470410704813339357637359108745206967929184573003377</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">m0</span>):  <span class="comment"># è¯·ç”¨è¿™ä¸ªå‡½æ•°æ¥è½¬må¾—åˆ°flag</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m0 + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m0.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hm_int = <span class="built_in">pow</span>(s, e, n)</span><br><span class="line">hm_str = long_to_bytes(hm_int).decode()</span><br><span class="line"><span class="built_in">print</span>(hm_str)  <span class="comment"># 86133884de98baada58a8c4de66e15b8</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;adm0n12&#x27;</span>  <span class="comment"># é€šè¿‡ cmd5.com æŸ¥è¯¢åˆ°çš„ç»“æœ</span></span><br><span class="line">get_flag(m)</span><br><span class="line"><span class="comment"># flag&#123;th1s_1s_my_k3y:adm0n120xbfab06114aa460b85135659e359fe443f9d91950ca95cbb2cbd6f88453e2b08b&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="easyECC"><a href="#easyECC" class="headerlink" title="easyECC"></a>easyECC</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># type: ignore</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">c_left =bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]) * m[<span class="number">0</span>]</span><br><span class="line">c_right = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;c_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;c_right&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1 = (10968743933204598092696133780775439201414778610710138014434989682840359444219 : 50103014985350991132553587845849427708725164924911977563743169106436852927878 : 1)</span></span><br><span class="line"><span class="string">c2 = (16867464324078683910705186791465451317548022113044260821414766837123655851895 : 35017929439600128416871870160299373917483006878637442291141472473285240957511 : 1)</span></span><br><span class="line"><span class="string">c_left = 15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line"><span class="string">c_right = 3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šECC</p>
<p>å¾ˆç®€å•çš„ä¸€é“eccäº†ï¼Œæ‰€ä»¥çš„å€¼éƒ½ç»™äº†ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°flagè¢«åˆ†æˆä¸¤éƒ¨åˆ†åˆ†åˆ«ä¹˜äº†m[0]å’Œm[1]ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ†åˆ«è§£å‡ºm[0]å’Œm[1]å°±è¡Œï¼Œé‚£ä¹ˆåªè¦æ±‚å‡ºå¯†æ–‡må°±å¯ä»¥äº†ï¼Œè€Œkå·²ç»ç»™äº†ï¼Œè¯¥æœ‰çš„å€¼ä¹Ÿéƒ½æœ‰äº†ï¼Œæ‰€ä»¥åªè¦å¥—è§£å¯†ä»£ç æ±‚ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼ˆä»£ç ä¹Ÿæ˜¯çœ‹åˆ°ä¸€ç¯‡åšå®¢çŸ¥é“çš„ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œç¯å¢ƒsagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"></span><br><span class="line">c1 = E([<span class="number">10968743933204598092696133780775439201414778610710138014434989682840359444219</span>,<span class="number">50103014985350991132553587845849427708725164924911977563743169106436852927878</span>])</span><br><span class="line">c2 = E([<span class="number">16867464324078683910705186791465451317548022113044260821414766837123655851895</span>,<span class="number">35017929439600128416871870160299373917483006878637442291141472473285240957511</span>])</span><br><span class="line">cipher_left = <span class="number">15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line">cipher_right = <span class="number">3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line"></span><br><span class="line">m = c1 - k * c2</span><br><span class="line">left = cipher_left//m[<span class="number">0</span>]</span><br><span class="line">right = cipher_right//m[<span class="number">1</span>] <span class="comment"># ä¸èƒ½è½¬intæˆ–Integerå‹ï¼Œä¸ç„¶ç»“æœä¸º0ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¾ˆå¥‡æ€ª</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(left))+long_to_bytes(<span class="built_in">int</span>(right)))</span><br></pre></td></tr></table></figure>
<p>å¾—å‡ºflagä¸ºï¼š<strong>flag{This_is_the_last_crypto_}</strong></p>
<h2 id="æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ"><a href="#æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ" class="headerlink" title="æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ"></a>æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d %(p-<span class="number">1</span>)</span><br><span class="line">dq = d%(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;<span class="built_in">pow</span>(bytes_to_long(flag),e,p*q)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q=<span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dp=<span class="subst">&#123;dp&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dq=<span class="subst">&#123;dq&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line"><span class="string">p=108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line"><span class="string">q=121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line"><span class="string">dp=11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line"><span class="string">dq=46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šdpï¼Œdqæ³„éœ²</p>
<p>æŠŠæœ€åä¸€ä¸ªå¼å­å˜åŒ–ä¸€ä¸‹å¯ä»¥å¾—åˆ°</p>
<p>$ m = c^d + k \times  n = c^d + k\times p\times q $</p>
<p>ä¸¤è¾¹åŒæ—¶åˆ†åˆ«æ¨¡på’Œqï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªå¼å­</p>
<p>$ m_p = m\mod p = c^d \mod p $</p>
<p>$ m_q = m \mod q = c^d \mod q $</p>
<p>ç”±å·²çŸ¥çš„ç¬¬ä¸€äºŒä¸ªå¼å­æˆ‘ä»¬å¯ä»¥çŸ¥é“</p>
<p>$ d = k\timesï¼ˆp - 1ï¼‰+ dp $</p>
<p>å†å¸¦å…¥$ m_p = c^d \mod p $å¯ä»¥å¾—åˆ°</p>
<p>$ m_p = c^{dp} \mod p $</p>
<p>å³å¯ä»¥æ±‚å‡ºmpï¼Œmq</p>
<p>å†åˆ†æä¸€ä¸‹è¿™ä¸¤ä¸ªå¼å­$ m_p = c^d \mod p $ï¼›$ m_q = c^d \mod q $æˆ‘ä»¬å¯ä»¥å¾—åˆ°</p>
<p>$ c^d = K\times p +m_p $</p>
<p>$ c^d = k\times q + m_q $</p>
<p>ä¸‹å¼å¸¦å…¥ä¸Šå¼å¾—åˆ°</p>
<p>$ K\times p = k\times q + m_q - m_p $</p>
<p>ä¸¤è¾¹æ¨¡qå¾—åˆ°</p>
<p>$ K\times p = ï¼ˆm_q - m_pï¼‰\mod q $</p>
<p>ä¸¤è¾¹ä¹˜ä¸€ä¸ªpå¯¹qçš„é€†å…ƒï¼Œå¾—åˆ°</p>
<p>$ K = pâ€™\times (m_q - m_p) \mod q $</p>
<p>æ±‚å‡ºKåå†å¸¦å…¥$ c^d = K\times p +m_p $å°±å¯ä»¥å¾—åˆ°c^dï¼Œä»è€Œè§£å‡ºæ˜æ–‡</p>
<p>ä¸‹é¢æ˜¯ä»£ç å®ç°ï¼ˆä»£ç å°±æ˜¯çŸ­çŸ­å‡ è¡Œï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line">p=<span class="number">108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line">q=<span class="number">121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line">dp=<span class="number">11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line">dq=<span class="number">46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">m = (((m1-m2)*I)%p)*q+m2</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>å¾—å‡ºflagä¸ºï¼š<strong>flag{No_course_e_can_play}</strong></p>
<h2 id="æ ¼æ ¼ä½ å¥½æ£’"><a href="#æ ¼æ ¼ä½ å¥½æ£’" class="headerlink" title="æ ¼æ ¼ä½ å¥½æ£’"></a>æ ¼æ ¼ä½ å¥½æ£’</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">1024</span>)</span><br><span class="line">b = getPrime(<span class="number">1536</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">8</span>, <span class="number">2</span>**<span class="number">9</span>)</span><br><span class="line"><span class="keyword">assert</span> ((p+<span class="number">2</span>*r) * <span class="number">3</span>*a + q) % b &lt; <span class="number">70</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, p*q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a =&#x27;</span>, a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b =&#x27;</span>, b)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 75671328500214475056134178451562126288749723392201857886683373274067151096013132141603734799638338446362190819013087028001291030248155587072037662295281180020447012070607162188511029753418358484745755426924178896079516327814868477319474776976247356213687362358286132623490797882893844885783660230132191533753</span></span><br><span class="line"><span class="string">a = 99829685822966835958276444400403912618712610766908190376329921929407293564120124118477505585269077089315008380226830398574538050051718929826764449053677947419802792746249036134153510802052121734874555372027104653797402194532536147269634489642315951326590902954822775489385580372064589623985262480894316345817</span></span><br><span class="line"><span class="string">b = 2384473327543107262477269141248562917518395867365960655318142892515553817531439357316940290934095375085624218120779709239118821966188906173260307431682367028597612973683887401344727494920856592020970209197406324257478251502340099862501536622889923455273016634520507179507645734423860654584092233709560055803703801064153206431244982586989154685048854436858839309457140702847482240801158808592615931654823643778920270174913454238149949865979522520566288822366419746</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šæ ¼æ”»å‡»</p>
<p>å…³æ³¨æ–­è¨€<code>((p+2*r) * 3*a + q) % b &lt; 70</code></p>
<p>ç»“æœæ˜¯ä¸€ä¸ªå°äº70çš„æ•°ï¼Œç›¸å½“äºå·²çŸ¥ï¼ˆçˆ†ç ´å¾ˆå¿«çš„ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥è®¾æˆxï¼Œå°±å¯ä»¥å†™å‡ºä¸‹é¢è¿™ä¸ªæ ·å­</p>
<p>$ 3a(p+2r)+q=k\times b+x $</p>
<p>ç§»é¡¹åå°±å¯ä»¥æ„é€ å‡ºä¸‹é¢è¿™ä¸ªæ ¼</p>
<p>$ \begin{align}(k,p+2r)\begin{pmatrix} b&amp;0 \\ 3a&amp;1 \end{pmatrix} =(x-q,p+2r)\end{align} $</p>
<p>å¤ç°æ—¶æŠŠ3aæ”¾åœ¨ä¸Šé¢å‘ç°ä¸è¡Œï¼Œåé¢æƒ³äº†ä¸€ä¸‹ç¡®å®æ˜¯ï¼Œå› ä¸ºé‚£æ ·å‘é‡çš„å¤§å°å°±æœªçŸ¥äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾—åƒä¸Šé¢è¿™æ ·æ„é€ ï¼Œæ„é€ å¥½äº†sageè·‘å‡ºæ¥åï¼Œæˆ‘ä»¬å¾—çˆ†ç ´ä¸€ä¸‹xå’Œrï¼Œè¿™æ ·å°±å¯ä»¥æŠŠpå’Œqæ±‚å‡ºæ¥ï¼Œç„¶åå°±æ ‡å‡†rsaå°±è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from tqdm import *</span></span><br><span class="line"> </span><br><span class="line">c = <span class="number">63970090307730335877809721304200883550049640814796584855311919788444862517887223732986595675409088426370045912297203884697715744287109423956446588104144896948474600924252971426757693149049788176140093762669257572818136268391076675502412382985137721246839664247241033867414491199483652292036165169353341736721</span></span><br><span class="line">a = <span class="number">169095591032842107903100075180638676605851796444162152675549552436872904263319011471312171874748357621716550291723406808357475877569622382251716493461335948233920131882151228308789748286370580144669281233868187101339909767205887609164975015547772498904502805235278789412044800177551190013789791754504529931231</span></span><br><span class="line">b = <span class="number">6064645365981235887306179215270851271718801644429108711725310294864007556801445216060166346337708059041073442260127725535139356989204300545757168654885686344461282796094266688090445897296901297377920786192865778222921548386038058555872765953356732109313734205459623312689902913019046944089470201948948652890006944620407534229412159275346491001935499731177063675134035072472112134333424000794637616785944210359606751334132126595044554089452160862222153579096125950</span></span><br><span class="line"> </span><br><span class="line">mat = [[b,<span class="number">0</span>],[<span class="number">3</span>*a,<span class="number">1</span>]]</span><br><span class="line">M = Matrix(ZZ,mat)</span><br><span class="line">qq,pp= M.LLL()[<span class="number">0</span>]  <span class="comment"># pp=p+2r,qq=x-q</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(pp)</span><br><span class="line"><span class="built_in">print</span>(qq)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">pp = <span class="number">11955063068051544630946316468962078511069091314797871913634545080191072376861594574934166492638293328464581874921393333283491910392413726570145081889323365</span></span><br><span class="line"></span><br><span class="line">qq = <span class="number">8045923199163511894962326127962855996723489290534633417316373444301965842496393267385921312122459846420286036232396674929308891656715922685980889381589005</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">63970090307730335877809721304200883550049640814796584855311919788444862517887223732986595675409088426370045912297203884697715744287109423956446588104144896948474600924252971426757693149049788176140093762669257572818136268391076675502412382985137721246839664247241033867414491199483652292036165169353341736721</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">8</span>, <span class="number">2</span> ** <span class="number">9</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">70</span>):</span><br><span class="line">        p = pp - <span class="number">2</span> * i</span><br><span class="line">        q = qq + j</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> gmpy2.gcd(phi, <span class="number">65537</span>) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        d = gmpy2.invert(<span class="number">65537</span>, phi)</span><br><span class="line">        n = p * q</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        flag = libnum.n2s(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¾—å‡ºflagä¸ºï¼š<strong>flag{u_are_@_master_of_latt1ce_Crypt0gr@phy}</strong></p>
<h2 id="å­¦ä»¥è‡´ç”¨"><a href="#å­¦ä»¥è‡´ç”¨" class="headerlink" title="å­¦ä»¥è‡´ç”¨"></a>å­¦ä»¥è‡´ç”¨</h2><p><strong>é¢˜ç›®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    <span class="comment"># padäº†ä¸€ä¸‹ï¼Œä»”ç»†çœ‹çœ‹ï¼Œåˆ«å¥½ä¸å®¹æ˜“è§£å‡ºæ¥äº†å´æ²¡çœ‹åˆ°flagğŸ‘¼</span></span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">16</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;*&quot;</span> + msg + <span class="string">b&quot;*&quot;</span> + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    Nbits = <span class="number">2048</span></span><br><span class="line">    flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">    gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line">    </span><br><span class="line">    flag1 = bytes_to_long(pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], Nbits-<span class="number">1</span>))</span><br><span class="line">    flag2 = bytes_to_long(pad(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:], Nbits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>, <span class="built_in">pow</span>(flag1, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>, <span class="built_in">pow</span>(flag2, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c3 =&#x27;</span>, <span class="built_in">pow</span>(flag1 + flag2 + bytes_to_long(gift), e, n))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line"><span class="string">c1 = 8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line"><span class="string">c2 = 14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line"><span class="string">c3 = 8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>è€ƒç‚¹</strong>ï¼šgroebner_basis()</p>
<p>è™½è¯´åŸç†è¿˜ä¸ç†è§£ï¼Œä½†æ˜¯è§£é¢˜ä»£ç çœ‹çš„ä¸ƒä¸ƒå…«å…«äº†ï¼Œå°±æ˜¯ç”¨groebner_basis()è¿™ä¸ªå‡½æ•°å¯ä»¥æ±‚å‡ºå¤šé¡¹å¼çš„è§£æ¥ï¼Œæ ¼å¼æ˜¯xå‡å»æ‰€æ±‚å€¼çš„ä¸€ä¸ªå¤šé¡¹å¼ï¼Œæ‰€ä»¥å–è´Ÿï¼Œå†å–ç³»æ•°ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æ±‚å€¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">n = <span class="number">17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line">c1 = <span class="number">8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line">c2 = <span class="number">14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line">c3 = <span class="number">8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line">gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line"></span><br><span class="line">x, y = PolynomialRing(Zmod(n), <span class="string">&#x27;x, y&#x27;</span>).gens()</span><br><span class="line">f1 = x**<span class="number">3</span> - c1</span><br><span class="line">f2 = y**<span class="number">3</span> - c2</span><br><span class="line">f3 = (x + y + bytes_to_long(gift))**<span class="number">3</span> - c3</span><br><span class="line"></span><br><span class="line">gb = Ideal(f1, f2, f3).groebner_basis()</span><br><span class="line">f1, f2 = gb    <span class="comment"># è¿”å›ä¸€ä¸ªå¤šé¡¹å¼</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">int</span>(-f1.coefficients()[<span class="number">1</span>])    <span class="comment"># å–è´Ÿæ˜¯ä¸ºäº†æ±‚å‡ºmï¼Œå› ä¸ºä¸Šé¢å¤šé¡¹å¼æ˜¯xå‡å»æˆ‘ä»¬æ‰€æ±‚</span></span><br><span class="line"></span><br><span class="line">flag2 = <span class="built_in">int</span>(-f2.coefficients()[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="comment"># å‡ºé¢˜çš„æ—¶å€™åŠ äº†ç»™padï¼Œå¤§å®¶å¾—æ³¨æ„ä¸€ä¸‹ï¼Œflagåœ¨ä¸€å †trashä¸­é—´ï¼Œåˆ«åšå‡ºäº†å´æ²¡çœ‹è§flag</span></span><br><span class="line"><span class="built_in">print</span>((long_to_bytes(flag1)).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">2</span>]+(long_to_bytes(flag2).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;W1Sh_you_Bec0me_an_excelL3nt_crypt0G2@pher&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://mondaying.cn">Monday</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://mondaying.cn/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/">https://mondaying.cn/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://mondaying.cn" target="_blank">Monday-Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/%E5%A4%8D%E7%8E%B0/">å¤ç°</a></div><div class="post-share"><div class="social-share" data-image="/img/51fde9041ff690de11db4c9dafbe0c01.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/02/02/Coopersmith/" title="Coopersmith"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/b2244295174cd731901b232aff9be29e.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">Coopersmith</div></div><div class="info-2"><div class="info-item-1">å¶é‡é¢˜ç›®ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼Œæ•…æ·±å…¥å­¦ä¹   å‚è€ƒæ–‡ç« ï¼Œå»ºè®®ç»†ç»†ç ”è¯» https://zhuanlan.zhihu.com/p/4783052681 https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf https://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots https://www.ruanx.net/coppersmith/  å®šç†è®¾Næ˜¯ä¸€ä¸ªå¤§æ•´æ•°ï¼Œ$ p \geq N^\beta $æ˜¯ N çš„ä¸€ä¸ªå› å­ï¼Œè®¾ $ f(x) $ æ˜¯ä¸€ä¸ªdé˜¶(æ¬¡æ•°ä¸ºd)çš„å¤šé¡¹å¼ï¼Œä»¤$ X=\frac{1}{2}N^{\frac{1}{d} - \varepsilon} $ï¼Œå…¶ä¸­$ 0\le\varepsilon\le...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/02/Coopersmith/" title="Coopersmith"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/b2244295174cd731901b232aff9be29e.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-02</div><div class="info-item-2">Coopersmith</div></div><div class="info-2"><div class="info-item-1">å¶é‡é¢˜ç›®ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼Œæ•…æ·±å…¥å­¦ä¹   å‚è€ƒæ–‡ç« ï¼Œå»ºè®®ç»†ç»†ç ”è¯» https://zhuanlan.zhihu.com/p/4783052681 https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf https://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots https://www.ruanx.net/coppersmith/  å®šç†è®¾Næ˜¯ä¸€ä¸ªå¤§æ•´æ•°ï¼Œ$ p \geq N^\beta $æ˜¯ N çš„ä¸€ä¸ªå› å­ï¼Œè®¾ $ f(x) $ æ˜¯ä¸€ä¸ªdé˜¶(æ¬¡æ•°ä¸ºd)çš„å¤šé¡¹å¼ï¼Œä»¤$ X=\frac{1}{2}N^{\frac{1}{d} - \varepsilon} $ï¼Œå…¶ä¸­$ 0\le\varepsilon\le...</div></div></div></a><a class="pagination-related" href="/2025/01/22/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E2%80%94%E6%B5%81%E5%AF%86%E7%A0%81/" title="å¯¹ç§°å¯†ç â€”æµå¯†ç "><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/2a1f417e634d8d05050d8c9e01e33ed8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-22</div><div class="info-item-2">å¯¹ç§°å¯†ç â€”æµå¯†ç </div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2024/11/24/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/" title="æ¤­åœ†æ›²çº¿"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/b2244295174cd731901b232aff9be29e.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-24</div><div class="info-item-2">æ¤­åœ†æ›²çº¿</div></div><div class="info-2"><div class="info-item-1">æ¤­åœ†æ›²çº¿ä¸‹é¢è¿›è¡Œæ¤­åœ†æ›²çº¿ç›¸å…³çŸ¥è¯†çš„å­¦ä¹ ï¼ˆåŸºäºcrypto hackï¼‰ï¼Œä¸­é—´ç©¿æ’äº†ä¸€äº›æ•°è®ºå’Œè¿‘ä¸–ä»£æ•°çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚ ä¸€. é¢„å¤‡çŸ¥è¯†å­¦ä¹ çš„æ—¶å€™ç¢°åˆ°äº†æ•°è®ºå’Œè¿‘ä¸–ä»£æ•°çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼Œå› ä¸ºè¿™ä¸¤é—¨æˆ‘éƒ½æ²¡å­¦å®Œï¼ˆå°¤å…¶è¿‘ä¸–ä»£æ•°ï¼Œå®Œå…¨æ²¡å¼€å§‹çœ‹ï¼‰ï¼Œæ‰€æœ‰åªèƒ½æ±‚å°½é‡è®²æ¸…æ¥šå§ã€‚ ç¾¤è¿‘ä¸–ä»£æ•°æ˜¯ä¸»è¦ç ”ç©¶ä»£æ•°ç³»ç»Ÿï¼ˆå³éç©ºé›†åˆï¼‰çš„å­¦ç§‘ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªéç©ºé›†åˆä¸Šå®šä¹‰æ»¡è¶³ä¸€å®šæ¡ä»¶çš„ä¸€ç§æˆ–å¤šç§äºŒå…ƒè¿ç®—ï¼ˆä»£æ•°è¿ç®—ï¼‰ã€‚ç¾¤æ˜¯è¿‘ä¸–ä»£æ•°é‡Œé¢ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µã€‚ä¸‹é¢æ”¾ä¸€ä¸ªè¯¾æœ¬ä¸Šçš„å®šä¹‰ã€‚  ç®€å•è§£é‡Šä¸€ä¸‹å°±æ˜¯åœ¨ä¸€ä¸ªéç©ºé›†åˆé‡Œå®šä¹‰ä¸€ä¸ªäºŒå…ƒè¿ç®—ï¼Œè¿™ä¸ªè¿ç®—å¯¹äºè¿™ä¸ªé›†åˆå†…çš„å…ƒç´ éƒ½æ»¡è¶³ (1)ç»“åˆç‡        (2)å•ä½å…ƒ    (3)é€†å…ƒ å…¶å®è¿˜æœ‰ä¸€ä¸ªå°é—­æ€§ï¼Œå°±æ˜¯è¿ç®—ç»“æœè¿˜æ˜¯åœ¨è¿™ä¸ªé›†åˆé‡Œã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¯¹äºæ‰€æœ‰éé›¶æœ‰ç†æ•°ï¼ˆéç©ºé›†åˆï¼‰ï¼Œå’Œæ™®é€šä¹˜æ³•ï¼ˆäºŒå…ƒè¿ç®—ï¼‰æ„æˆäº†ä¸€ä¸ªç¾¤ï¼Œè¿™ä¸ªç¾¤æ»¡è¶³ç»“åˆå¾‹ï¼ˆæ˜¯æ˜¾ç„¶çš„ï¼‰ï¼Œæœ‰å•ä½å…ƒ1ï¼ˆä»»æ„æ•°ä¸1åšè¿™ä¸ªäºŒå…ƒè¿ç®—éƒ½ç­‰äºå®ƒæœ¬èº«ï¼Œä¸”äº¤æ¢ä¹Ÿæ»¡è¶³ï¼‰ï¼Œä¸”å¯¹äºä»»æ„ä¸€ä¸ªaï¼Œéƒ½æœ‰$ \frac{1}{a} $ä¸aåšè¿™ä¸ªäºŒå…ƒè¿ç®—åç­‰äºå•ä½å…ƒ1ï¼ˆäº¤æ¢ä¹Ÿæ»¡è¶³) é˜¿è´å°”ç¾¤ï¼ˆAbel...</div></div></div></a><a class="pagination-related" href="/2024/11/15/%E6%A0%BC%E5%85%A5%E9%97%A8/" title="æ ¼å…¥é—¨"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/e05bae03ad983cf1b23cca07ca3bacb7.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">æ ¼å…¥é—¨</div></div><div class="info-2"><div class="info-item-1">æ ¼å…¥é—¨è¿™ä¸¤å‘¨å°±æ˜¯å­¦ä¹ äº†ä¸€äº›æ ¼çš„åŸºæœ¬çŸ¥è¯†ï¼Œå› ä¸ºä¸´è¿‘æœŸä¸­è€ƒï¼Œå­¦çš„æœ‰ç‚¹ä»“ä¿ƒï¼Œä½†æ€»ç®—æ˜¯äº†è§£äº†ä¸€ç‚¹ï¼Œæˆ‘æŠŠå­¦åˆ°çŸ¥è¯†ç‚¹ä¹Ÿå†™äº†å†™ï¼Œä½œä¸šçš„è§£é¢˜æ€è·¯ä¼šæ”¾åœ¨åé¢é¢˜ç›®è¿ç”¨é‚£é‡Œï¼Œå¯ä»¥è·³è½¬å»çœ‹ ä¸€. é¢„å¤‡çŸ¥è¯†è¦å­¦ä¹ æ ¼ï¼Œæ˜¯å¾—æœ‰çº¿æ€§ä»£æ•°çš„çŸ¥è¯†æ‰è¡Œçš„ã€‚ï¼ˆåæ­£æˆ‘çœ‹åˆ°é‚£äº›çŸ©é˜µå‘é‡ä»€ä¹ˆçš„å°±å›å¿†èµ·ä¸Šå­¦æœŸè¢«çº¿ä»£æ”¯é…çš„ææƒ§ï¼‰å› ä¸ºæˆ‘ä¸Šå­¦æœŸçº¿ä»£å­¦çš„ä¹Ÿä¸å¥½ï¼Œå¿˜çš„ä¹Ÿå·®ä¸å¤šäº†ï¼ŒåŠ ä¸Šè¿™é‡Œç¯‡å¹…ä¹Ÿæœ‰é™ï¼Œæˆ‘ä¹Ÿåªèƒ½ç‚¹ä¸€ä¸‹cryptohackä¸Šé¢æåˆ°çš„ä¸€äº›çº¿ä»£çŸ¥è¯†ï¼Œç›®å‰æ¥çœ‹å¤Ÿç”¨ï¼Œä¸è¿‡å¼ºçƒˆå»ºè®®ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹çº¿ä»£ã€‚ å‘é‡å’Œå‘é‡ç©ºé—´ä»¥äºŒç»´å‘é‡ç©ºé—´ä¸¾ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„å–ä¸€ä¸ªç‚¹Aï¼Œè¿æ¥åŸç‚¹Oå’ŒAç‚¹ï¼Œè¿™å°±æ„æˆæˆäº†ä¸€ä¸ªå‘é‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨Aç‚¹çš„åæ ‡æ¥è¡¨ç¤ºè¿™ä¸ªå‘é‡,å°±åƒè¿™æ ·v=(x,y) å‘é‡æ»¡è¶³åŠ å‡ã€æ•°ä¹˜å’Œç‚¹ç§¯è¿ç®—ï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼ˆåŠ ç²—è¡¨ç¤ºå‘é‡ï¼‰ v=(a , b)ï¼Œw=(c , d) v + w = ï¼ˆa + cï¼Œb + dï¼‰ ï¼ˆå‡æ³•åŒç†ï¼‰ c * w = ï¼ˆc * aï¼Œ c * b ï¼‰      ï¼ˆæ•°ä¹˜ï¼‰ v * w = a * c + b * d       ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/p1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Monday</div><div class="author-info-description">å‘¨1ä¸æ”¾å‡~</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Mondaying"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Mondaying" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2792663789@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#week1"><span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xor"><span class="toc-text">xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Base"><span class="toc-text">Base</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E7%A7%92%E4%BA%86"><span class="toc-text">ä¸€çœ¼ç§’äº†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Strange-King"><span class="toc-text">Strange King</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week2"><span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E5%87%A0%E6%AC%A1%E6%96%B9%EF%BC%9F-%E7%96%91%E6%83%91"><span class="toc-text">è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ ç–‘æƒ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Since-you-konw-something"><span class="toc-text">Since you konw something</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8C%B6%E9%87%8C%E8%8C%B6%E6%B0%94"><span class="toc-text">èŒ¶é‡ŒèŒ¶æ°”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Just-one-and-more-than-two"><span class="toc-text">Just one and more than two</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week3"><span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B2%A1e%E8%BF%99%E8%83%BD%E7%8E%A9"><span class="toc-text">æ²¡eè¿™èƒ½ç©</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%85%E4%BA%8B%E6%96%B0%E7%BC%96"><span class="toc-text">æ•…äº‹æ–°ç¼–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E7%94%A8%E8%B0%A2%E5%96%B5"><span class="toc-text">ä¸ç”¨è°¢å–µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E9%BB%84%E9%B9%82%E9%B8%A3%E7%BF%A0%E6%9F%B3"><span class="toc-text">ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week4"><span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A3%E7%9F%B3%E5%8C%95%E9%A6%96"><span class="toc-text">åœ£çŸ³åŒ•é¦–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E6%AC%A7%E6%8B%89%EF%BC%81%EF%BC%81"><span class="toc-text">æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%B1%E4%BB%A5%E6%88%91%E4%B9%8B%E5%90%8D"><span class="toc-text">ä¿±ä»¥æˆ‘ä¹‹å</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week5"><span class="toc-text">week5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%EF%BC%9Fcmd5%EF%BC%81"><span class="toc-text">RSAï¼Ÿcmd5ï¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyECC"><span class="toc-text">easyECC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B2%A1e%E4%B9%9F%E8%83%BD%E7%8E%A9%EF%BC%9F"><span class="toc-text">æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%BC%E6%A0%BC%E4%BD%A0%E5%A5%BD%E6%A3%92"><span class="toc-text">æ ¼æ ¼ä½ å¥½æ£’</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%BB%A5%E8%87%B4%E7%94%A8"><span class="toc-text">å­¦ä»¥è‡´ç”¨</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/" title="2024 NewStar-Cryptoå¤ç°"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/51fde9041ff690de11db4c9dafbe0c01.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024 NewStar-Cryptoå¤ç°"/></a><div class="content"><a class="title" href="/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/" title="2024 NewStar-Cryptoå¤ç°">2024 NewStar-Cryptoå¤ç°</a><time datetime="2025-02-04T05:51:27.000Z" title="å‘è¡¨äº 2025-02-04 13:51:27">2025-02-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/02/Coopersmith/" title="Coopersmith"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/b2244295174cd731901b232aff9be29e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Coopersmith"/></a><div class="content"><a class="title" href="/2025/02/02/Coopersmith/" title="Coopersmith">Coopersmith</a><time datetime="2025-02-02T05:05:49.000Z" title="å‘è¡¨äº 2025-02-02 13:05:49">2025-02-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/22/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E2%80%94%E6%B5%81%E5%AF%86%E7%A0%81/" title="å¯¹ç§°å¯†ç â€”æµå¯†ç "><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/2a1f417e634d8d05050d8c9e01e33ed8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å¯¹ç§°å¯†ç â€”æµå¯†ç "/></a><div class="content"><a class="title" href="/2025/01/22/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E2%80%94%E6%B5%81%E5%AF%86%E7%A0%81/" title="å¯¹ç§°å¯†ç â€”æµå¯†ç ">å¯¹ç§°å¯†ç â€”æµå¯†ç </a><time datetime="2025-01-22T07:58:06.000Z" title="å‘è¡¨äº 2025-01-22 15:58:06">2025-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/24/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/" title="æ¤­åœ†æ›²çº¿"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/b2244295174cd731901b232aff9be29e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ¤­åœ†æ›²çº¿"/></a><div class="content"><a class="title" href="/2024/11/24/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/" title="æ¤­åœ†æ›²çº¿">æ¤­åœ†æ›²çº¿</a><time datetime="2024-11-24T03:01:31.000Z" title="å‘è¡¨äº 2024-11-24 11:01:31">2024-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/15/%E6%A0%BC%E5%85%A5%E9%97%A8/" title="æ ¼å…¥é—¨"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/e05bae03ad983cf1b23cca07ca3bacb7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ ¼å…¥é—¨"/></a><div class="content"><a class="title" href="/2024/11/15/%E6%A0%BC%E5%85%A5%E9%97%A8/" title="æ ¼å…¥é—¨">æ ¼å…¥é—¨</a><time datetime="2024-11-15T07:26:21.000Z" title="å‘è¡¨äº 2024-11-15 15:26:21">2024-11-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Monday</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><div class="aplayer no-destroy" data-id="12805936272" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '6f6eda168cee48fea492f6ad56f1a4a0';
  var gaud_map_key = '05f3dc4654e2dd0cb3ef708ea49be87f';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v6.2.0" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://dashboard.4everland.org/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œå¤‡ç”¨çº¿è·¯æ‰˜ç®¡äº4EVERLAND" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-4EVERLAND-22DDDD?style=flat&amp;logo=IPFS" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1s');
    arr[i].setAttribute('data-wow-delay', '0s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body></html>