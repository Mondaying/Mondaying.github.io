<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2024 NewStar-Cryptoå¤ç°</title>
      <link href="/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/"/>
      <url>/2025/02/04/2024-NewStar-Crypto%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;flag&#123;*******************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag[:<span class="number">13</span>], encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">m2 = flag[<span class="number">13</span>:]</span><br><span class="line"></span><br><span class="line">c1 = m1 ^ bytes_to_long(key)</span><br><span class="line">c2 = xor(key, m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>,c2)</span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–ï¼Œpwnåº“é‡Œçš„xor()å‡½æ•°</p><p>åªè¦äº†è§£ä¸€ä¸‹å¼‚æˆ–è¿ç®—å°±å¯ä»¥è§£å†³ï¼Œè¿ç®—æ³•åˆ™ä¸ºï¼š0 âŠ• 0 = 0ï¼Œ1 âŠ• 0 = 1ï¼Œ0 âŠ• 1 = 1ï¼Œ1 âŠ• 1 = 0ï¼ˆåŒä¸º 0ï¼Œå¼‚ä¸º 1ï¼‰</p><p>ä¸€ä¸ªç‰¹ç‚¹æ˜¯pã€qå¼‚æˆ–çš„ç»“æœä¸å…¶ä¸­ä¸€ä¸ªå†è¿›è¡Œä¸€æ¬¡å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°å¦ä¸€ä¸ª</p><font style="color:rgb(60, 60, 60);">pwntools ä¸­</font>çš„ xor()ï¼Œå®ƒ<font style="color:rgb(60, 60, 60);">å¯ä»¥å°†ä¸åŒç±»å‹å’Œé•¿åº¦çš„æ•°æ®è¿›è¡Œå¼‚æˆ–</font><p>é¢˜ç›®å°†æ˜æ–‡åˆ†æˆä¸¤éƒ¨åˆ†m1å’Œm2,åˆ†åˆ«å’Œkeyè¿›è¡Œäº†å¼‚æˆ–è¿ç®—ï¼Œåªè¦å†æŠŠc1ã€c2å’Œkeyå¼‚æˆ–ä¸€æ¬¡ï¼Œç»“æœåˆèµ·æ¥ï¼Œå°±æ˜¯flagï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line"></span><br><span class="line">c1= <span class="number">8091799978721254458294926060841</span></span><br><span class="line">c2= <span class="string">b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = c1 ^ bytes_to_long(key)<span class="comment"># è‡ªå¸¦çš„å¼‚æˆ–ç¬¦å·^åªèƒ½ç”¨äºæ•´æ•°ç±»å‹æ“ä½œ</span></span><br><span class="line">m2 = xor(key, c2)</span><br><span class="line">m1 = long_to_bytes(m1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(m1+m2)</span><br><span class="line"><span class="comment"># flag&#123;0ops!_you_know_XOR!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h2><p><strong>é¢˜ç›®</strong></p><p>4C4A575851324332474E324547554B494A5A4446513653434E564D444154545A4B354D45454D434E4959345536544B474D5134513D3D3D3D</p><p><strong>è€ƒç‚¹</strong>ï¼šbaseç³»åˆ—ç¼–ç </p><p>ä¹‹å‰ç”¨çš„åœ¨çº¿ç½‘ç«™è¿›è¡Œè§£ç ï¼Œä½†è¯´å®è¯ï¼ŒæŒºå¤æ‚ï¼Œå› ä¸ºè¿™ä¸ªè¿›è¡Œäº†å¥½å‡ ä¸ªbaseç³»åˆ—çš„ç¼–ç ï¼Œçœ‹äº†å®˜æ–¹wpåçŸ¥é“äº†CyberChefï¼Œç”¨è¿™ä¸ªå°±å¯ä»¥ä¸€æŠŠæ¢­å“ˆ</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1736225714200-dffbceb2-0045-48d7-a5bb-8e100fcb1739.png" alt=""></p><p>çœ‹äº†å®˜æ–¹wpåæ‰æƒ³èµ·æ¥æˆ‘å¯¹baseç¼–ç å…¶å®äº†è§£åˆ°ä¸å¤ªç†Ÿï¼Œçœ‹äº†ä¹‹åæ‰äº†è§£äº†ç¼–ç åŸç†</p><h2 id="ä¸€çœ¼ç§’äº†"><a href="#ä¸€çœ¼ç§’äº†" class="headerlink" title="ä¸€çœ¼ç§’äº†"></a>ä¸€çœ¼ç§’äº†</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> serct <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"><span class="comment"># 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šrsaï¼Œåˆ†è§£n</p><p>på’Œqéƒ½ä¸ç®—å¤ªå¤§ï¼Œç›´æ¥ç”¨åœ¨çº¿ç½‘ç«™åˆ†è§£ä¸€ä¸‹nï¼Œå¾—åˆ°pã€qåæŒ‰RSAè§£å¯†å°±è¡Œï¼ˆæ±‚phiï¼Œç„¶åæ±‚dï¼‰</p><p>ä½†æ˜¯è¡¥å……ä¸€ä¸‹yafuçš„ç”¨æ³•ï¼Œæ‰“å¼€cmdï¼Œè¾“å…¥yafu-x64.exeï¼Œä¹‹åè¾“å…¥factor(éœ€è¦åˆ†è§£çš„ç´ æ•°)ï¼Œå¦‚æœæ•°æ¯”è¾ƒå¤§ï¼Œå°±è¦æ”¾åˆ°txté‡Œï¼Œè®°å¾—å›è½¦ï¼Œç„¶åå†ä»cmdé‡Œè¾“å…¥yafu-x64.exe â€œfactor(@)â€ -batchfile D:\data.txtï¼Œæ¯æ¬¡ç”¨å®Œä¼šè‡ªåŠ¨åˆ é™¤è¿™ä¸ªtxtæ–‡ä»¶</p><p>æœ‰äº†på’Œqä¹‹åå°±æ²¡æœ‰éš¾åº¦äº†ï¼Œrsaè§£å¯†å°±è¡Œï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line">c=<span class="number">48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br><span class="line">p=<span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956044421</span></span><br><span class="line">q=<span class="number">7221289171488727827673517139597844534869368289455419695964957239047692699919030405800116133805855968123601433247022090070114331842771417566928809956045093</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;9cd4b35a-affc-422a-9862-58e1cc3ff8d2&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Strange-King"><a href="#Strange-King" class="headerlink" title="Strange King"></a>Strange King</h2><p><strong>é¢˜ç›®</strong></p><p>æŸå–œæ¬¢æŠ½é”åˆ» 5 çš„çš‡å¸æƒ³æ¯å¤©è¿›æ­¥ä¸€äº›ï¼Œç›´åˆ°ä»–å¨¶äº†ä¸ªæ¨¡ï¼Œå›åˆ°åŸç‚¹ï¼Œå…¨éƒ¨ç™½ç»™ğŸ˜… è¿™æ˜¯ä»–æœ€åç•™ä¸‹çš„è®¯æ¯ï¼š<code>ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;</code>ï¼Œflag åŒ…è£¹çš„æ˜¯å¯è¯»çš„æ˜æ–‡</p><p><strong>è€ƒç‚¹</strong>ï¼šå˜å¼‚å‡¯æ’’</p><p>æ˜¯å‡¯æ’’å¯†ç çš„å˜å½¢ï¼ŒæŠŠå¯†æ–‡å‰å››ä¸ªå­—ç¬¦å’Œflagå¯¹æ¯”å°±ä¼šå‘ç°ä»–ä»¬çš„asciiç å€¼åˆ†åˆ«å·®äº†5ã€7ã€9ã€11ï¼ˆå…¶å®é¢˜ç›®ä¹Ÿæé†’äº†é”åˆ»5å’Œæ¯å¤©è¿›æ­¥ä¸€ç‚¹ï¼Œè¯´æ˜ä¸€å¼€å§‹åç§»5ï¼Œé€æ¸åŠ 2ï¼‰ï¼Œç„¶åå–æ¨¡ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢è¶…å‡ºèŒƒå›´ï¼ˆä¸€å¼€å§‹æˆ‘æ¨¡æ²¡å–å¯¹ï¼Œæƒ³ç€æ˜¯å–asciiè¡¨çš„æ¨¡ï¼Œç„¶åå†™ä¸å¯¹ï¼Œå…¶å®åº”è¯¥å¤§å†™å­—æ¯å’Œå°å†™å­—æ¯åˆ†åˆ«å–26ï¼Œä½¿å…¶åœ¨å„è‡ªçš„èŒƒå›´é‡Œï¼‰ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">&#x27;ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;&#x27;</span></span><br><span class="line">plain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> txt:</span><br><span class="line">    <span class="keyword">if</span> j.islower():</span><br><span class="line">        plain = plain + <span class="built_in">chr</span>(<span class="number">97</span> + (<span class="built_in">ord</span>(j) - i - <span class="number">97</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">elif</span> j.isupper():</span><br><span class="line">        plain = plain + <span class="built_in">chr</span>(<span class="number">65</span> + (<span class="built_in">ord</span>(j) - i - <span class="number">65</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plain = plain + j</span><br><span class="line">    i += <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="comment"># flag&#123;PleaseDoNotStopLearing&#125;</span></span><br></pre></td></tr></table></figure><h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ-ç–‘æƒ‘"><a href="#è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ-ç–‘æƒ‘" class="headerlink" title="è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ ç–‘æƒ‘"></a>è¿™æ˜¯å‡ æ¬¡æ–¹ï¼Ÿ ç–‘æƒ‘</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">hint = p^e + <span class="number">10086</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[n, e] =&quot;</span>, [n, e])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint =&quot;</span>, hint)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line"><span class="string">[n, e] = [124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261, 65537]</span></span><br><span class="line"><span class="string">hint = 12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–ç¬¦å·çš„è¿ç®—ä¼˜å…ˆçº§</p><p>è¿™é“é¢˜éœ€è¦æ¸…æ¥šå¼‚æˆ–æ“ä½œçš„ä¼˜å…ˆçº§æ˜¯ä½äºä¹˜é™¤åŠ å‡çš„ï¼Œæ‰€æœ‰hintæ˜¯på’Œe+10086çš„å¼‚æˆ–ç»“æœï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°pï¼Œå†ç”¨næ•´é™¤å¾—åˆ°qï¼Œç„¶åå°±æ˜¯RSAè§£å¯†äº†ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Utill.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c = <span class="number">36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line">n = <span class="number">124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261</span></span><br><span class="line">hint = <span class="number">12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = hint ^ <span class="number">10086</span> + e</span><br><span class="line">q= n//p</span><br><span class="line">phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;yihuo_yuan_lai_xian_ji_suan_liang_bian_de2333&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Since-you-konw-something"><a href="#Since-you-konw-something" class="headerlink" title="Since you konw something"></a>Since you konw something</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment"># The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = ?? <span class="comment"># extremely short</span></span><br><span class="line">FLAG = <span class="string">&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line">c = bytes_to_long(xor(FLAG,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šå¼‚æˆ–</p><p>è¿™é“é¢˜è¦å†äº†è§£ä¸€ä¸‹pwntoolsåº“é‡Œçš„xorå‡½æ•°ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¿›è¡Œxor(data, key)ï¼Œé‚£ä¹ˆdataä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆå¯¹åº”çš„asciiå€¼ï¼Œåé¢åŒç†ï¼‰ä¼šå’Œkeyé‡Œçš„ç¬¬ä¸€ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼Œä¾æ­¤ç±»æ¨ï¼Œå½“dataçš„å­—èŠ‚æ•°è¶…è¿‡keyçš„é•¿åº¦æ—¶ï¼Œkeyä¼šä»å¤´å¼€å§‹é‡å¤ä½¿ç”¨ï¼Œç›´åˆ°dataä¸­çš„æ•°æ®å…¨éƒ¨å¤„ç†å®Œæ¯•</p><p>ä»é¢˜ç›®å¯ä»¥çŸ¥é“keyå¾ˆçŸ­ï¼Œæ°å·§æˆ‘ä»¬çŸ¥é“FLAGçš„å‰å‡ ä¸ªå­—èŠ‚ï¼ˆfalgï¼‰ï¼Œæ‰€ä»¥å¼‚æˆ–ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“keyæ˜¯â€™nsâ€™ï¼Œä¹‹åcå’Œkeyå†å¼‚æˆ–ä¸€æ¬¡å°±å¯ä»¥çŸ¥é“flagäº†ï¼ˆå¯¹ç§°æ€§ï¼‰ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment"># The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">c=<span class="number">218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line">FLAG = <span class="string">b&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br><span class="line">c = long_to_bytes(c)</span><br><span class="line"><span class="built_in">print</span>(xor(c,FLAG))</span><br><span class="line">key = <span class="string">&#x27;ns&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(xor(c,key))</span><br><span class="line"><span class="comment"># flag&#123;Y0u_kn0w_th3_X0r_b3tt3r&#125;</span></span><br></pre></td></tr></table></figure><h2 id="èŒ¶é‡ŒèŒ¶æ°”"><a href="#èŒ¶é‡ŒèŒ¶æ°”" class="headerlink" title="èŒ¶é‡ŒèŒ¶æ°”"></a>èŒ¶é‡ŒèŒ¶æ°”</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;*****&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>( flag ) == <span class="number">25</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    a += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">int</span>(a,<span class="number">16</span>).bit_length()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;l  =&quot;</span> , l )</span><br><span class="line"></span><br><span class="line">v0 = <span class="built_in">int</span>(a,<span class="number">16</span>)&gt;&gt;(l//<span class="number">2</span>)</span><br><span class="line">v1 = <span class="built_in">int</span>(a,<span class="number">16</span>)-(v0&lt;&lt;(l//<span class="number">2</span>))</span><br><span class="line">p = getPrime(l//<span class="number">2</span>+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">v2 = <span class="number">0</span></span><br><span class="line">derta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line"><span class="keyword">assert</span> v1 &lt; p <span class="keyword">and</span> v0 &lt; p <span class="keyword">and</span> derta &lt; p <span class="keyword">and</span> v3 &lt; p <span class="keyword">and</span> v4 &lt; p <span class="keyword">and</span> v5 &lt; p <span class="keyword">and</span> v6 &lt; p </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v1 += (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line">    v0 += (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v2 += derta ; v2 %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;p  =&quot;</span> , p  )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v0 =&quot;</span> , v0 )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v1 =&quot;</span> , v1 )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">l  = 199</span></span><br><span class="line"><span class="string">p  = 446302455051275584229157195942211</span></span><br><span class="line"><span class="string">v0 = 190997821330413928409069858571234</span></span><br><span class="line"><span class="string">v1 = 137340509740671759939138452113480</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼š<font style="color:rgb(60, 60, 60);">TEAï¼ˆTiny Encryption Algorithmï¼‰åŠ å¯†ç®—æ³•</font></p><font style="color:rgb(60, 60, 60);">ä¸çŸ¥é“æ˜¯TEAåŠ å¯†ç®—æ³•ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºé€†æ¨å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼Œè‡ªå·±å†™ä¸€ä¸‹å°±å¾ˆæ¸…æ™°</font><p><img src="https://cdn.nlark.com/yuque/0/2025/jpeg/42554774/1736234814527-a03ceadd-3d09-4988-8361-ac5d3ea51057.jpeg" alt=""></p><font style="color:rgb(60, 60, 60);">æŠŠæœ€ç»ˆçš„V2æ±‚å‡ºæ¥åæŠŠé¡ºåºåè¿‡æ¥é€€å›å»å°±è¡Œï¼Œå°±æ”¹æˆå‡å·ï¼ŒæŠŠèµ·å§‹çš„V0å’ŒV1æ±‚å‡ºæ¥åï¼Œå°±å¯ä»¥æ±‚å‡ºæ¥aï¼ŒæŠŠaè½¬åå…­è¿›åˆ¶ï¼Œä¸¤ä½ä¸€ä¸ªè½¬å­—ç¬¦å°±å¯ä»¥æ±‚å‡ºflagï¼Œä»£ç å¦‚ä¸‹</font><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">v2 = <span class="number">0</span></span><br><span class="line">delta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line">l  = <span class="number">199</span></span><br><span class="line">p  = <span class="number">446302455051275584229157195942211</span></span><br><span class="line">v0 = <span class="number">190997821330413928409069858571234</span></span><br><span class="line">v1 = <span class="number">137340509740671759939138452113480</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>( <span class="number">32</span> ):</span><br><span class="line">    v2 += delta ; v2 %= p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v2 -= delta ; v2 %= p</span><br><span class="line">    v0 -= (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v1 -= (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">hex</span>((v0&lt;&lt;((l//<span class="number">2</span>))) + v1)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(a[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;f14gg9_te2_1i_7ea_7&#125;</span></span><br></pre></td></tr></table></figure><h2 id="Just-one-and-more-than-two"><a href="#Just-one-and-more-than-two" class="headerlink" title="Just one and more than two"></a>Just one and more than two</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q, r= (getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>))</span><br><span class="line">N=p*q*r</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\nr=<span class="subst">&#123;r&#125;</span>\nc1=<span class="subst">&#123;c1&#125;</span>\nc2=<span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line"><span class="string">q=11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line"><span class="string">r=12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line"><span class="string">c1=8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line"><span class="string">c2=1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šæ¬§æ‹‰å‡½æ•°</p><p>ä¸€é“RSAé¢˜ï¼Œflagè¢«åˆ†æˆä¸¤éƒ¨åˆ†åˆ†åˆ«è¿›è¡ŒåŠ å¯†ï¼Œc1æ˜¯m1é€šè¿‡eå’ŒpåŠ å¯†å¾—åˆ°ï¼Œc2æ˜¯m2é€šè¿‡eå’ŒNåŠ å¯†å¾—åˆ°ï¼Œè¦æ±‚m1å’Œm2å°±å¾—æ±‚å¯¹åº”çš„d1å’Œd2ï¼Œåªè¦äº†è§£ä¸€ä¸‹æ¬§æ‹‰å‡½æ•°å°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬å·²çŸ¥pã€qã€rï¼Œä¸”ä»–ä»¬éƒ½æ˜¯ç´ æ•°ï¼Œé‚£ä¹ˆ</p><p>$ phi(p) = p - 1 $</p><p>$ phi(N) = (p -1)(q - 1)(r - 1) $</p><p>å†åˆ†åˆ«æ±‚ä¸€ä¸‹eå…³äºä»–ä»¬ä¸¤ä¸ªçš„é€†å…ƒå°±å¯ä»¥å¾—åˆ°d1å’Œd2ï¼Œåé¢å°±æ˜¯RSAè§£å¯†äº†ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line">q=<span class="number">11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line">r=<span class="number">12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line">c1=<span class="number">8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line">c2=<span class="number">1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">N = p*q*r</span><br><span class="line">d1 = gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">d2 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, d1, p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, d2, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1)+long_to_bytes(m2))</span><br><span class="line"><span class="comment"># flag&#123;Y0u_re4lly_kn0w_Euler_4nd_N3xt_Eu1er_is_Y0u!&#125;</span></span><br></pre></td></tr></table></figure><h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="æ²¡eè¿™èƒ½ç©"><a href="#æ²¡eè¿™èƒ½ç©" class="headerlink" title="æ²¡eè¿™èƒ½ç©"></a><strong>æ²¡eè¿™èƒ½ç©</strong></h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">h1 = <span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r</span><br><span class="line">h2 = <span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r</span><br><span class="line">h3 = <span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint_of_pqr=&quot;</span> , h1 , h2 , h3 )</span><br><span class="line"></span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">a_big_prime = getPrime( <span class="number">512</span> )</span><br><span class="line">hint = <span class="built_in">pow</span>(a_big_prime,e,<span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;big_prime is: &quot;</span> , a_big_prime )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint is: &quot;</span> , hint )</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">c = <span class="built_in">pow</span>( m , e , n )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;c=&quot;</span> , c )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">hint_of_pqr= 31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497 83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760 248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172 </span></span><br><span class="line"><span class="string">big_prime is:  10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line"><span class="string">hint is:  1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571 </span></span><br><span class="line"><span class="string">c= 999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šç¦»æ•£å¯¹æ•°</p><p>æ˜¯ä¸€é“RSAé¢˜ç›®ï¼Œnæ˜¯pã€qã€rçš„ä¹˜ç§¯ï¼Œè€Œé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬pqrä¹‹é—´çš„çº¿æ€§å…³ç³»ï¼ˆä¸‰ä¸ªæœªçŸ¥æ•°ï¼Œä¸‰ä¸ªæ–¹ç¨‹ï¼Œå¯ä»¥è§£å‡ºpã€qã€rï¼‰</p><p>é‚£æ¥ä¸‹æ¥å°±æ˜¯è¦æ±‚dï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰ç»™æˆ‘ä»¬eï¼Œç»™çš„æ˜¯a_big_prime<strong>e(mod 2</strong>512)</p><p>å‚è€ƒäº†ä¸€äº›åšå®¢ï¼ŒçŸ¥é“æ˜¯ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä¸å¤ªäº†è§£ç¦»æ•£å¯¹æ•°ï¼ˆä¹‹åä¼šå¤šçœ‹çœ‹çš„ï¼‰ï¼Œç„¶åç›´æ¥åœ¨ä¸€ä¸ªåšå®¢é‡Œå°±æ‰¾åˆ°äº†ä¸€ä¸ªåº“é‡Œçš„ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥ç›´æ¥æ±‚å‡ºe</p><font style="color:rgb(77, 77, 77);">pythonçš„ sympyåº“discrete_logå‡½æ•°æ˜¯ä¸“é—¨æ±‚æŒ‡æ•°çš„ï¼Œdiscrete_log(x,y,z)ï¼Œxä¸ºæ¨¡æ•°ï¼Œyä¸ºä½™æ•°ï¼Œzä¸ºåº•æ•°</font><p>ç”¨è¿™ä¸ªå‡½æ•°æ±‚å‡ºæ¥eåå°±æ˜¯RSAè§£å¯†çš„ç»å…¸è¿‡ç¨‹äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">h1 = <span class="number">31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497</span></span><br><span class="line">h2 = <span class="number">83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760</span></span><br><span class="line">h3 = <span class="number">248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172</span></span><br><span class="line">big_prime= <span class="number">10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line">hint=      <span class="number">1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571</span></span><br><span class="line">c= <span class="number">999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">3</span> * h1 - h2</span><br><span class="line">r = (<span class="number">9</span> * h1 - h3)//<span class="number">3</span></span><br><span class="line">q = h1 - p - r</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e = sympy.discrete_log(<span class="number">2</span>**<span class="number">512</span>,hint,big_prime)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;th1s_2s_A_rea119_f34ggg&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ•…äº‹æ–°ç¼–"><a href="#æ•…äº‹æ–°ç¼–" class="headerlink" title="æ•…äº‹æ–°ç¼–"></a>æ•…äº‹æ–°ç¼–</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">zen1  = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">key1 = </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc1</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_char</span>(<span class="params">c, k</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(((<span class="built_in">ord</span>(c) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + (<span class="built_in">ord</span>(k) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    plaintext = plaintext.upper()</span><br><span class="line">    key = key.upper()</span><br><span class="line">    ciphertext = []</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            ciphertext.append(shift_char(char, key[key_index % <span class="built_in">len</span>(key)]))</span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc = \&#x27;\&#x27;\&#x27;&#x27;</span> + enc1(zen1, key1)+<span class="string">&#x27;\&#x27;\&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(zen1.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#----------------------------------------------</span></span><br><span class="line">enc = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">TYBNBBZNT WF TYUMMK NAIB HYFZ.</span></span><br><span class="line"><span class="string">XFIFBKWG AM CXBMYK BVNF CNITBWBB.</span></span><br><span class="line"><span class="string">GVEJMX QL VXBHRJ NITV VIFXZRP.</span></span><br><span class="line"><span class="string">WPFXEYQ QG OWNUXZ MBTV QBEJMBKTNXL.</span></span><br><span class="line"><span class="string">TYSN JL JXNMMF GZUO GMLNXL.</span></span><br><span class="line"><span class="string">GCSLTX QL VXBHRJ NITV WYGAS.</span></span><br><span class="line"><span class="string">SDUHT QL PXOSAWLF</span></span><br><span class="line"><span class="string">KMTXTJWYANZ VWNHMA.</span></span><br><span class="line"><span class="string">GCWWJTT VULMG NJYO&#x27;M AIYVQOY WHPNOA NH JFRSE UAM KOEMG.</span></span><br><span class="line"><span class="string">NDNIHCZB IZOPLCDTTBNR JSNLM QNZBNR.</span></span><br><span class="line"><span class="string">MFEGLT LPHOEL BRNYS IILM LQZRFNMR.</span></span><br><span class="line"><span class="string">CGFXAG RPJMBKBNEG GVDYOVMW.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šç»´å‰å°¼äºšçˆ†ç ´</p><p>é¢˜ç›®æ˜¯å®šä¹‰äº†ä¸€ä¸ªencå‡½æ•°ï¼Œå®ƒæ¥æ”¶æ˜æ–‡å’Œå¯†é’¥ï¼Œç„¶åå°†å®ƒä»¬å…¨éƒ¨å¤§å†™ï¼Œç„¶åæ˜æ–‡é‡Œçš„æ¯ä¸ªå­—ç¬¦ä¾æ¬¡ç§»åŠ¨å¯†æ–‡å¯¹åº”å­—ç¬¦çš„ASCIIå€¼ï¼ˆå‡å»â€™Aâ€™åçš„å€¼ï¼‰çœ‹åˆ°è¿™é‡Œï¼Œå¦‚æœå¤å…¸å¯†ç è®°å¾—ç†Ÿçš„è¯åº”è¯¥å°±èƒ½ååº”è¿‡æ¥è¿™æ˜¯ä¸€ä¸ªç»´å‰å°¼äºšå¯†ç <del>ï¼ˆæˆ‘å—ï¼Ÿæˆ‘è®°ä¸ä½ï¼Œæˆ‘é—®AIçš„ï¼Œå®ƒå‘Šè¯‰æˆ‘çš„ï¼‰</del></p><p>é‚£çŸ¥é“æ˜¯ç»´å‰å°¼äºšåŠ å¯†äº†ï¼Œæ‰¾åˆ°å¯†é’¥ä¸å°±è§£å‡ºæ¥äº†<del>ï¼Œå—¯ï¼Ÿæ²¡ç»™æˆ‘å¯†é’¥ï¼Ÿé‚£å°±è·Ÿä½ çˆ†äº†ï¼</del> æ˜¯çš„ï¼Œæ²¡æœ‰å¯†é’¥çš„æƒ…å†µä¸‹è¿ç”¨åœ¨çº¿ç½‘ç«™çˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°æ˜æ–‡äº†ï¼Œæˆ‘å°±æ˜¯ç”¨çš„<a href="https://www.guballa.de/vigenere-solver">é“¾æ¥</a>ç½‘å€çš„åœ¨çº¿å·¥å…·</p><p>ä¹‹åMD5åŠ å¯†åçš„åå…­è¿›åˆ¶è½¬å­—èŠ‚ï¼Œæ‰“å°å‡ºæ¥å°±æ˜¯äº†</p><p>è‡³äºæ•…äº‹æ–°ç¼–2ï¼Œæ˜¯<font style="color:rgb(60, 60, 60);">è‡ªåŠ¨å¯†é’¥å¯†ç ï¼Œä¸æ•…äº‹æ–°ç¼– 1 ç›¸ç±»ä¼¼ã€‚æ˜¯ç»´å‰å°¼äºšçš„å˜å¼‚ï¼Œåœ¨ä¸Šé¢é‚£ä¸ªç½‘ç«™ä¹Ÿèƒ½çˆ†ç ´ï¼Œéƒ½å¯ä»¥æ±‚å‡ºflag</font></p><font style="color:rgb(60, 60, 60);"></font><h2 id="ä¸ç”¨è°¢å–µ"><a href="#ä¸ç”¨è°¢å–µ" class="headerlink" title="ä¸ç”¨è°¢å–µ"></a><font style="color:rgb(60, 60, 60);">ä¸ç”¨è°¢å–µ</font></h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">b&quot;fake_key_fake_ke&quot;</span></span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;fake_flag_fake_flag&#125;&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    AES_ECB = AES.new(KEY, AES.MODE_ECB)</span><br><span class="line">    decrypted = AES_ECB.decrypt(long_to_bytes(c))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    AES_CBC = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">    encrypted = AES_CBC.encrypt(FLAG.encode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;iv:&#x27;</span>,iv.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> iv.<span class="built_in">hex</span>() + encrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">c=encrypt()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;encrypt:&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;decrypt:&#x27;</span>,decrypt(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#encrypt: f2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line"><span class="comment">#ä»€ä¹ˆæ˜¯AESå•ŠğŸ˜­ï¼Œæ±‚æ±‚ä½ å¸®æˆ‘è§£å¯†å§ï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¼šåšçš„ï¼ï¼ï¼ï¼ï¼ğŸ˜­</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ä»€ä¹ˆéƒ½ä¼šåšï¼Ÿé‚£å°±å»å­¦ä¹ ä¸€ä¸‹AESçš„å·¥ä½œæ¨¡å¼å§â€¦â€¦</span></span><br><span class="line"><span class="string">æˆ‘è¿™æ¬¡å°±å…ˆç»™ä½ è§£ä¸€ä¸‹å¥½äº†ï¼Œä¸ç”¨è°¢å–µ</span></span><br><span class="line"><span class="string">decrypt: f9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"><span class="string">è¿™å¯¹å—ï¼Ÿå“¦ä¸å¯¹ä¸å¯¹ï¼Œå“¦å¯¹çš„å¯¹çš„ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šAESçš„ä¸åŒåˆ†ç»„æ¨¡å¼</p><p>è¿™é“é¢˜å®šä¹‰äº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªCBCåˆ†ç»„æ¨¡å¼çš„AESåŠ å¯†å‡½æ•°ï¼›ä¸€ä¸ªæ˜¯ECBåˆ†ç»„æ¨¡å¼çš„AESè§£å¯†å‡½æ•°ã€‚</p><p>CBCæ¨¡å¼æ˜¯å¯¹æ¯ä¸ªå—éƒ½ä½¿ç”¨åŒä¸€ä¸ªkeyè¿›è¡Œå—åŠ å¯†ï¼Œä½†å—åŠ å¯†ä¹‹å‰ï¼Œå…ˆå°†æ˜æ–‡å—ä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–è®¡ç®—ï¼Œç„¶åå†å¯¹å¼‚æˆ–è®¡ç®—ç»“æœè¿›è¡Œå—åŠ å¯†ã€‚å¯¹äºé¦–ä¸ªæ˜æ–‡å—ï¼Œå› ä¸ºä¸å­˜åœ¨å‰ä¸€ä¸ªå¯†æ–‡å—ï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„ä¸€ä¸ªå­—èŠ‚æ•°ç»„æ¥å……å½“â€å‰ä¸€ä¸ªå¯†æ–‡å—â€ï¼Œè¿™ä¸ªå­—èŠ‚æ•°ç»„è¢«ç§°ä¸ºåˆå§‹åŒ–å‘é‡ï¼ŒIVã€‚è§£å¯†æ—¶è¦æŠŠå’Œkeyè¿›è¡Œå—è§£å¯†æ“ä½œåçš„å—å’Œå‰ä¸€ä¸ªå¯†æ–‡å—ï¼ˆç¬¬ä¸€ä¸ªå¯†æ–‡å—å’Œivï¼‰å¼‚æˆ–åæ‰èƒ½å¾—åˆ°æ˜æ–‡å—ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1728642690114-23f34435-6fc5-4ece-9d53-aabee58c6680.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_1125%2Climit_0" alt=""></p><p>ECBæ˜¯æœ€ç®€å•çš„ä¸€ä¸ªåˆ†ç»„æ¨¡å¼ï¼ˆåº”è¯¥æ˜¯ï¼‰ï¼Œå¯¹æ¯ä¸€ä¸ªå—çš„åŠ å¯†éƒ½æ˜¯ä½¿ç”¨åŒæ ·çš„keyï¼ŒåŒæ ·çš„æ˜æ–‡å—ä¸€å®šä¼šè¢«åŠ å¯†æˆåŒæ ·çš„å¯†æ–‡å—ã€‚è§£å¯†è¿‡ç¨‹å°±æ˜¯æŠŠæ¯ä¸€ä¸ªå—å’Œkeyè¿›è¡Œå—è§£å¯†æ“ä½œå°±å¯ä»¥äº†ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1728642677785-40fe2fba-9d49-48fc-a382-a271a009ed79.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_994%2Climit_0" alt=""></p><p>é‚£ä¹ˆå·²çŸ¥æ˜æ–‡æ˜¯è¢«encrypt()å‡½æ•°åŠ å¯†çš„ï¼Œæ˜¯ä¸€ä¸ªCBCæ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦çŸ¥é“ivå’Œkeyå°±å¯ä»¥è§£å¯†äº†ï¼Œivå…¶å®å¾ˆå¥½çŸ¥é“ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“encryptï¼Œå®ƒæ˜¯ivå’Œå¯†æ–‡çš„åå…­è¿›åˆ¶ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ivæ˜¯16ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆencryptçš„å‰32ä¸ªå­—ç¬¦å°±æ˜¯ivï¼ˆæ¯ä¸ªå­—èŠ‚å¯¹åº”ä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦æ•°ï¼‰</p><p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“keyå‘€ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å–µå¸®æˆ‘ä»¬å¹²äº†ä»€ä¹ˆï¼Œå—¯ï¼Œå®ƒç”¨ECBæ¨¡å¼è§£å¯†äº†æˆ‘ä»¬çš„æ˜æ–‡ï¼Œè¿™ä¸å¯¹å§ï¼Ÿä½†æ˜¯åªè¦æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°ç”¨ECBæ¨¡å¼è§£å¯†å’ŒCBCæ¨¡å¼å°±å·®ä¸€æ­¥å¼‚æˆ–ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨çŸ¥é“keyäº†ï¼Œåªè¦å¼‚æˆ–å°±è¡Œäº†</p><p>å®˜æ–¹wpå¾ˆå·§å¦™ï¼ŒæŠŠæ‰€æœ‰è½¬æˆå­—èŠ‚å‹å†ç–‘æƒ‘ï¼Œåé¢æŸ¥äº†ä¸€ä¸‹å‘ç°åè¿›åˆ¶å’Œåå…­è¿›åˆ¶long_to_bytesçš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯é•¿è§è¯†äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b , bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"></span><br><span class="line">c = <span class="number">0xf2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line">d = <span class="number">0xf9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"></span><br><span class="line">part1=l2b( b2l(l2b(c)[<span class="number">0</span>:<span class="number">16</span>]) ^ b2l(l2b(d)[<span class="number">16</span>:<span class="number">32</span>]))</span><br><span class="line">part2=l2b( b2l(l2b(c)[<span class="number">16</span>:<span class="number">32</span>]) ^ b2l(l2b(d)[<span class="number">32</span>:<span class="number">48</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(part1+part2)</span><br><span class="line"><span class="comment"># flag&#123;HOw_c4REfu1Ly_yOu_O65ERve!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³"><a href="#ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³" class="headerlink" title="ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³"></a>ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    delta = getPrime(<span class="number">1024</span>)</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    N = p * q</span><br><span class="line">    <span class="keyword">if</span> delta&lt;N:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;xxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">t1 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">t2 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line"><span class="keyword">assert</span> (t1 != t2)</span><br><span class="line">m1 = m + t1 * delta</span><br><span class="line">m2 = m + t2 * delta</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, N)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>, c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;delta = &quot;</span>, delta)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e =  683</span></span><br><span class="line"><span class="string">c1 =  56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line"><span class="string">c2 =  89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line"><span class="string">N =  147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line"><span class="string">delta =  93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šå…³è”ä¿¡æ¯æ”»å‡»ï¼Œå¤šé¡¹å¼gcd</p><p>æ€»çš„æ¥è¯´å°±æ˜¯æ‰¾åˆ°ä¸¤ä¸ªå¤šé¡¹å¼çš„å…¬å› å­ï¼Œè€Œè¿™ä¸ªå€¼å¤§æ¦‚ç‡å°±æ˜¯m1ï¼Œä¹‹åå°±å¯ä»¥æ±‚è§£å‡ºæ˜æ–‡ã€‚ä½†å…·ä½“åŸç†æœ‰ç‚¹å¤æ‚ï¼Œç”¨åˆ°äº†Half-GCD ç®—æ³•ï¼Œä¹‹åç»†æ‰£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x ^ m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x ^ m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">related_message_attack</span>(<span class="params">a, b</span>):</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> related_message_attack(d, r)</span><br><span class="line"></span><br><span class="line">e =  <span class="number">683</span></span><br><span class="line">c1 =  <span class="number">56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line">c2 =  <span class="number">89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line">N =  <span class="number">147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line">delta =  <span class="number">93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"></span><br><span class="line">is_flag = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> delt <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">255</span>, <span class="number">255</span>, <span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">    f = x ^ e - c1</span><br><span class="line">    g1 = ((x + (delt + <span class="number">0</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">1</span>) * delta) ^ e - c2)</span><br><span class="line">    g2 = ((x + (delt + <span class="number">2</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">3</span>) * delta) ^ e - c2)</span><br><span class="line">    g3 = ((x + (delt + <span class="number">4</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">5</span>) * delta) ^ e - c2)</span><br><span class="line">    g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">7</span>) * delta) ^ e - c2)</span><br><span class="line">    <span class="keyword">if</span> delt == -<span class="number">7</span>:</span><br><span class="line">        g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2)</span><br><span class="line">    g = g1 * g2 * g3 * g4</span><br><span class="line">    res = related_message_attack(f, g)</span><br><span class="line">    m1 = <span class="built_in">int</span>(-res.monic().coefficients()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> t1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        m = (m1 % N - t1 * delta) % N</span><br><span class="line">        <span class="keyword">if</span> m &gt; <span class="number">0</span>:</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            <span class="keyword">if</span> flag[:<span class="number">4</span>] ==<span class="string">b&#x27;flag&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                is_flag = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_flag:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># flag&#123;V_me_the_flag&#125;</span></span><br></pre></td></tr></table></figure><h1 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h1><h2 id="åœ£çŸ³åŒ•é¦–"><a href="#åœ£çŸ³åŒ•é¦–" class="headerlink" title="åœ£çŸ³åŒ•é¦–"></a>åœ£çŸ³åŒ•é¦–</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">beta=<span class="number">0.37</span></span><br><span class="line">delta=<span class="number">0.01</span></span><br><span class="line">n=<span class="built_in">round</span>((<span class="number">1</span>-<span class="number">2</span>*beta-<span class="number">2</span>*delta)/((<span class="number">1</span>-beta)^<span class="number">2</span>-<span class="number">2</span>*delta-beta),<span class="number">6</span>)</span><br><span class="line">e= <span class="number">3668637434348843171145584606519031375027610199908169273169275927238735031431533260375377791001464799116453803408104076615710166171199990283470548282669948353598733020244755959461974603778630346457439345913209321194112256348302765254052193562603687450740346132207444615610078198488883539133291840346099727880587092122957231085658576850601488737629051252914095889313671875244094452330062619943781809984690384476868543570724769198985172300665613239047649089399919032152539462701309393130614829962670866062380816370571057536421400102100259975636785825540933280194583888638501981649650640939392658268133881679239293596283</span></span><br><span class="line">N= <span class="number">9748523098652101859947730585916490335896800943242955095820326993765071194474558998322598145898741779502734772138283011560029368500998354183150180904846368209977332058847768859238711047784703104535311583123388923571789764758869419482184613566672922481672444028753365755071127320541645016370072493604532087980626825687519083734367691341907014061379844209864141989961751681235215504772582878202048494707090104738899927036896915997556102574747166491969027546256022019959716418675672979328622656831990050058120299353807110233202113906317969377201045402271911946244076903611612303290556012512559696538977841061277173754331</span></span><br><span class="line">c= <span class="number">5374936627659221745209010619827617207565185520404653329184605916859755641352457088986635357806048863755173540232471505333583684733535121482637476692432365062808450583470788320547816186936317927449796090525477205337038591439577855884910604383190932340306435201976465543731935147881754136301375206828970248293731391543905441514528959500307972606931927112031018356411970001312995489429650903529877904694901310020882390008248466887950986326522740278880600110217817950511478637493101027659292006016454642135508207492151610829525082829566392116546434101694921106423469015683277992978077101831969525458693031031468092418427</span></span><br><span class="line">n=<span class="built_in">int</span>(n+<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(n)</span></span><br><span class="line">m=<span class="built_in">int</span>(n*(<span class="number">1</span>-beta))</span><br><span class="line">X=<span class="built_in">int</span>(<span class="built_in">pow</span>(N,delta))</span><br><span class="line">Y=<span class="built_in">int</span>(<span class="built_in">pow</span>(N,delta+beta))</span><br><span class="line">Z.&lt;x,y&gt;=ZZ[]</span><br><span class="line">L=Matrix(ZZ,n,n)</span><br><span class="line">f=e*x-y</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    g=<span class="built_in">list</span>(N^<span class="built_in">max</span>(<span class="number">0</span>,m-i)*x^(n-<span class="number">1</span>-i)*f^i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(g)):</span><br><span class="line">        L[i,j]=g[j][<span class="number">0</span>]*X^(n-<span class="number">1</span>-j)*Y^j</span><br><span class="line">L=L.LLL()[<span class="number">0</span>]</span><br><span class="line">coeff=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    coeff.append((L[i]//(X^(n-<span class="number">1</span>-i)*Y^i),<span class="string">&#x27;x&#x27;</span>+<span class="string">&#x27;**&#x27;</span>+<span class="built_in">str</span>(n-<span class="number">1</span>-i)+<span class="string">&#x27;*y&#x27;</span>+<span class="string">&#x27;**&#x27;</span>+<span class="built_in">str</span>(i)))</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(coeff)):</span><br><span class="line">    s+=<span class="built_in">str</span>(coeff[i][<span class="number">0</span>])+<span class="string">&#x27;*&#x27;</span>+coeff[i][<span class="number">1</span>]+<span class="string">&#x27;+&#x27;</span></span><br><span class="line">f=<span class="built_in">eval</span>(s[:-<span class="number">1</span>])</span><br><span class="line">factored_f = f.factor()</span><br><span class="line">first_polynomial = factored_f[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">first_coefficient = first_polynomial.coefficients()[<span class="number">0</span>]</span><br><span class="line">k = first_coefficient + <span class="number">1</span></span><br><span class="line">dp = first_polynomial.coefficients()[<span class="number">1</span>]</span><br><span class="line">p=(e*dp-<span class="number">1</span>)//k+<span class="number">1</span></span><br><span class="line">q=N//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure><p>å°±æ˜¯ä¸€ä¸ªsageæ–‡ä»¶ï¼Œåœ¨sagemathé‡Œé¢è¿è¡Œå°±è¡Œäº†ï¼Œå°±æ˜¯è¿è¡Œæ¯”è¾ƒä¹…ï¼ˆæˆ‘å°±å¤åˆ¶åˆ°Jupyterä¸Šè¿è¡Œä¸€ä¸‹å°±è¡Œäº†ï¼‰</p><p>flag{small_dp_is_not_secure_adhfaiuhaph}</p><h2 id="æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼"><a href="#æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼" class="headerlink" title="æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼"></a>æ¬§æ‹‰æ¬§æ‹‰ï¼ï¼</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*********&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        x = (<span class="number">1</span> &lt;&lt; bits) - <span class="number">1</span> ^ p</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">10</span>, <span class="number">11</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(x + i):</span><br><span class="line">                <span class="keyword">return</span> p, x + i, i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q, i = get_prime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i =&quot;</span>, i)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line"><span class="string">n = 18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line"><span class="string">i = -3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šäºŒè¿›åˆ¶åŠ æ³•ï¼Œé—´æ¥æ±‚æ¬§æ‹‰å‡½æ•°</p><p>æˆ‘ä»¬æœ‰ä»¥ä¸‹å¼å­</p><p>$ x = (1 &lt;&lt; bits) - 1 \text{^} p $</p><p>é‚£ä¹ˆå°±è¦äº†è§£ä¸€ä¸‹äºŒè¿›åˆ¶åŠ æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">0b1001</span></span><br><span class="line">b = a ^ <span class="number">0b1111</span> = <span class="number">0b0110</span></span><br><span class="line">a + b = <span class="number">1111</span></span><br></pre></td></tr></table></figure><p>æ‰€æœ‰æˆ‘ä»¬æœ‰$ x + p= (1 &lt;&lt; bits) - 1 $</p><p>ç„¶å1&lt;&lt;512æ˜¯$ 2^{512} $</p><p>æ‰€ä»¥$ x + p= 2^{512} - 1 $</p><p>æ‰€ä»¥$ p+q = p+x+i=2^{512}-1+i $</p><p>$ phi(n)=(p-1)(q-1)=pq-(p+q)+1=n-2^{512}+2-i $</p><p>åé¢å°±æ²¡æœ‰éš¾åº¦äº†ï¼Œæ±‚å‡ºdæ­£å¸¸æ±‚è§£å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line">n = <span class="number">18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line">i = -<span class="number">3</span></span><br><span class="line">phi = n - <span class="number">2</span>**<span class="number">512</span> + <span class="number">2</span> - i</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># flag&#123;y0u_really_kn0w_the_phi&#125;</span></span><br></pre></td></tr></table></figure><h2 id="ä¿±ä»¥æˆ‘ä¹‹å"><a href="#ä¿±ä»¥æˆ‘ä¹‹å" class="headerlink" title="ä¿±ä»¥æˆ‘ä¹‹å"></a>ä¿±ä»¥æˆ‘ä¹‹å</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">8</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    padded_msg = pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;\x00&quot;</span> + msg + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> padded_msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">All_in_my_name</span>(<span class="params">p, q</span>):</span><br><span class="line">    <span class="comment">#å¼€å¯ä¸‰æŠ€èƒ½&lt;ä¿±ä»¥æˆ‘ä¹‹å&gt;åï¼Œç»´å¨œç«‹å³åœ¨å‘¨å›´å…«æ ¼å¯éƒ¨ç½²åœ°é¢å¬å”¤â€œé»„é‡‘ç›Ÿèª“(Golden_Oath)â€;å¯¹RSAé€ æˆçœŸå®ä¼¤å®³ã€‚</span></span><br><span class="line">    Golden_Oath = (p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>)</span><br><span class="line">    x = bytes_to_long(pad(gift, random.randint(bytes_to_long(gift).bit_length(), <span class="number">512</span>)))</span><br><span class="line">    y = inverse(x, Golden_Oath)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">gift = <span class="string">b&#x27;?????&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> gift[:<span class="number">3</span>] == <span class="string">b&#x27;end&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;All_in_my_name = <span class="subst">&#123;All_in_my_name(p, q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line"><span class="string">c = 104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line"><span class="string">All_in_my_name = 217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šç»´å¨œæ”»å‡»</p><p>å½“eè¿‡å¤§æˆ–è¿‡å°çš„æ—¶å€™æˆ‘ä»¬éƒ½å¯ä»¥è€ƒè™‘ç»´çº³æ”»å‡»ï¼Œå½“ç„¶è¿˜è¦æ»¡è¶³$ d&lt;\frac{1}{3}n^{\frac{1}{4}} $,ä¸”$ q&lt;p&lt;2q $</p><p>æˆ‘ä»¬ç®€å•æ¨ä¸€ä¸‹ï¼Œæˆ‘ä»¬çŸ¥é“$ n=p*q $</p><p>$ phi(n)=(p-1)(q-1)=pq -(p+q)+1 $</p><p>å› ä¸ºpå’Œqéƒ½æ˜¯éå¸¸å¤§çš„æ•°ï¼Œæˆ‘ä»¬è¿‘ä¼¼å¤„ç†ånå’Œphi(n)å°±å·®ä¸å¤šå¤§ã€‚</p><p>æˆ‘ä»¬çŸ¥é“$ ed=1 \mod phi(n) $</p><p>æ‰€ä»¥$ ed = k\times phi(n)+1 $ï¼Œä¸¤è¾¹åŒæ—¶é™¤ä»¥$ d*phi(n) $</p><p>å¾—åˆ°$ \frac{e}{phi(n)}=\frac{k}{d}+\frac{1}{d\times phi(n)} $</p><p>åŒæ ·çš„$ d*phi(n) $æ˜¯å¾ˆå¤§çš„æ•°ï¼Œ$ \frac{1}{d\times phi(n)} $å¯ä»¥å¿½ç•¥ï¼Œphi(n)ç”¨næ¥ä»£æ›¿ï¼Œå°±å¯ä»¥å¾—åˆ°$ \frac{e}{n}=\frac{k}{d} $</p><p>eå’Œnéƒ½æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿åˆ†æ•°å±•å¼€ï¼Œå¾—åˆ°kå’Œdçš„å¯èƒ½å€¼(åŸç†è¿˜æ²¡ææ‡‚ï¼Œç›®å‰åªèƒ½ç›´æ¥ç”¨)</p><p>è¿™é‡Œçš„â€ä¿±ä»¥æˆ‘ä¹‹åâ€å°±æ˜¯ä¸€ä¸ªç»´çº³æ”»å‡»(æ˜¯çš„ï¼Œæˆ‘ç©èˆŸ)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æ‰¾èƒ½è¿åˆ†æ•°å±•å¼€çš„å¼å­</p><p>$ xy=1\mod Golden_Oath $</p><p>æ‰€ä»¥$ \frac{y}{Golden_Oath}=\frac{k}{x} $</p><p>å…¶ä¸­$ Golden_Oath = (p-114)(p-514)(p+114)(p+514)(q-1919)(q-810)(q+1919)(q+810)<br> $æˆ‘ä»¬å¯ä»¥çœ‹æˆ$ n^4 $</p><p>é‚£æˆ‘ä»¬å¯¹è¿™ä¸ªå¼å­è¿›è¡Œè¿åˆ†æ•°å±•å¼€ï¼Œå°±èƒ½æ‰¾åˆ°ä¸€ç³»åˆ—è¿‘ä¼¼å€¼ï¼Œå†åˆ¤æ–­ä¸€ä¸‹â€™endâ€™åœ¨ä¸åœ¨æ±‚å‡ºæ¥çš„xé‡Œå°±å¯ä»¥æ‰¾åˆ°xäº†ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line">c = <span class="number">104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line">y = <span class="number">217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="variable language_">self</span>.numberlist = []</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist = []</span><br><span class="line">        <span class="variable language_">self</span>.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        <span class="variable language_">self</span>.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            <span class="variable language_">self</span>.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist.append([<span class="variable language_">self</span>.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>.numberlist)):</span><br><span class="line">            numerator = <span class="variable language_">self</span>.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * <span class="variable language_">self</span>.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            <span class="variable language_">self</span>.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">pow</span>(n,<span class="number">4</span>)</span><br><span class="line">a = ContinuedFraction(y, n)</span><br><span class="line"><span class="keyword">for</span> k, x <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="comment"># åˆ¤æ–­å“ªä¸€ä¸ªæ˜¯æˆ‘ä»¬æ‰€éœ€çš„ x</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;end&#x27;</span> <span class="keyword">in</span> long_to_bytes(x):</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line">Golden_Oath = (x*y-<span class="number">1</span>)//k</span><br><span class="line"><span class="built_in">print</span>(Golden_Oath)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">103697213497220650500739251621743955651854455782387759691953279488676501281257640431561</span></span><br><span class="line"><span class="string">56398712132783063027132828918468670442692437484816382768162819797891220782528221182512</span></span><br><span class="line"><span class="string">b&#x27;5`\xf4\xf6t\xa3\x00end1n9_A_G2@nd_Ov3RTu2e\x1c\x13&quot;H\x0f\xc9&#x27;</span></span><br><span class="line"><span class="string">#400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æœ‰äº†Golden_Oathï¼Œä¹ŸçŸ¥é“n=p*qï¼Œè§£ä¸ªæ–¹ç¨‹å°±å¯ä»¥æ±‚å‡ºæ¥på’Œqäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Golden_Oath = <span class="number">400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">equation1 = Eq(p * q, n)</span><br><span class="line">equation2 = Eq((p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>), Golden_Oath)</span><br><span class="line">solutions = solve((equation1, equation2), (p, q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p å’Œ q çš„è§£: <span class="subst">&#123;solutions&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p å’Œ q çš„è§£: [(-11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, -12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151), (11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, 12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æœ‰äº†pï¼Œqåå°±æ ‡å‡†RSAè§£å¯†è¿‡ç¨‹æŠ¬èµ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329</span></span><br><span class="line">q = <span class="number">12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;rE@L_d@m@9e_15_7h3_mo5t_au7hEn7ic_dam49E&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="week5"><a href="#week5" class="headerlink" title="week5"></a>week5</h1><h2 id="RSAï¼Ÿcmd5ï¼"><a href="#RSAï¼Ÿcmd5ï¼" class="headerlink" title="RSAï¼Ÿcmd5ï¼"></a>RSAï¼Ÿcmd5ï¼</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»€ä¹ˆï¼Ÿä½ è¯´ä½ ç”¨ MD5 ç»™ RSA ç­¾åäº†ï¼Ÿï¼</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;*******&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(m) == <span class="number">7</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_MD5</span>(<span class="params">m0</span>):</span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    md5_object = hashlib.md5(m0.encode())</span><br><span class="line">    md5_result = md5_object.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> md5_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_s</span>(<span class="params">m0, d0, n0</span>):</span><br><span class="line">    hm0 = get_MD5(m0)</span><br><span class="line">    hm1 = bytes_to_long(hm0.encode())</span><br><span class="line">    s0 = <span class="built_in">pow</span>(hm1, d0, n0)</span><br><span class="line">    <span class="keyword">return</span> s0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encode</span>(<span class="params">m0, e0, n0</span>):</span><br><span class="line">    m1 = bytes_to_long(m0.encode())</span><br><span class="line">    c0 = <span class="built_in">pow</span>(m1, e0, n0)</span><br><span class="line">    <span class="keyword">return</span> c0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">m0</span>):  <span class="comment"># è¯·ç”¨è¿™ä¸ªå‡½æ•°æ¥è½¬må¾—åˆ°flag</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m0 + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m0.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = get_s(m, d, n)</span><br><span class="line">c = rsa_encode(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¯†æ–‡c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç­¾ås =&quot;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å…¬é’¥[n,e] =&quot;</span>, [n, e])</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å¯†æ–‡c = 119084320846787611587774426118526847905825678869032529318497425064970463356147909835330423466179802531093233559613714033492951177656433798856482195873924140269461792479008703758436687940228268475598134411304167494814557384094637387369282900460926092035234233538644197114822992825439656673482850515654334379332</span></span><br><span class="line"><span class="string">ç­¾ås = 5461514893126669960233658468203682813465911805334274462134892270260355037191167357098405392972668890146716863374229152116784218921275571185229135409696720018765930919309887205786492284716906060670649040459662723215737124829497658722113929054827469554157634284671989682162929417551313954916635460603628116503</span></span><br><span class="line"><span class="string">å…¬é’¥[n,e] = [139458221347981983099030378716991183653410063401398496859351212711302933950230621243347114295539950275542983665063430931475751013491128583801570410029527087462464558398730501041018349125941967135719526654701663270142483830687281477000567117071676521061576952568958398421029292366101543468414270793284704549051, 65537]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šRSAæ•°å­—ç­¾å</p><p>ä¸€çœ¼çœ‹ä¸‹æ¥æ˜¯å¾ˆæ­£å¸¸çš„ä¸€ä¸ªRSAåŠ å¯†ï¼Œå¤šå°±å¤šåœ¨è¿™ä¸ªsï¼Œæ‰€ä»¥æˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹sçš„å‡½æ•°ï¼Œå®ƒä¼ å…¥m0ï¼Œæ±‚äº†m0çš„md5å€¼ï¼Œä¹‹åè¿›è¡Œä»¥ä¸‹æ­¥éª¤</p><p>$ s=(hm_1)^d\mod n $</p><p>æˆ‘ä»¬çŸ¥é“eï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è§£è¿™ä¸ªå¼å­</p><p>$ hm_1=s^e=(hm_1)^{ed}=(hm_1)^{k*phi+1}=hm_1\mod n $</p><p>çŸ¥é“hm1åï¼Œæˆ‘ä»¬è¦åœ¨çº¿ç½‘ç«™è§£ä¸€ä¸‹md5ï¼Œå°±å¯ä»¥çŸ¥é“m0äº†ï¼Œç„¶åç”¨æ¥è·å–flagçš„å‡½æ•°ä¸€ç”¨å°±å¯ä»¥è§£å‡ºflagäº†ï¼Œè§£å‡ºçš„m0å¦‚ä¸‹ï¼Œåœ¨çº¿ç½‘ç«™æ˜¯<a href="https://cmd5.com/">md5åœ¨çº¿è§£å¯†ç ´è§£</a></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737599382838-6cf1fd7c-001a-4ddb-bcbb-e53d56dc6138.png" alt=""></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = <span class="number">7270513885194445005322518350289419893608325839878215682947885852347014936106128407554345668066935779849573932055239642406851308417046145495939362638652861562381316163080735160853285303356461796079298817982074998651099375222398758502559657988024308504098238446594559605603104540325738607539729848183025647146</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">118167767283404647838357773955032661171703847685597271116789633496884884504237966404005641401909577369476550625894333528860763752286157264860218284704704444830864099870199623580368198306940575628872723737071517733553706154898255520538220530675603850372384339470410704813339357637359108745206967929184573003377</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">m0</span>):  <span class="comment"># è¯·ç”¨è¿™ä¸ªå‡½æ•°æ¥è½¬må¾—åˆ°flag</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m0 + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m0.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hm_int = <span class="built_in">pow</span>(s, e, n)</span><br><span class="line">hm_str = long_to_bytes(hm_int).decode()</span><br><span class="line"><span class="built_in">print</span>(hm_str)  <span class="comment"># 86133884de98baada58a8c4de66e15b8</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;adm0n12&#x27;</span>  <span class="comment"># é€šè¿‡ cmd5.com æŸ¥è¯¢åˆ°çš„ç»“æœ</span></span><br><span class="line">get_flag(m)</span><br><span class="line"><span class="comment"># flag&#123;th1s_1s_my_k3y:adm0n120xbfab06114aa460b85135659e359fe443f9d91950ca95cbb2cbd6f88453e2b08b&#125;</span></span><br></pre></td></tr></table></figure><h2 id="easyECC"><a href="#easyECC" class="headerlink" title="easyECC"></a>easyECC</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># type: ignore</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">c_left =bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]) * m[<span class="number">0</span>]</span><br><span class="line">c_right = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;c_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;c_right&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1 = (10968743933204598092696133780775439201414778610710138014434989682840359444219 : 50103014985350991132553587845849427708725164924911977563743169106436852927878 : 1)</span></span><br><span class="line"><span class="string">c2 = (16867464324078683910705186791465451317548022113044260821414766837123655851895 : 35017929439600128416871870160299373917483006878637442291141472473285240957511 : 1)</span></span><br><span class="line"><span class="string">c_left = 15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line"><span class="string">c_right = 3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šECC</p><p>å¾ˆç®€å•çš„ä¸€é“eccäº†ï¼Œæ‰€ä»¥çš„å€¼éƒ½ç»™äº†ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°flagè¢«åˆ†æˆä¸¤éƒ¨åˆ†åˆ†åˆ«ä¹˜äº†m[0]å’Œm[1]ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ†åˆ«è§£å‡ºm[0]å’Œm[1]å°±è¡Œï¼Œé‚£ä¹ˆåªè¦æ±‚å‡ºå¯†æ–‡må°±å¯ä»¥äº†ï¼Œè€Œkå·²ç»ç»™äº†ï¼Œè¯¥æœ‰çš„å€¼ä¹Ÿéƒ½æœ‰äº†ï¼Œæ‰€ä»¥åªè¦å¥—è§£å¯†ä»£ç æ±‚ä¸€ä¸‹å°±å‡ºæ¥äº†ï¼ˆä»£ç ä¹Ÿæ˜¯çœ‹åˆ°ä¸€ç¯‡åšå®¢çŸ¥é“çš„ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œç¯å¢ƒsagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"></span><br><span class="line">c1 = E([<span class="number">10968743933204598092696133780775439201414778610710138014434989682840359444219</span>,<span class="number">50103014985350991132553587845849427708725164924911977563743169106436852927878</span>])</span><br><span class="line">c2 = E([<span class="number">16867464324078683910705186791465451317548022113044260821414766837123655851895</span>,<span class="number">35017929439600128416871870160299373917483006878637442291141472473285240957511</span>])</span><br><span class="line">cipher_left = <span class="number">15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line">cipher_right = <span class="number">3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line"></span><br><span class="line">m = c1 - k * c2</span><br><span class="line">left = cipher_left//m[<span class="number">0</span>]</span><br><span class="line">right = cipher_right//m[<span class="number">1</span>] <span class="comment"># ä¸èƒ½è½¬intæˆ–Integerå‹ï¼Œä¸ç„¶ç»“æœä¸º0ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¾ˆå¥‡æ€ª</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(left))+long_to_bytes(<span class="built_in">int</span>(right)))</span><br></pre></td></tr></table></figure><p>å¾—å‡ºflagä¸ºï¼š<strong>flag{This_is_the_last_crypto_}</strong></p><h2 id="æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ"><a href="#æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ" class="headerlink" title="æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ"></a>æ²¡eä¹Ÿèƒ½ç©ï¼Ÿ</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d %(p-<span class="number">1</span>)</span><br><span class="line">dq = d%(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;<span class="built_in">pow</span>(bytes_to_long(flag),e,p*q)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q=<span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dp=<span class="subst">&#123;dp&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dq=<span class="subst">&#123;dq&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line"><span class="string">p=108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line"><span class="string">q=121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line"><span class="string">dp=11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line"><span class="string">dq=46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šdpï¼Œdqæ³„éœ²</p><p>æŠŠæœ€åä¸€ä¸ªå¼å­å˜åŒ–ä¸€ä¸‹å¯ä»¥å¾—åˆ°</p><p>$ m = c^d + k \times  n = c^d + k\times p\times q $</p><p>ä¸¤è¾¹åŒæ—¶åˆ†åˆ«æ¨¡på’Œqï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªå¼å­</p><p>$ m_p = m\mod p = c^d \mod p $</p><p>$ m_q = m \mod q = c^d \mod q $</p><p>ç”±å·²çŸ¥çš„ç¬¬ä¸€äºŒä¸ªå¼å­æˆ‘ä»¬å¯ä»¥çŸ¥é“</p><p>$ d = k\timesï¼ˆp - 1ï¼‰+ dp $</p><p>å†å¸¦å…¥$ m_p = c^d \mod p $å¯ä»¥å¾—åˆ°</p><p>$ m_p = c^{dp} \mod p $</p><p>å³å¯ä»¥æ±‚å‡ºmpï¼Œmq</p><p>å†åˆ†æä¸€ä¸‹è¿™ä¸¤ä¸ªå¼å­$ m_p = c^d \mod p $ï¼›$ m_q = c^d \mod q $æˆ‘ä»¬å¯ä»¥å¾—åˆ°</p><p>$ c^d = K\times p +m_p $</p><p>$ c^d = k\times q + m_q $</p><p>ä¸‹å¼å¸¦å…¥ä¸Šå¼å¾—åˆ°</p><p>$ K\times p = k\times q + m_q - m_p $</p><p>ä¸¤è¾¹æ¨¡qå¾—åˆ°</p><p>$ K\times p = ï¼ˆm_q - m_pï¼‰\mod q $</p><p>ä¸¤è¾¹ä¹˜ä¸€ä¸ªpå¯¹qçš„é€†å…ƒï¼Œå¾—åˆ°</p><p>$ K = pâ€™\times (m_q - m_p) \mod q $</p><p>æ±‚å‡ºKåå†å¸¦å…¥$ c^d = K\times p +m_p $å°±å¯ä»¥å¾—åˆ°c^dï¼Œä»è€Œè§£å‡ºæ˜æ–‡</p><p>ä¸‹é¢æ˜¯ä»£ç å®ç°ï¼ˆä»£ç å°±æ˜¯çŸ­çŸ­å‡ è¡Œï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line">p=<span class="number">108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line">q=<span class="number">121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line">dp=<span class="number">11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line">dq=<span class="number">46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">m = (((m1-m2)*I)%p)*q+m2</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>å¾—å‡ºflagä¸ºï¼š<strong>flag{No_course_e_can_play}</strong></p><h2 id="æ ¼æ ¼ä½ å¥½æ£’"><a href="#æ ¼æ ¼ä½ å¥½æ£’" class="headerlink" title="æ ¼æ ¼ä½ å¥½æ£’"></a>æ ¼æ ¼ä½ å¥½æ£’</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">1024</span>)</span><br><span class="line">b = getPrime(<span class="number">1536</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">8</span>, <span class="number">2</span>**<span class="number">9</span>)</span><br><span class="line"><span class="keyword">assert</span> ((p+<span class="number">2</span>*r) * <span class="number">3</span>*a + q) % b &lt; <span class="number">70</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, p*q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a =&#x27;</span>, a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b =&#x27;</span>, b)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 75671328500214475056134178451562126288749723392201857886683373274067151096013132141603734799638338446362190819013087028001291030248155587072037662295281180020447012070607162188511029753418358484745755426924178896079516327814868477319474776976247356213687362358286132623490797882893844885783660230132191533753</span></span><br><span class="line"><span class="string">a = 99829685822966835958276444400403912618712610766908190376329921929407293564120124118477505585269077089315008380226830398574538050051718929826764449053677947419802792746249036134153510802052121734874555372027104653797402194532536147269634489642315951326590902954822775489385580372064589623985262480894316345817</span></span><br><span class="line"><span class="string">b = 2384473327543107262477269141248562917518395867365960655318142892515553817531439357316940290934095375085624218120779709239118821966188906173260307431682367028597612973683887401344727494920856592020970209197406324257478251502340099862501536622889923455273016634520507179507645734423860654584092233709560055803703801064153206431244982586989154685048854436858839309457140702847482240801158808592615931654823643778920270174913454238149949865979522520566288822366419746</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šæ ¼æ”»å‡»</p><p>å…³æ³¨æ–­è¨€<code>((p+2*r) * 3*a + q) % b &lt; 70</code></p><p>ç»“æœæ˜¯ä¸€ä¸ªå°äº70çš„æ•°ï¼Œç›¸å½“äºå·²çŸ¥ï¼ˆçˆ†ç ´å¾ˆå¿«çš„ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥è®¾æˆxï¼Œå°±å¯ä»¥å†™å‡ºä¸‹é¢è¿™ä¸ªæ ·å­</p><p>$ 3a(p+2r)+q=k\times b+x $</p><p>ç§»é¡¹åå°±å¯ä»¥æ„é€ å‡ºä¸‹é¢è¿™ä¸ªæ ¼</p><p>$ \begin{align}(k,p+2r)\begin{pmatrix} b&amp;0 \\ 3a&amp;1 \end{pmatrix} =(x-q,p+2r)\end{align} $</p><p>å¤ç°æ—¶æŠŠ3aæ”¾åœ¨ä¸Šé¢å‘ç°ä¸è¡Œï¼Œåé¢æƒ³äº†ä¸€ä¸‹ç¡®å®æ˜¯ï¼Œå› ä¸ºé‚£æ ·å‘é‡çš„å¤§å°å°±æœªçŸ¥äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾—åƒä¸Šé¢è¿™æ ·æ„é€ ï¼Œæ„é€ å¥½äº†sageè·‘å‡ºæ¥åï¼Œæˆ‘ä»¬å¾—çˆ†ç ´ä¸€ä¸‹xå’Œrï¼Œè¿™æ ·å°±å¯ä»¥æŠŠpå’Œqæ±‚å‡ºæ¥ï¼Œç„¶åå°±æ ‡å‡†rsaå°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from tqdm import *</span></span><br><span class="line"> </span><br><span class="line">c = <span class="number">63970090307730335877809721304200883550049640814796584855311919788444862517887223732986595675409088426370045912297203884697715744287109423956446588104144896948474600924252971426757693149049788176140093762669257572818136268391076675502412382985137721246839664247241033867414491199483652292036165169353341736721</span></span><br><span class="line">a = <span class="number">169095591032842107903100075180638676605851796444162152675549552436872904263319011471312171874748357621716550291723406808357475877569622382251716493461335948233920131882151228308789748286370580144669281233868187101339909767205887609164975015547772498904502805235278789412044800177551190013789791754504529931231</span></span><br><span class="line">b = <span class="number">6064645365981235887306179215270851271718801644429108711725310294864007556801445216060166346337708059041073442260127725535139356989204300545757168654885686344461282796094266688090445897296901297377920786192865778222921548386038058555872765953356732109313734205459623312689902913019046944089470201948948652890006944620407534229412159275346491001935499731177063675134035072472112134333424000794637616785944210359606751334132126595044554089452160862222153579096125950</span></span><br><span class="line"> </span><br><span class="line">mat = [[b,<span class="number">0</span>],[<span class="number">3</span>*a,<span class="number">1</span>]]</span><br><span class="line">M = Matrix(ZZ,mat)</span><br><span class="line">qq,pp= M.LLL()[<span class="number">0</span>]  <span class="comment"># pp=p+2r,qq=x-q</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(pp)</span><br><span class="line"><span class="built_in">print</span>(qq)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">pp = <span class="number">11955063068051544630946316468962078511069091314797871913634545080191072376861594574934166492638293328464581874921393333283491910392413726570145081889323365</span></span><br><span class="line"></span><br><span class="line">qq = <span class="number">8045923199163511894962326127962855996723489290534633417316373444301965842496393267385921312122459846420286036232396674929308891656715922685980889381589005</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">63970090307730335877809721304200883550049640814796584855311919788444862517887223732986595675409088426370045912297203884697715744287109423956446588104144896948474600924252971426757693149049788176140093762669257572818136268391076675502412382985137721246839664247241033867414491199483652292036165169353341736721</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">8</span>, <span class="number">2</span> ** <span class="number">9</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">70</span>):</span><br><span class="line">        p = pp - <span class="number">2</span> * i</span><br><span class="line">        q = qq + j</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> gmpy2.gcd(phi, <span class="number">65537</span>) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        d = gmpy2.invert(<span class="number">65537</span>, phi)</span><br><span class="line">        n = p * q</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">        flag = libnum.n2s(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—å‡ºflagä¸ºï¼š<strong>flag{u_are_@_master_of_latt1ce_Crypt0gr@phy}</strong></p><h2 id="å­¦ä»¥è‡´ç”¨"><a href="#å­¦ä»¥è‡´ç”¨" class="headerlink" title="å­¦ä»¥è‡´ç”¨"></a>å­¦ä»¥è‡´ç”¨</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    <span class="comment"># padäº†ä¸€ä¸‹ï¼Œä»”ç»†çœ‹çœ‹ï¼Œåˆ«å¥½ä¸å®¹æ˜“è§£å‡ºæ¥äº†å´æ²¡çœ‹åˆ°flagğŸ‘¼</span></span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">16</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;*&quot;</span> + msg + <span class="string">b&quot;*&quot;</span> + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    Nbits = <span class="number">2048</span></span><br><span class="line">    flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">    gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line">    </span><br><span class="line">    flag1 = bytes_to_long(pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], Nbits-<span class="number">1</span>))</span><br><span class="line">    flag2 = bytes_to_long(pad(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:], Nbits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>, <span class="built_in">pow</span>(flag1, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>, <span class="built_in">pow</span>(flag2, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c3 =&#x27;</span>, <span class="built_in">pow</span>(flag1 + flag2 + bytes_to_long(gift), e, n))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line"><span class="string">c1 = 8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line"><span class="string">c2 = 14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line"><span class="string">c3 = 8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šgroebner_basis()</p><p>è™½è¯´åŸç†è¿˜ä¸ç†è§£ï¼Œä½†æ˜¯è§£é¢˜ä»£ç çœ‹çš„ä¸ƒä¸ƒå…«å…«äº†ï¼Œå°±æ˜¯ç”¨groebner_basis()è¿™ä¸ªå‡½æ•°å¯ä»¥æ±‚å‡ºå¤šé¡¹å¼çš„è§£æ¥ï¼Œæ ¼å¼æ˜¯xå‡å»æ‰€æ±‚å€¼çš„ä¸€ä¸ªå¤šé¡¹å¼ï¼Œæ‰€ä»¥å–è´Ÿï¼Œå†å–ç³»æ•°ï¼Œå°±å¯ä»¥å¾—åˆ°æ‰€æ±‚å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">n = <span class="number">17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line">c1 = <span class="number">8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line">c2 = <span class="number">14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line">c3 = <span class="number">8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line">gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line"></span><br><span class="line">x, y = PolynomialRing(Zmod(n), <span class="string">&#x27;x, y&#x27;</span>).gens()</span><br><span class="line">f1 = x**<span class="number">3</span> - c1</span><br><span class="line">f2 = y**<span class="number">3</span> - c2</span><br><span class="line">f3 = (x + y + bytes_to_long(gift))**<span class="number">3</span> - c3</span><br><span class="line"></span><br><span class="line">gb = Ideal(f1, f2, f3).groebner_basis()</span><br><span class="line">f1, f2 = gb    <span class="comment"># è¿”å›ä¸€ä¸ªå¤šé¡¹å¼</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">int</span>(-f1.coefficients()[<span class="number">1</span>])    <span class="comment"># å–è´Ÿæ˜¯ä¸ºäº†æ±‚å‡ºmï¼Œå› ä¸ºä¸Šé¢å¤šé¡¹å¼æ˜¯xå‡å»æˆ‘ä»¬æ‰€æ±‚</span></span><br><span class="line"></span><br><span class="line">flag2 = <span class="built_in">int</span>(-f2.coefficients()[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="comment"># å‡ºé¢˜çš„æ—¶å€™åŠ äº†ç»™padï¼Œå¤§å®¶å¾—æ³¨æ„ä¸€ä¸‹ï¼Œflagåœ¨ä¸€å †trashä¸­é—´ï¼Œåˆ«åšå‡ºäº†å´æ²¡çœ‹è§flag</span></span><br><span class="line"><span class="built_in">print</span>((long_to_bytes(flag1)).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">2</span>]+(long_to_bytes(flag2).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;W1Sh_you_Bec0me_an_excelL3nt_crypt0G2@pher&#125;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> å¤ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Coopersmith</title>
      <link href="/2025/02/02/Coopersmith/"/>
      <url>/2025/02/02/Coopersmith/</url>
      
        <content type="html"><![CDATA[<p>å¶é‡é¢˜ç›®ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœï¼Œæ•…æ·±å…¥å­¦ä¹ </p><blockquote><p>å‚è€ƒæ–‡ç« ï¼Œå»ºè®®ç»†ç»†ç ”è¯»</p><p><a href="https://zhuanlan.zhihu.com/p/4783052681">https://zhuanlan.zhihu.com/p/4783052681</a></p><p><a href="https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf">https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf</a></p><p><a href="https://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots">https://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_modn_dense_ntl.html#sage.rings.polynomial.polynomial_modn_dense_ntl.small_roots</a></p><p><a href="https://www.ruanx.net/coppersmith/">https://www.ruanx.net/coppersmith/</a></p></blockquote><h1 id="å®šç†"><a href="#å®šç†" class="headerlink" title="å®šç†"></a>å®šç†</h1><p>è®¾Næ˜¯ä¸€ä¸ªå¤§æ•´æ•°ï¼Œ$ p \geq N^\beta $æ˜¯ N çš„ä¸€ä¸ªå› å­ï¼Œè®¾ $ f(x) $ æ˜¯ä¸€ä¸ªdé˜¶(æ¬¡æ•°ä¸ºd)çš„å¤šé¡¹å¼ï¼Œä»¤$ X=\frac{1}{2}N^{\frac{1}{d} - \varepsilon} $ï¼Œå…¶ä¸­$ 0\le\varepsilon\le min(0.18,\frac{1}{d}) $ï¼Œé‚£ä¹ˆå¯¹äºç»™å®šçš„$ (N,f(x)) $ï¼Œæœ‰</p><ul><li>åœ¨æ¨¡Næ„ä¹‰ä¸‹ï¼Œå¯ä»¥å¿«é€Ÿæ±‚å‡º$ f(x)=0 $æ»¡è¶³$ \left | x \right | \le X $çš„å…¨ä½“æ­£æ•´æ•°è§£ï¼ˆå°±æ˜¯æ±‚å‡ºXä»¥å†…çš„æ ¹ï¼‰</li><li>ç»™å®š$ \beta $ï¼Œå¯ä»¥å¿«é€Ÿæ±‚å‡ºæ¨¡pæ„ä¹‰ä¸‹è¾ƒå°çš„æ ¹ï¼ˆå°±æ˜¯æ±‚æ¨¡å› å­æ„ä¹‰ä¸‹çš„æ ¹ï¼Œå¯ä»¥è§£å†³ä½ä½ä¸¢å¤±ç±»é¢˜ç›®ï¼‰</li></ul><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>æœ‰äº†è¿™ä¸ªå®šç†ï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šå¥½å¥‡ä¸ºä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆå¯ä»¥è¿™ä¹ˆåšï¼Œä½†æ˜¯è¿™ä¸ªåŸç†æŒºå¤æ‚çš„ï¼Œç«™é•¿ç°æ°´å¹³æ— æ³•æ·±å…¥ç†è§£ï¼Œä½†æ˜¯å¤§å®¶å¯ä»¥ç‚¹å‡»ä¸Šé¢çš„æ¨èæ–‡ç« ï¼ˆå°¤å…¶é‚£æœ¬ä¹¦ï¼Œæ„Ÿè§‰æ‰¾åˆ°å®è´äº†ï¼‰ï¼Œä¸‹é¢ä¼šç®€å•è®²ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼Œä¸ä¸€å®šå¯¹ï¼Œå»ºè®®ç›´æ¥çœ‹æˆªå›¾</p><p>å°±æ˜¯æŠŠä¸€ä¸ªå¤šé¡¹å¼çœ‹æˆä¸€ä¸ªå¤šç»´å‘é‡ï¼Œå†æ„é€ æˆä¸€ä¸ªæ ¼ï¼Œä¹‹åå†è¿ç”¨LLLæ ¼åŸºè§„çº¦æ‰¾åˆ°ä¸€ä¸ªèŒƒæ•°æœ€å°çš„å‘é‡ï¼Œç„¶åæ ¹æ®ä¸€ä¸ªå¼•ç†ï¼Œå°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå¤šé¡¹å¼çš„ä¸€ä¸ªæ ¹ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1738330147438-9ce88761-e403-45ca-9811-bb123b71efc9.png" alt=""></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1738330127252-455ad20f-96b0-42e7-8691-069701d5bf34.png" alt=""></p><h1 id="small-roots"><a href="#small-roots" class="headerlink" title="small_roots"></a>small_roots</h1><p>çŸ¥é“è¿™ä¹ˆä¸€ä¸ªå®šç†åæˆ‘ä»¬æœŸæœ›åœ¨ä»£ç å±‚é¢å®ç°å®ƒï¼Œè¿™å°±è¦ç”¨åˆ°Sagemathé‡Œçš„small_rootsè¿™ä¸ªå‡½æ•°ï¼Œä¸‹é¢ä¼šå…·ä½“ä»‹ç»è¿™ä¸ªå‡½æ•°ï¼Œé¦–å…ˆæ”¾ä¸€ä¸ªå…·ä½“å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">P = p + x</span><br><span class="line">low_p = P.monic().small_roots(X = <span class="number">2</span>**<span class="number">340</span>, beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(low_p)</span><br></pre></td></tr></table></figure><blockquote><p>PolynomialRing ï¼šæ„é€ å¤šé¡¹å¼ç¯</p><p>Zmod(n) ï¼šæ¨¡è¿ç®—</p><p>implementation=â€™NTLâ€™ ï¼šæ‰§è¡Œ NTL</p><p>small_roots( X=ï¼Ÿ , beta=ï¼Ÿ , epsilon=ï¼Ÿ)ï¼šè®¡ç®—å¤šé¡¹å¼çš„å°æ•´æ•°æ ¹ï¼Œè¿”å›ç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨</p><p>Xï¼šæ ¹çš„ç»å¯¹ä¸Šç•Œï¼Œæ¯”å¦‚è¯´ä¸‹é¢é‚£é“é¢˜ç›®ï¼Œä¸Šç•Œå°±æ˜¯2**340</p><p>betaï¼šcoopersmithé‡Œçš„ä¸€ä¸ªå‚æ•°ï¼Œç»™å®š$ \beta $ï¼Œä»¥å¿«é€Ÿæ±‚å‡ºæ¨¡æŸä¸ªpæ„ä¹‰ä¸‹è¾ƒå°çš„æ ¹ï¼Œå…¶ä¸­$ p\ge n^\beta $ï¼Œæ˜¯nçš„å› æ•°ï¼Œ$ \beta $ä¸€èˆ¬å–0.4</p><p>epsilonï¼šä¹Ÿæ˜¯coopersmithé‡Œçš„ä¸€ä¸ªå‚æ•°ï¼Œç¨‹åºé»˜è®¤å¥½åƒæ˜¯$ \beta/8 $ï¼Œå¹³æ—¶ä¸å¤ªä¼šç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œéœ€è¦æ—¶åŠ åœ¨betaåé¢å°±è¡Œ</p><p>monic()ï¼šç”¨äºå°†å¤šé¡¹å¼çš„é¦–é¡¹ç³»æ•°å½’ä¸€åŒ–ä¸º1ã€‚å®ƒæ¥å—ä¸€ä¸ªå¤šé¡¹å¼ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å¤šé¡¹å¼ï¼Œå…¶ä¸­é¦–é¡¹ç³»æ•°å·²ç»è¢«å½’ä¸€åŒ–ä¸º1ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç®€åŒ–å¤šé¡¹å¼çš„è¡¨è¾¾å¼ï¼Œä½¿å…¶æ›´æ˜“äºè®¡ç®—å’Œåˆ†æã€‚</p></blockquote><p>è¿™æ ·ç®€å•çš„ä½¿ç”¨æ–¹æ³•å°±äº†è§£äº†ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„é¢˜ç›®ï¼Œè‡ªå·±è¿ç”¨ä¸€ä¸‹</p><h1 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h1><h2 id="1-where-is-P"><a href="#1-where-is-P" class="headerlink" title="1.where is P?"></a>1.where is P?</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m=bytes_to_long(<span class="string">b&#x27;XXXX&#x27;</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">P=p&gt;&gt;<span class="number">340</span></span><br><span class="line"><span class="built_in">print</span>(P)</span><br><span class="line">a=<span class="built_in">pow</span>(P,<span class="number">3</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a=&quot;</span>,a)</span><br><span class="line"><span class="comment">#n= 24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span></span><br><span class="line"><span class="comment">#c= 6566517934961780069851397787369134601399136324586682773286046135297104713708615112015588908759927424841719937322574766875308296258325687730658550956691921018605724308665345526807393669538103819281108643141723589363068859617542807984954436567078438099854340705208503317269397632214274507740533638883597409138972287275965697689862321166613821995226000320597560745749780942467497435742492468670016480112957715214640939272457886646483560443432985954141177463448896521810457886108311082101521263110578485768091003174683555938678346359150123350656418123918738868598042533211541966786594006129134087145798672161268647536724</span></span><br><span class="line"><span class="comment">#a= 22184346235325197613876257964606959796734210361241668065837491428527234174610482874427139453643569493268653377061231169173874401139203757698022691973395609028489121048788465356158531144787135876251872262389742175830840373281181905217510352227396545981674450409488394636498629147806808635157820030290630290808150235068140864601098322473572121965126109735529553247807211711005936042322910065304489093415276688746634951081501428768318098925390576594162098506572668709475140964400043947851427774550253257759990959997691631511262768785787474750441024242552456956598974533625095249106992723798354594261566983135394923063605</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šå·²çŸ¥pé«˜ä½ï¼Œæ±‚ä½ä½ ï¼›coopersmith</p><p>æ ¹æ®é¢˜ç›®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ˜¯å°†på³ç§»äº†340ä½ï¼Œæˆ‘ä»¬å†æ¬¡å·¦ç§»åå¾—åˆ°çš„på°±ä¼šç¼ºå¤±ä½ä½çš„340ä½ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¾—ç”¨åˆ°small_rootså‡½æ•°ï¼ˆåŸç†æ˜¯coopersmithï¼‰æ¥è·å–ä½ä½ã€‚</p><p>æ€»çš„æ¥è¯´å°±æ˜¯è¿™ä¸ªå‡½æ•°å¯ä»¥æ±‚ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ„é€ $ f=p_{high}+x $ï¼ˆåœ¨æ¨¡næƒ…å†µä¸‹çš„è§£ï¼Œç»™å®š$ \beta $å°±å¯ä»¥å¿«é€Ÿæ±‚å‡ºæ¨¡æŸä¸ªbæ„ä¹‰ä¸‹è¾ƒå°çš„æ ¹ï¼Œå…¶ä¸­$ b\ge n^\beta $ï¼Œæ˜¯nçš„å› æ•°ï¼‰</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“pçš„ä½ä½ï¼Œç„¶åå°±å¯ä»¥çŸ¥é“pï¼Œä¹‹åå°±å¯ä»¥çŸ¥é“qï¼Œç„¶åå°±RSAè§£å¯†å°±è¡Œï¼Œä½†æ˜¯é¢˜ç›®æ²¡æœ‰ç›´æ¥ç»™æˆ‘ä»¬pçš„é«˜ä½ï¼Œè€Œæ˜¯aï¼Œaæ»¡è¶³ä¸‹é¢è¿™ä¸ªå¼å­</p><p>$ a=p^3\mod n $</p><p>æ‰€ä»¥$ p^3=a+k*n $æˆ‘ä»¬çˆ†ç ´ä¸€ä¸‹kï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å¼€ä¸‰æ¬¡æ–¹ï¼Œå°±å¯ä»¥æ±‚å‡ºpï¼ˆæ±‚å‡ºæ¥çš„pè¦å†å·¦ç§»ä¸€ä¸‹æ‰æ˜¯é«˜ä½ï¼‰</p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n= <span class="number">24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span></span><br><span class="line">c= <span class="number">6566517934961780069851397787369134601399136324586682773286046135297104713708615112015588908759927424841719937322574766875308296258325687730658550956691921018605724308665345526807393669538103819281108643141723589363068859617542807984954436567078438099854340705208503317269397632214274507740533638883597409138972287275965697689862321166613821995226000320597560745749780942467497435742492468670016480112957715214640939272457886646483560443432985954141177463448896521810457886108311082101521263110578485768091003174683555938678346359150123350656418123918738868598042533211541966786594006129134087145798672161268647536724</span></span><br><span class="line">a= <span class="number">22184346235325197613876257964606959796734210361241668065837491428527234174610482874427139453643569493268653377061231169173874401139203757698022691973395609028489121048788465356158531144787135876251872262389742175830840373281181905217510352227396545981674450409488394636498629147806808635157820030290630290808150235068140864601098322473572121965126109735529553247807211711005936042322910065304489093415276688746634951081501428768318098925390576594162098506572668709475140964400043947851427774550253257759990959997691631511262768785787474750441024242552456956598974533625095249106992723798354594261566983135394923063605</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    p = a+k*n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.iroot(p,<span class="number">3</span>)[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(gmpy2.iroot(p,<span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">p=<span class="number">148500014720728755901835170447203030242113125689825190413979909224639701026120883281188694701625473553602289432755479244507504340127322979884849883842306663453018960250560834067472479033116264539127330613635903666209920113813160301513820286874124210921593865507657148933555053341577090100101684021531775022459</span></span><br><span class="line">p=p&lt;&lt;<span class="number">340</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"></span><br><span class="line">P = p + x</span><br><span class="line">low_p = P.monic().small_roots(X = <span class="number">2</span>**<span class="number">340</span>, beta = <span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(p+low_p)</span><br><span class="line">p=p+low_p</span><br><span class="line">q=n//p</span><br><span class="line">n = p * q</span><br><span class="line">phin = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)          <span class="comment"># æ¬§æ‹‰å‡½æ•°</span></span><br><span class="line">d = gmpy2.invert(e,phin)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># LitCTF&#123;Y0U_hAV3_g0T_Th3_r1ghT_AnsW3r&#125;</span></span><br></pre></td></tr></table></figure><h2 id="2-easy-ya"><a href="#2-easy-ya" class="headerlink" title="2.easy_ya"></a>2.easy_ya</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p = getPrime(<span class="number">512</span>)</span><br><span class="line">            q = getPrime(<span class="number">512</span>)</span><br><span class="line">            n = p*q</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = inverse(e,phi)</span><br><span class="line">            <span class="keyword">return</span> p,q,d,n,e</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">p,q,d,n,e = gen()</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag+os.urandom(<span class="number">32</span>))</span><br><span class="line">M = m%r</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = %d&quot;</span>%r)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;M = %d&quot;</span>%M)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = %d&quot;</span>%n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = %d&quot;</span>%e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span>%c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">r = 7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span></span><br><span class="line"><span class="string">M = 4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span></span><br><span class="line"><span class="string">n = 131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string">c = 46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šcoopersmith</p><p>ä¸€å¼€å§‹çœ‹åˆ°eå¾ˆå°ï¼Œæƒ³åˆ°ä¼šä¸ä¼šæ˜¯ä½å¯†æŒ‡æ•°åŠ å¯†ï¼Œç”¨äº†é‚£ä¸ªè„šæœ¬å‘ç°ä¸è¡Œï¼Œçˆ†ä¸å‡ºæ¥ï¼Œè¯´æ˜å¾—ç”¨åˆ«çš„æ–¹æ³•ï¼Œé‚£åªèƒ½å…³æ³¨<code>M = m%r</code>è¿™ä¸ªå¼å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°$ m=M+k*r $</p><p>å†æ ¹æ®rsaåŠ å¯†çš„å¼å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸‹é¢è¿™ä¸ªå¤šé¡¹å¼</p><p>$ c=m^e\mod n $</p><p>$ m^e-c=(M+k*r)^3-c=0\mod n $</p><p>æ‰€ä»¥$ f=(M+k*r)^3-c $ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®small_roots()å‡½æ•°æ±‚kï¼Œå”¯ä¸€æœ‰ç‚¹æŒ‘æˆ˜çš„æ˜¯kçš„ä¸Šé™æˆ‘ä»¬ä¸çŸ¥é“ï¼Œå¾—çŒœä¸€ä¸‹ï¼Œå®æµ‹2**80åˆ°2**255éƒ½å¯ä»¥æ±‚å‡ºkï¼Œè¿™ä¹Ÿè¯´æ˜äº†è¿™ä¸ªä¸Šç•Œå‚æ•°ä¸æ˜¯è¶Šå¤§è¶Šå¥½</p><p>å…·ä½“ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = <span class="number">7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473</span></span><br><span class="line">M = <span class="number">4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558</span></span><br><span class="line">n = <span class="number">131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f = (M + x*r)**<span class="number">3</span>-c</span><br><span class="line">k = f.monic().small_roots(X = <span class="number">2</span>**<span class="number">80</span>, beta = <span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line">k=<span class="number">810968823598060539864535</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(M+k*r))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;53a2e494-964d-4506-a2c4-c34b9475dedd&#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-baby-xor"><a href="#3-baby-xor" class="headerlink" title="3.baby_xor"></a>3.baby_xor</h2><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">32</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = p^m</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span></span><br><span class="line"><span class="string">c1 = 11201139662236758800406931253538295757259990870588609533820056210585752522925690049252488581929717556881067021381940083808024384402885422258545946243513996</span></span><br><span class="line"><span class="string">c2 = 112016152270171196606652761990170033221036025260883289104273504703557624964071464062375228351458191745141525003775876044271210498526920529385038130932141551598616579917681815276713386113932345056134302042399379895915706991873687943357627747262597883603999621939794450743982662393955266685255577026078256473601</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šcoopersmith</p><blockquote><p><a href="https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf">https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf</a> å¾ˆå¥½çš„ä¸€æœ¬ä¹¦ï¼Œå¶ç„¶å‘ç°</p></blockquote><p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬å¾—ä»<code>c1 = p^m</code>è¿™ä¸ªå¼å­å…¥æ‰‹ï¼Œå› ä¸º<code>len(flag)==32</code>ï¼Œè¿™å°±ç›¸å½“äº256ä½ï¼Œæ‰€ä»¥pçš„å‰256ä½æ˜¯æ­£å¸¸çš„ï¼Œå°±æ˜¯ä½ä½ç¼ºå¤±äº†ï¼Œç”¨small_rootså‡½æ•°æ±‚ä½ä½ï¼Œä½†æ˜¯å‘ç°æ±‚ä¸å‡ºæ¥ï¼Œåé¢æŸ¥äº†ä¸€ä¸‹æ‰å‘ç°æ˜¯çŸ¥é“åº”è¯¥æ˜¯é«˜ä½ä¸å¤Ÿï¼Œå¾—å†çˆ†ç ´å‡ºä¸€éƒ¨åˆ†ï¼ˆçœ‹äº†æ–‡çŒ®æ‰çŸ¥é“å°æ ¹å¥½åƒå¾—å°äº$ \frac{1}{2\sqrt2}N^{\frac{1}{4}-\varepsilon} $ï¼‰</p><p>ç½‘ä¸ŠæŸ¥äº†ä»£ç ï¼Œå¦‚ä¸‹ï¼ˆå¯¼å…¥çš„tqdmåº“å°±æ˜¯ç»™ä¸€ä¸ªè¿›åº¦æ¡ï¼Œå¥½çœ‹ä¸€ç‚¹ï¼ŒçœŸçš„çˆ†äº†å¥½ä¹…å¥½ä¹…ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span></span><br><span class="line">c1 = <span class="number">11201139662236758800406931253538295757259990870588609533820056210585752522925690049252488581929717556881067021381940083808024384402885422258545946243513996</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">p_high = c1 &gt;&gt; <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">     p4 = p_high&lt;&lt;<span class="number">8</span></span><br><span class="line">     p4 = p4 + i</span><br><span class="line">     kbits = pbits - p4.nbits()</span><br><span class="line">     p4 = p4 &lt;&lt; kbits</span><br><span class="line">     PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">     f = x + p4</span><br><span class="line">     roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line">     <span class="keyword">if</span> roots:</span><br><span class="line">         p = p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11201139662236758800406931253538295757259990870588609533820056210585752522925662842097418194280333596411677923137891577493678147771013147838272857867768049</span></span><br></pre></td></tr></table></figure><p>çˆ†å‡ºæ¥på°±å¯ä»¥åŸºæœ¬RSAè§£å¯†äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">11201139662236758800406931253538295757259990870588609533820056210585752522925662842097418194280333596411677923137891577493678147771013147838272857867768049</span></span><br><span class="line">q=n//p</span><br><span class="line">c = <span class="number">112016152270171196606652761990170033221036025260883289104273504703557624964071464062375228351458191745141525003775876044271210498526920529385038130932141551598616579917681815276713386113932345056134302042399379895915706991873687943357627747262597883603999621939794450743982662393955266685255577026078256473601</span></span><br><span class="line"></span><br><span class="line">phin = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)          </span><br><span class="line">d = gmpy2.invert(e,phin)       </span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># LitCTF&#123;oh!!!!coppersmith_is_fun&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> coopersmith </tag>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹ç§°å¯†ç â€”æµå¯†ç </title>
      <link href="/2025/01/22/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E2%80%94%E6%B5%81%E5%AF%86%E7%A0%81/"/>
      <url>/2025/01/22/%E5%AF%B9%E7%A7%B0%E5%AF%86%E7%A0%81%E2%80%94%E6%B5%81%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h1><h2 id="åŠ å¯†æµç¨‹"><a href="#åŠ å¯†æµç¨‹" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h2><h3 id="åˆå§‹åŒ–ç®—æ³•-KSA"><a href="#åˆå§‹åŒ–ç®—æ³•-KSA" class="headerlink" title="åˆå§‹åŒ–ç®—æ³•(KSA)"></a><strong>åˆå§‹åŒ–ç®—æ³•(KSA)</strong></h3><p><strong>Step</strong>1ï¼šå…ˆç”Ÿæˆä¸€ä¸ªkeyï¼Œè‡ªå®šä¹‰ã€‚</p><p><strong>Step2</strong>ï¼šç”Ÿæˆä¸€ä¸ªSç›’ï¼ŒSç›’æœ‰256ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«æ˜¯0ï¼Œ1ï¼Œ2ï¼ŒÂ·Â·Â·Â·Â·Â·ï¼Œ255ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737530118391-e6a0f588-432c-419e-8d43-7dac2223eaff.png" alt=""></p><p><strong>Step3</strong>ï¼šç”Ÿæˆä¸€ä¸ªKç›’ï¼ŒåŒæ ·æ˜¯256ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªKç›’ç”¨keyæ¥å¡«å……ï¼Œå¦‚æœkeyæ˜¯345ï¼Œé‚£ä¹ˆå°±3ï¼Œ4ï¼Œ5ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ3ï¼Œ4ï¼Œ5Â·Â·Â·Â·Â·Â·è¿™æ ·ä¸€ç›´é‡å¤å¡«å……ä¸‹å»ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737530138496-f233326e-ce25-4e35-a533-5e8e827558d1.png" alt=""></p><p><strong>Step4</strong>ï¼šåˆ©ç”¨Kç›’æ¥æ‰“ä¹±æˆ‘ä»¬åˆšåˆšç”Ÿæˆçš„Sç›’ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡ä¸€ä¸ªè§„å®šçš„è½¬æ¢å¼å­ï¼Œæ¯åšä¸€æ¬¡ï¼Œå°±äº¤æ¢Sç›’é‡Œçš„ä¸¤ä¸ªå€¼ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737439889235-473701e8-5e24-4bab-b845-3c8eaad335bf.png?x-oss-process=image%2Fformat%2Cwebp" alt=""></p><p>egï¼šæŒ‰ä¸Šé¢æˆ‘ä»¬é‚£ä¸ªKè¡¨æ‰“ä¹±åçš„Sè¡¨å¦‚ä¸‹ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±è¯•ä¸€ä¸‹ï¼ˆå¾ªç¯äº†ä¸ƒæ¬¡ï¼‰</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737530320751-f4ff1e23-f968-42bb-94c7-88b6055188d4.png" alt=""></p><h3 id="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA"><a href="#ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA" class="headerlink" title="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)"></a><strong>ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)</strong></h3><p>è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ç”Ÿæˆä¸€ä¸ªæ–°ç›’ï¼Œè¿™ä¸ªæ–°ç›’é‡Œæ˜¯ä¸€äº›ä¼ªéšæœºçš„å­å¯†ç ï¼Œç”¨æ¥åŠ å¯†æˆ‘ä»¬çš„æ˜æ–‡ï¼Œè¿™ä¸ªç”Ÿæˆè¿‡ç¨‹ä¹Ÿæœ‰è§„å®šçš„å¼å­ï¼Œå¦‚ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737440962165-c5c6764c-3539-4afa-8620-194787c452dc.png?x-oss-process=image%2Fformat%2Cwebp" alt=""></p><p>ä¸Šå›¾æ˜¯ç”¨æˆ‘ä»¬ä¹‹å‰çš„Kç›’ç›´æ¥å­˜å‚¨æ–°ç”Ÿæˆçš„ä¼ªéšæœºå­å¯†ç ï¼Œè¿™æ— å¯åšéï¼Œåªè¦Sç›’åˆå§‹åŒ–è¿‡åï¼ˆæ‰“ä¹±åï¼‰Kç›’å°±æ²¡ä»€ä¹ˆç”¨äº†ã€‚</p><p>ä¹‹åå°±æ˜¯åŠ å¯†è¿‡ç¨‹ï¼Œå°±æ˜¯ç”¨æˆ‘ä»¬æœ€åå¾—åˆ°çš„é‚£ä¸ªå­å¯†ç æ¥å’Œæ˜æ–‡åšå¼‚æˆ–ï¼Œå¾—åˆ°å¯†æ–‡ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="notRC4"><a href="#notRC4" class="headerlink" title="notRC4"></a>notRC4</h3><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Oo0</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.O0 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.Ooo = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.Ooo0 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="variable language_">self</span>.O0[i] = i</span><br><span class="line">        <span class="variable language_">self</span>.oO0 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">OO0</span>(<span class="params">self, oO0</span>):</span><br><span class="line">        l = <span class="built_in">len</span>(oO0)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="variable language_">self</span>.Ooo0[i] = oO0[i % l]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="variable language_">self</span>.oO0 = (<span class="variable language_">self</span>.oO0 + <span class="variable language_">self</span>.O0[i] + <span class="variable language_">self</span>.Ooo0[i]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.O0[i], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0] = <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0], <span class="variable language_">self</span>.O0[i]</span><br><span class="line">        <span class="variable language_">self</span>.Ooo = <span class="variable language_">self</span>.oO0 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">OO0o</span>(<span class="params">self, length</span>):</span><br><span class="line">        O = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            <span class="variable language_">self</span>.Ooo = (<span class="variable language_">self</span>.Ooo + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.oO0 = (<span class="variable language_">self</span>.oO0 + <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0] = <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo]</span><br><span class="line">            t = (<span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo] + <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0]) % <span class="number">256</span></span><br><span class="line">            O.append(<span class="variable language_">self</span>.O0[t])</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable language_">self</span>.O0)</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">map</span>((<span class="keyword">lambda</span> x: x[<span class="number">0</span>] ^ x[<span class="number">1</span>]), <span class="built_in">zip</span>(s1, s2)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">msg</span>):</span><br><span class="line">    Oo0oO = Oo0()</span><br><span class="line">    Oo0oO.OO0(md5(msg).digest()[:<span class="number">8</span>])</span><br><span class="line">    O0O = Oo0oO.OO0o(<span class="built_in">len</span>(msg))</span><br><span class="line">    <span class="keyword">return</span> xor(msg, O0O)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc(flag))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">s = [166, 163, 208, 147, 181, 152, 69, 90, 253, 114, 150, 255, 218, 220, 34, 74, 63, 201, 70, 115, 233, 96, 43, 169, 103, 191, 14, 149, 143, 25, 105, 93, 199, 246, 51, 75, 20, 5, 107, 3, 52, 135, 111, 139, 113, 47, 184, 76, 161, 174, 23, 30, 173, 72, 198, 56, 85, 55, 106, 126, 244, 223, 104, 29, 112, 148, 219, 118, 165, 59, 98, 175, 125, 100, 17, 16, 108, 6, 214, 140, 130, 206, 89, 62, 4, 236, 251, 91, 28, 45, 18, 53, 1, 144, 193, 133, 73, 44, 57, 88, 250, 204, 177, 67, 120, 21, 79, 71, 2, 185, 211, 200, 65, 234, 117, 9, 226, 142, 230, 209, 132, 248, 242, 196, 101, 81, 238, 247, 119, 179, 131, 229, 94, 50, 22, 183, 24, 158, 190, 222, 155, 172, 19, 12, 225, 10, 189, 232, 146, 227, 212, 210, 31, 164, 138, 78, 122, 176, 121, 0, 194, 186, 162, 160, 188, 168, 216, 153, 37, 252, 127, 145, 33, 82, 58, 170, 61, 254, 136, 207, 8, 237, 159, 36, 239, 95, 178, 167, 182, 102, 27, 123, 60, 129, 42, 26, 99, 39, 97, 40, 235, 205, 7, 49, 202, 197, 109, 195, 245, 171, 180, 15, 46, 83, 48, 156, 92, 249, 38, 32, 203, 41, 124, 54, 217, 134, 154, 35, 157, 128, 137, 221, 84, 86, 215, 213, 80, 11, 116, 141, 241, 64, 224, 87, 77, 187, 68, 192, 151, 240, 13, 228, 231, 66, 110, 243]</span></span><br><span class="line"><span class="string">enc = b&quot;]7\xab\xc9\xd8\x90\x1f\xd2OP\xad\x87&#x27;0\xe1\xff=~&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šrc4ï¼Œå¼‚æˆ–</p><blockquote><p><a href="https://cn-sec.com/archives/3093479.html">https://cn-sec.com/archives/3093479.html</a> å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ç†è§£</p><p><a href="https://www.bilibili.com/video/BV1G64y1Y7p4/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a01a62f772bf2e577e11004dfef0bde1">https://www.bilibili.com/video/BV1G64y1Y7p4/?spm_id_from=333.337.search-card.all.click&amp;vd_source=a01a62f772bf2e577e11004dfef0bde1</a> è¿™ä¸ªè§†é¢‘ä¹Ÿå¾ˆæ£’</p></blockquote><p>è™½ç„¶é¢˜ç›®æ˜¯notRC4ï¼Œä½†æµç¨‹ä¸Šå°±æ˜¯RC4ï¼Œæ‰€ä»¥å…ˆäº†è§£ä¸€ä¸‹RC4çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆæ˜¯<strong>åˆå§‹åŒ–ç®—æ³•(KSA)</strong></p><p>é¦–å…ˆç”Ÿæˆä¸€ä¸ªSç›’ï¼ŒSç›’æœ‰256ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«æ˜¯0ï¼Œ1ï¼Œ2ï¼ŒÂ·Â·Â·Â·Â·Â·ï¼Œ255ï¼Œå¯¹åº”é¢˜ç›®ä»¥ä¸‹ä»£ç ï¼ˆä»£ç åªæˆªå–é‡è¦éƒ¨åˆ†ï¼Œå»ºè®®å®šä½åˆ°é¢˜ç›®ä¸­åˆ†æï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">self</span>.O0 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="variable language_">self</span>.O0[i] = i</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å†ç”Ÿæˆä¸€ä¸ªKç›’ï¼ŒåŒæ ·æ˜¯256ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªKç›’ç”¨keyæ¥å¡«å……ï¼Œå¦‚æœkeyæ˜¯123ï¼Œé‚£ä¹ˆå°±1ï¼Œ2ï¼Œ3ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ1ï¼Œ2ï¼Œ3Â·Â·Â·Â·Â·Â·è¿™æ ·ä¸€ç›´é‡å¤å¡«å……ä¸‹å»ï¼Œç›´åˆ°å¡«å……å®Œæ¯•ï¼Œå¯¹åº”ä¸‹é¢ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">self</span>.Ooo0 = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OO0</span>(<span class="params">self, oO0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="variable language_">self</span>.Ooo0[i] = oO0[i % l]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬è¦åˆ©ç”¨Kç›’æ¥æ‰“ä¹±æˆ‘ä»¬åˆšåˆšç”Ÿæˆçš„Sç›’ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡ä¸€ä¸ªè§„å®šçš„è½¬æ¢å¼å­ï¼Œæ¯åšä¸€æ¬¡ï¼Œå°±äº¤æ¢Sç›’é‡Œçš„ä¸¤ä¸ªå€¼ï¼Œå¦‚ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737439889235-473701e8-5e24-4bab-b845-3c8eaad335bf.png" alt=""></p><p>å› ä¸ºS[i]æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ‰“ä¹±å®Œå…¨å–å†³äºKç›’ï¼Œæ‰“ä¹±åçš„Sç›’æˆ‘ä»¬ç§°ä¸ºåˆå§‹åŒ–åçš„Sç›’ï¼Œå¯¹åº”ä»¥ä¸‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">           <span class="variable language_">self</span>.oO0 = (<span class="variable language_">self</span>.oO0 + <span class="variable language_">self</span>.O0[i] + <span class="variable language_">self</span>.Ooo0[i]) % <span class="number">256</span></span><br><span class="line">           <span class="variable language_">self</span>.O0[i], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0] = <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0], <span class="variable language_">self</span>.O0[i]</span><br><span class="line">       <span class="variable language_">self</span>.Ooo = <span class="variable language_">self</span>.oO0 = <span class="number">0</span><span class="comment"># è¿™é‡Œæ˜¯ä¸ºäº†åé¢çš„ä½¿ç”¨ï¼Œæ‰€ä»¥å†æ¬¡èµ‹0ï¼Œä¸»è¦æ˜¯ä¸Šé¢éƒ¨åˆ†</span></span><br></pre></td></tr></table></figure><p>æ¥ç€æ˜¯<strong>ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)ã€åŠ å¯†é˜¶æ®µ</strong></p><p>è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ç”Ÿæˆä¸€ä¸ªæ–°ç›’ï¼Œè¿™ä¸ªæ–°ç›’é‡Œæ˜¯ä¸€äº›ä¼ªéšæœºçš„å­å¯†ç ï¼Œç”¨æ¥åŠ å¯†æˆ‘ä»¬çš„æ˜æ–‡ï¼Œè¿™ä¸ªç”Ÿæˆè¿‡ç¨‹ä¹Ÿæœ‰è§„å®šçš„å¼å­ï¼Œå¦‚ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42554774/1737440962165-c5c6764c-3539-4afa-8620-194787c452dc.png" alt=""></p><p>ä¸Šå›¾æ˜¯ç”¨æˆ‘ä»¬ä¹‹å‰çš„Kç›’ç›´æ¥å­˜å‚¨æ–°ç”Ÿæˆçš„ä¼ªéšæœºå­å¯†ç ï¼Œè¿™æ— å¯åšéï¼Œåªè¦Sç›’åˆå§‹åŒ–è¿‡åï¼ˆæ‰“ä¹±åï¼‰Kç›’å°±æ²¡ä»€ä¹ˆç”¨äº†ã€‚è¿™ä¸€éƒ¨åˆ†å¯¹åº”é¢˜ç›®ä»£ç å¦‚ä¸‹ï¼ˆé¢˜ç›®æ˜¯ç”¨ä¸€ä¸ªæ–°çš„åˆ—è¡¨æ”¾å­å¯†ç çš„ï¼Œå³Oï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">OO0o</span>(<span class="params">self, length</span>):</span><br><span class="line">        O = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            <span class="variable language_">self</span>.Ooo = (<span class="variable language_">self</span>.Ooo + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.oO0 = (<span class="variable language_">self</span>.oO0 + <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0] = <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0], <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo]</span><br><span class="line">            t = (<span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.Ooo] + <span class="variable language_">self</span>.O0[<span class="variable language_">self</span>.oO0]) % <span class="number">256</span></span><br><span class="line">            O.append(<span class="variable language_">self</span>.O0[t])</span><br><span class="line">        <span class="built_in">print</span>(<span class="variable language_">self</span>.O0)</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¹‹åå°±æ˜¯åŠ å¯†è¿‡ç¨‹ï¼Œå°±æ˜¯ç”¨æˆ‘ä»¬æœ€åå¾—åˆ°çš„é‚£ä¸ªå­å¯†ç æ¥å’Œæ˜æ–‡åšå¼‚æˆ–ï¼Œå¾—åˆ°å¯†æ–‡ã€‚å¯¹åº”ä¸‹é¢è¿™æ®µä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">map</span>((<span class="keyword">lambda</span> x: x[<span class="number">0</span>] ^ x[<span class="number">1</span>]), <span class="built_in">zip</span>(s1, s2)))<span class="comment"># zipä¼šè¿”å›ä¸€ä¸ªå…ƒç»„çš„åˆ—è¡¨ï¼Œè¿”å›åˆ—è¡¨é•¿åº¦ä¸æœ€çŸ­çš„å¯¹è±¡ç›¸åŒ</span></span><br><span class="line">xor(msg, O0O)<span class="comment"># O0Oå°±æ˜¯ä¸Šé¢returnçš„O</span></span><br></pre></td></tr></table></figure><p>åˆ°æ­¤ï¼Œé¢˜ç›®çš„åŠ å¯†è¿‡ç¨‹å®Œæ¯•ï¼Œè¾“å‡ºäº†æœ€åçš„Sç›’å’Œå¯†æ–‡</p><p>è¿™é“é¢˜æ„Ÿè§‰éš¾å°±éš¾å˜é‡å®šä¹‰çš„ç¨€å¥‡å¤æ€ªï¼Œè®©äººæ²¡æœ‰çœ‹ä¸‹å»çš„æ¬²æœ›ï¼Œå¦‚æœåˆ†æä¸ä¸‹å»äº†å»ºè®®ä¼‘æ¯ä¼šå†çœ‹ï¼Œä¸ç„¶çœŸçš„è„‘å£³ç—›ï¼ˆæ¼ï¼‰</p><p>é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆæ±‚è§£æ˜æ–‡å‘¢ï¼Ÿå°±è¦ç”¨åˆ°å¼‚æˆ–çš„çŸ¥è¯†ã€‚å¯†æ–‡æ˜¯é€šè¿‡å¼‚æˆ–å¾—åˆ°çš„ï¼Œè¦å˜å›å»ï¼Œæˆ‘ä»¬å°±å¾—çŸ¥é“å­å¯†ç ç›’ï¼Œç„¶åå†å¼‚æˆ–ä¸€æ¬¡å°±å¯ä»¥å¾—åˆ°flagäº†ï¼Œæ‰€ä»¥ç°åœ¨ç›®çš„æ˜¯æ±‚å­å¯†ç ç›’ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°±å¾—è€ƒè™‘flagçš„æ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°flagè‚¯å®šæ˜¯ä»¥â€™}â€™ç»“å°¾çš„ï¼Œè¿™ä¸ªå·²çŸ¥ï¼Œæˆ‘ä»¬å’Œå¯†æ–‡å¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå­å¯†ç ï¼Œå³S[t]ï¼ŒçŸ¥é“S[t]ä»¥åï¼Œæˆ‘ä»¬é€šè¿‡indexå‡½æ•°å°±å¯ä»¥æŸ¥åˆ—è¡¨çš„ä¸‹æ ‡ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“t</p><p>tçŸ¥é“ä»¥åæˆ‘ä»¬å…³æ³¨è¿™ä¸ªå¼å­<code>t = (self.O0[self.Ooo] + self.O0[self.oO0]) % 256</code>æˆ‘ä»¬æ¢ç§å†™æ³•å¯èƒ½å¥½çœ‹ä¸€ç‚¹<code>t = (S[i] + S[j]) %256</code>ï¼ŒS[i]æ˜¯å·²çŸ¥çš„ï¼ˆæœ€åä¸€æ¬¡iå°±æ˜¯æ˜æ–‡çš„é•¿åº¦ï¼ŒSç›’åˆæ˜¯çŸ¥é“çš„ï¼Œæ‰€ä»¥S[i]å·²çŸ¥ï¼‰æˆ‘ä»¬å°±å¯ä»¥å¾—å‡ºS[j]ï¼Œè¿™æ ·æˆ‘ä»¬é€šè¿‡indexå°±å¯ä»¥çŸ¥é“jï¼Œiå’Œjéƒ½çŸ¥é“ä»¥åæˆ‘ä»¬å°±å¯ä»¥é€†æ¨å›å»ï¼ŒæŠŠæ¯ä¸€æ¬¡çš„S[t]éƒ½ç®—å‡ºæ¥ï¼Œè¿™æ ·å’Œå¯†æ–‡å¼‚æˆ–å°±å¯ä»¥æŠŠæ˜æ–‡æ±‚å‡ºäº†ï¼Œå¯ä»¥åœ¨çº¸ä¸Šå†™ä¸€ä¸‹ï¼Œä¼šå¾ˆæ¸…æ™°</p><p><img src="https://cdn.nlark.com/yuque/0/2025/jpeg/42554774/1737444427312-6ad0c4ab-1185-4814-ad0e-98dbf1409cb1.jpeg" alt=""></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">166</span>, <span class="number">163</span>, <span class="number">208</span>, <span class="number">147</span>, <span class="number">181</span>, <span class="number">152</span>, <span class="number">69</span>, <span class="number">90</span>, <span class="number">253</span>, <span class="number">114</span>, <span class="number">150</span>, <span class="number">255</span>, <span class="number">218</span>, <span class="number">220</span>, <span class="number">34</span>, <span class="number">74</span>, <span class="number">63</span>, <span class="number">201</span>, <span class="number">70</span>, <span class="number">115</span>, <span class="number">233</span>, <span class="number">96</span>, <span class="number">43</span>, <span class="number">169</span>, <span class="number">103</span>, <span class="number">191</span>, <span class="number">14</span>, <span class="number">149</span>, <span class="number">143</span>, <span class="number">25</span>, <span class="number">105</span>, <span class="number">93</span>, <span class="number">199</span>, <span class="number">246</span>, <span class="number">51</span>, <span class="number">75</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">107</span>, <span class="number">3</span>, <span class="number">52</span>, <span class="number">135</span>, <span class="number">111</span>, <span class="number">139</span>, <span class="number">113</span>, <span class="number">47</span>, <span class="number">184</span>, <span class="number">76</span>, <span class="number">161</span>, <span class="number">174</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">173</span>, <span class="number">72</span>, <span class="number">198</span>, <span class="number">56</span>, <span class="number">85</span>, <span class="number">55</span>, <span class="number">106</span>, <span class="number">126</span>, <span class="number">244</span>, <span class="number">223</span>, <span class="number">104</span>, <span class="number">29</span>, <span class="number">112</span>, <span class="number">148</span>, <span class="number">219</span>, <span class="number">118</span>, <span class="number">165</span>, <span class="number">59</span>, <span class="number">98</span>, <span class="number">175</span>, <span class="number">125</span>, <span class="number">100</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">108</span>, <span class="number">6</span>, <span class="number">214</span>, <span class="number">140</span>, <span class="number">130</span>, <span class="number">206</span>, <span class="number">89</span>, <span class="number">62</span>, <span class="number">4</span>, <span class="number">236</span>, <span class="number">251</span>, <span class="number">91</span>, <span class="number">28</span>, <span class="number">45</span>, <span class="number">18</span>, <span class="number">53</span>, <span class="number">1</span>, <span class="number">144</span>, <span class="number">193</span>, <span class="number">133</span>, <span class="number">73</span>, <span class="number">44</span>, <span class="number">57</span>, <span class="number">88</span>, <span class="number">250</span>, <span class="number">204</span>, <span class="number">177</span>, <span class="number">67</span>, <span class="number">120</span>, <span class="number">21</span>, <span class="number">79</span>, <span class="number">71</span>, <span class="number">2</span>, <span class="number">185</span>, <span class="number">211</span>, <span class="number">200</span>, <span class="number">65</span>, <span class="number">234</span>, <span class="number">117</span>, <span class="number">9</span>, <span class="number">226</span>, <span class="number">142</span>, <span class="number">230</span>, <span class="number">209</span>, <span class="number">132</span>, <span class="number">248</span>, <span class="number">242</span>, <span class="number">196</span>, <span class="number">101</span>, <span class="number">81</span>, <span class="number">238</span>, <span class="number">247</span>, <span class="number">119</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">229</span>, <span class="number">94</span>, <span class="number">50</span>, <span class="number">22</span>, <span class="number">183</span>, <span class="number">24</span>, <span class="number">158</span>, <span class="number">190</span>, <span class="number">222</span>, <span class="number">155</span>, <span class="number">172</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">225</span>, <span class="number">10</span>, <span class="number">189</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">227</span>, <span class="number">212</span>, <span class="number">210</span>, <span class="number">31</span>, <span class="number">164</span>, <span class="number">138</span>, <span class="number">78</span>, <span class="number">122</span>, <span class="number">176</span>, <span class="number">121</span>, <span class="number">0</span>, <span class="number">194</span>, <span class="number">186</span>, <span class="number">162</span>, <span class="number">160</span>, <span class="number">188</span>, <span class="number">168</span>, <span class="number">216</span>, <span class="number">153</span>, <span class="number">37</span>, <span class="number">252</span>, <span class="number">127</span>, <span class="number">145</span>, <span class="number">33</span>, <span class="number">82</span>, <span class="number">58</span>, <span class="number">170</span>, <span class="number">61</span>, <span class="number">254</span>, <span class="number">136</span>, <span class="number">207</span>, <span class="number">8</span>, <span class="number">237</span>, <span class="number">159</span>, <span class="number">36</span>, <span class="number">239</span>, <span class="number">95</span>, <span class="number">178</span>, <span class="number">167</span>, <span class="number">182</span>, <span class="number">102</span>, <span class="number">27</span>, <span class="number">123</span>, <span class="number">60</span>, <span class="number">129</span>, <span class="number">42</span>, <span class="number">26</span>, <span class="number">99</span>, <span class="number">39</span>, <span class="number">97</span>, <span class="number">40</span>, <span class="number">235</span>, <span class="number">205</span>, <span class="number">7</span>, <span class="number">49</span>, <span class="number">202</span>, <span class="number">197</span>, <span class="number">109</span>, <span class="number">195</span>, <span class="number">245</span>, <span class="number">171</span>, <span class="number">180</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">83</span>, <span class="number">48</span>, <span class="number">156</span>, <span class="number">92</span>, <span class="number">249</span>, <span class="number">38</span>, <span class="number">32</span>, <span class="number">203</span>, <span class="number">41</span>, <span class="number">124</span>, <span class="number">54</span>, <span class="number">217</span>, <span class="number">134</span>, <span class="number">154</span>, <span class="number">35</span>, <span class="number">157</span>, <span class="number">128</span>, <span class="number">137</span>, <span class="number">221</span>, <span class="number">84</span>, <span class="number">86</span>, <span class="number">215</span>, <span class="number">213</span>, <span class="number">80</span>, <span class="number">11</span>, <span class="number">116</span>, <span class="number">141</span>, <span class="number">241</span>, <span class="number">64</span>, <span class="number">224</span>, <span class="number">87</span>, <span class="number">77</span>, <span class="number">187</span>, <span class="number">68</span>, <span class="number">192</span>, <span class="number">151</span>, <span class="number">240</span>, <span class="number">13</span>, <span class="number">228</span>, <span class="number">231</span>, <span class="number">66</span>, <span class="number">110</span>, <span class="number">243</span>]</span><br><span class="line">a = <span class="string">b&quot;]7\xab\xc9\xd8\x90\x1f\xd2OP\xad\x87&#x27;0\xe1\xff=~&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t=s.index(<span class="built_in">ord</span>(<span class="string">&#x27;&#125;&#x27;</span>)^<span class="built_in">ord</span>(<span class="string">&#x27;~&#x27;</span>))</span><br><span class="line">i=<span class="number">18</span></span><br><span class="line">sj=(t-s[i])%<span class="number">256</span></span><br><span class="line">j=s.index(sj)</span><br><span class="line">s[i],s[j]=s[j],s[i]</span><br><span class="line">j=(j-s[i])%<span class="number">256</span></span><br><span class="line">i=i-<span class="number">1</span></span><br><span class="line">t=(s[i]+s[j])%<span class="number">256</span></span><br><span class="line">flag=<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">    flag+=(<span class="built_in">chr</span>((a[i-<span class="number">1</span>])^s[t]))</span><br><span class="line">    s[i],s[j]=s[j],s[i]</span><br><span class="line">    j=(j-s[i])%<span class="number">256</span></span><br><span class="line">    i=i-<span class="number">1</span></span><br><span class="line">    t=(s[i]+s[j])%<span class="number">256</span></span><br><span class="line"></span><br><span class="line">flag=flag[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;einfache_rc4&#125;</span></span><br></pre></td></tr></table></figure><h1 id="LCG"><a href="#LCG" class="headerlink" title="LCG"></a>LCG</h1><blockquote><p><a href="https://www.cnblogs.com/vancasola/p/9942583.html">https://www.cnblogs.com/vancasola/p/9942583.html</a></p><p><a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">https://en.wikipedia.org/wiki/Linear_congruential_generator</a></p><p><a href="https://blog.csdn.net/m0_74345946/article/details/132888135?ops_request_misc=%257B%2522request%255Fid%2522%253A%25221dd70df47b55af8763c80a26c08369d7%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=1dd70df47b55af8763c80a26c08369d7&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-132888135-null-null.142^v101^pc_search_result_base7&amp;utm_term=lcg&amp;spm=1018.2226.3001.4187">LCGå…¥é—¨-CSDNåšå®¢</a></p></blockquote><h2 id="åŠ å¯†æµç¨‹-1"><a href="#åŠ å¯†æµç¨‹-1" class="headerlink" title="åŠ å¯†æµç¨‹"></a>åŠ å¯†æµç¨‹</h2><p>LCGï¼ˆlinear congruential generatorï¼‰çº¿æ€§åŒä½™ç®—æ³•ç”±ä»¥ä¸‹å‚æ•°ç»„æˆï¼š</p><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>m</th><th>a</th><th>b</th><th>X</th></tr></thead><tbody><tr><td>æ€§è´¨</td><td>æ¨¡æ•°</td><td>ä¹˜æ•°</td><td>åŠ æ•°</td><td>éšæœºæ•°</td></tr><tr><td>ä½œç”¨</td><td>å–æ¨¡</td><td>ç§»ä½</td><td>åç§»</td><td>ä½œä¸ºç»“æœ</td></tr></tbody></table></div><p>LCGç®—æ³•æ˜¯å¦‚ä¸‹çš„ä¸€ä¸ªé€’æ¨å…¬å¼ï¼Œæ¯ä¸‹ä¸€ä¸ªéšæœºæ•°æ˜¯å½“å‰éšæœºæ•°å‘å·¦ç§»åŠ¨ $ log_2a<br> $ ä½ï¼ŒåŠ ä¸Šä¸€ä¸ª bï¼Œæœ€åå¯¹ m å–ä½™ï¼Œä½¿éšæœºæ•°é™åˆ¶åœ¨ 0 ~ m-1 å†…</p><p>$ X_{n+1}=(aX_{n}+b)\mod m $</p><p>åªè¦æˆ‘ä»¬çŸ¥é“ä¸Šé¢çš„é‡è¦å‚æ•°ï¼Œè¦æ±‚å“ªä¸ªéƒ½å¾ˆè½»æ¾ï¼Œæ‰€ä»¥è¦çŸ¥é“ä»¥ä¸‹å…¬å¼</p><p><strong>å…¬å¼1</strong>ï¼šåæ¨$ X_n $</p><p>$ X_{n}=(X_{n+1}-b)*a^{-1}\mod m $</p><p><strong>å…¬å¼2</strong>ï¼šæ±‚a</p><p>$ a=(X_{i-1}-X_{i-2})^{-1}*(X_{i}-X_{i-1})\mod p $</p><p><strong>å…¬å¼3</strong>ï¼šæ±‚b</p><p>$ b=(X_{i+1}-aX_i)\mod m $</p><p><strong>å…¬å¼4</strong>ï¼šæ±‚m</p><p>$ t_i=(X_i-X_{i-1})=a(X_{i-1}-X_{i-2})=a*t_{i-1}\mod m $</p><p>$ t_{i+1}t_{i-1}-t_it_i=a^2t_{i-1}-at_{i-1}at_{i-1}=0\mod m $</p><p>ä¸Šé¢è¿™ä¸ªå¼å­å°±è¯´æ˜äº† $ t_{i+1}*t_{i-1}-t_i*t_i $ æ˜¯pçš„å€æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ”¹å˜iï¼Œå¾—åˆ°ä¸¤ä¸ªå€¼ï¼Œæ±‚ä¸€ä¸‹å…¬å› å­ï¼Œå°±å¯ä»¥æ±‚å‡ºæ¥m</p><h2 id="ä¾‹é¢˜-1"><a href="#ä¾‹é¢˜-1" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="babyLCG"><a href="#babyLCG" class="headerlink" title="babyLCG"></a>babyLCG</h3><p><strong>é¢˜ç›®</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">bit_len = m.bit_length()</span><br><span class="line">a = getPrime(bit_len)</span><br><span class="line">b = getPrime(bit_len)</span><br><span class="line">p = getPrime(bit_len+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">seed = m</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%p</span><br><span class="line">    result.append(seed)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">result = [34162247026397342478798569901414759621400, 48622925600981805953284319521855204943516, 873946493924376814098626588792484831751, 55835889122403142019357216062663278735799, 78197983655527534886328482392841803329879, 7826910556079551454813328357787595898220, 48420932174201345880210110234297855524418, 41702494213414751668850237022097487126943, 53964978232593731384060231097661907644428, 41614447441497057710125709202129649216700]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šLCG</p><p>åªè¦çŸ¥é“å…³äºLCGçš„ä¸‰ä¸ªåŸºç¡€å…¬å¼ï¼Œè¿™é“é¢˜å°±å¾ˆç®€å•ï¼Œå»ºè®®è‡ªå·±æ¨å¯¼ä¸€é</p><p>$ seed_i=ï¼ˆa*seed_{i-1}+bï¼‰\mod p $</p><p>è®¾$ t_i=(seed_i-seed_{i-1})=a(seed_{i-1}-seed_{i-2})=a*t_{i-1}\mod p $</p><p>$ t_{i+1}*t_{i-1}-t_i*t_i=a^2t_{i-1}-a*t_{i-1}*a*t_{i-1}=0\mod p $</p><p>ä¸Šé¢è¿™ä¸ªå¼å­å°±è¯´æ˜äº† $ t_{i+1}*t_{i-1}-t_i*t_i $ æ˜¯pçš„å€æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ”¹å˜iï¼Œå¾—åˆ°ä¸¤ä¸ªå€¼ï¼Œæ±‚ä¸€ä¸‹å…¬å› å­ï¼Œå°±å¯ä»¥æ±‚å‡ºæ¥pï¼Œpæœ‰äº†aä¹Ÿå¾ˆå¥½æ±‚</p><p>$ a=(seed_{i-1}-seed_{i-2})^{-1}*t_i\mod p $</p><p>aæœ‰äº†éšä¾¿å¥—ä¸€ä¸ªå¼å­å°±å¯ä»¥æ±‚bäº†ï¼Œè¿™æ ·LCGçš„ä¸‰ä¸ªé‡è¦å‚æ•°å°±éƒ½æœ‰äº†ï¼Œç¬¬ä¸€ä¸ªå€¼é€†å›å»å°±å¯ä»¥æ±‚å‡ºæ˜æ–‡äº†</p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">result = [<span class="number">34162247026397342478798569901414759621400</span>, <span class="number">48622925600981805953284319521855204943516</span>, <span class="number">873946493924376814098626588792484831751</span>, <span class="number">55835889122403142019357216062663278735799</span>, <span class="number">78197983655527534886328482392841803329879</span>, <span class="number">7826910556079551454813328357787595898220</span>, <span class="number">48420932174201345880210110234297855524418</span>, <span class="number">41702494213414751668850237022097487126943</span>, <span class="number">53964978232593731384060231097661907644428</span>, <span class="number">41614447441497057710125709202129649216700</span>]</span><br><span class="line">t1=result[<span class="number">1</span>]-result[<span class="number">0</span>]</span><br><span class="line">t2=result[<span class="number">2</span>]-result[<span class="number">1</span>]</span><br><span class="line">t3=result[<span class="number">3</span>]-result[<span class="number">2</span>]</span><br><span class="line">t4=result[<span class="number">4</span>]-result[<span class="number">3</span>]</span><br><span class="line">t5=result[<span class="number">5</span>]-result[<span class="number">4</span>]</span><br><span class="line">t6=result[<span class="number">6</span>]-result[<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">p = gcd((t6*t4-t5*t5),(t5*t3-t4*t4))</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">a=(t3*gmpy2.invert(t2,p))%p</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b=(result[<span class="number">1</span>]-a*result[<span class="number">0</span>])%p</span><br><span class="line">m = ((result[<span class="number">0</span>]-b)*gmpy2.invert(a,p))%p</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;gratulieren&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> å¯¹ç§°å¯†ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¤­åœ†æ›²çº¿</title>
      <link href="/2024/11/24/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/"/>
      <url>/2024/11/24/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¤­åœ†æ›²çº¿"><a href="#æ¤­åœ†æ›²çº¿" class="headerlink" title="æ¤­åœ†æ›²çº¿"></a>æ¤­åœ†æ›²çº¿</h1><p>ä¸‹é¢è¿›è¡Œæ¤­åœ†æ›²çº¿ç›¸å…³çŸ¥è¯†çš„å­¦ä¹ ï¼ˆåŸºäºcrypto hackï¼‰ï¼Œä¸­é—´ç©¿æ’äº†ä¸€äº›æ•°è®ºå’Œè¿‘ä¸–ä»£æ•°çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ã€‚</p><h2 id="ä¸€-é¢„å¤‡çŸ¥è¯†"><a href="#ä¸€-é¢„å¤‡çŸ¥è¯†" class="headerlink" title="ä¸€. é¢„å¤‡çŸ¥è¯†"></a>ä¸€. é¢„å¤‡çŸ¥è¯†</h2><p>å­¦ä¹ çš„æ—¶å€™ç¢°åˆ°äº†æ•°è®ºå’Œè¿‘ä¸–ä»£æ•°çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼Œå› ä¸ºè¿™ä¸¤é—¨æˆ‘éƒ½æ²¡å­¦å®Œï¼ˆå°¤å…¶è¿‘ä¸–ä»£æ•°ï¼Œå®Œå…¨æ²¡å¼€å§‹çœ‹ï¼‰ï¼Œæ‰€æœ‰åªèƒ½æ±‚å°½é‡è®²æ¸…æ¥šå§ã€‚</p><h3 id="ç¾¤"><a href="#ç¾¤" class="headerlink" title="ç¾¤"></a>ç¾¤</h3><p>è¿‘ä¸–ä»£æ•°æ˜¯ä¸»è¦ç ”ç©¶ä»£æ•°ç³»ç»Ÿï¼ˆå³éç©ºé›†åˆï¼‰çš„å­¦ç§‘ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªéç©ºé›†åˆä¸Šå®šä¹‰æ»¡è¶³ä¸€å®šæ¡ä»¶çš„ä¸€ç§æˆ–å¤šç§äºŒå…ƒè¿ç®—ï¼ˆä»£æ•°è¿ç®—ï¼‰ã€‚ç¾¤æ˜¯è¿‘ä¸–ä»£æ•°é‡Œé¢ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µã€‚ä¸‹é¢æ”¾ä¸€ä¸ªè¯¾æœ¬ä¸Šçš„å®šä¹‰ã€‚</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1731940824047-20ebce66-31a9-433b-8dd2-0b15645a016f.jpeg" alt=""></p><p>ç®€å•è§£é‡Šä¸€ä¸‹å°±æ˜¯åœ¨ä¸€ä¸ªéç©ºé›†åˆé‡Œå®šä¹‰ä¸€ä¸ªäºŒå…ƒè¿ç®—ï¼Œè¿™ä¸ªè¿ç®—å¯¹äºè¿™ä¸ªé›†åˆå†…çš„å…ƒç´ éƒ½æ»¡è¶³</p><p>(1)<strong>ç»“åˆç‡</strong>        (2)<strong>å•ä½å…ƒ</strong>    (3)<strong>é€†å…ƒ</strong></p><p>å…¶å®è¿˜æœ‰ä¸€ä¸ª<strong>å°é—­æ€§</strong>ï¼Œå°±æ˜¯è¿ç®—ç»“æœè¿˜æ˜¯åœ¨è¿™ä¸ªé›†åˆé‡Œã€‚</p><p><strong>ä¸¾ä¸€ä¸ªä¾‹å­</strong>ï¼Œå¯¹äºæ‰€æœ‰éé›¶æœ‰ç†æ•°ï¼ˆéç©ºé›†åˆï¼‰ï¼Œå’Œæ™®é€šä¹˜æ³•ï¼ˆäºŒå…ƒè¿ç®—ï¼‰æ„æˆäº†ä¸€ä¸ªç¾¤ï¼Œè¿™ä¸ªç¾¤æ»¡è¶³ç»“åˆå¾‹ï¼ˆæ˜¯æ˜¾ç„¶çš„ï¼‰ï¼Œæœ‰å•ä½å…ƒ1ï¼ˆä»»æ„æ•°ä¸1åšè¿™ä¸ªäºŒå…ƒè¿ç®—éƒ½ç­‰äºå®ƒæœ¬èº«ï¼Œä¸”äº¤æ¢ä¹Ÿæ»¡è¶³ï¼‰ï¼Œä¸”å¯¹äºä»»æ„ä¸€ä¸ªaï¼Œéƒ½æœ‰$ \frac{1}{a} $ä¸aåšè¿™ä¸ªäºŒå…ƒè¿ç®—åç­‰äºå•ä½å…ƒ1ï¼ˆäº¤æ¢ä¹Ÿæ»¡è¶³)</p><h3 id="é˜¿è´å°”ç¾¤ï¼ˆAbel-ç¾¤ï¼‰"><a href="#é˜¿è´å°”ç¾¤ï¼ˆAbel-ç¾¤ï¼‰" class="headerlink" title="é˜¿è´å°”ç¾¤ï¼ˆAbel ç¾¤ï¼‰"></a>é˜¿è´å°”ç¾¤ï¼ˆAbel ç¾¤ï¼‰</h3><p>é˜¿è´å°”ç¾¤æ˜¯åœ¨ç¾¤çš„åŸºç¡€ä¸ŠåŠ ä¸Šä¸€ä¸ªæ¡ä»¶å¾—åˆ°çš„ï¼Œå³<strong>äº¤æ¢ç‡</strong></p><p>æ™®é€šçš„ç¾¤æ»¡è¶³ç»“åˆç‡ï¼Œä½†æ˜¯æ˜¯ä¸ä¸€å®šæ»¡è¶³äº¤æ¢ç‡çš„ï¼ˆç›®å‰æˆ‘ä¸¾ä¸å‡ºå…·ä½“ä¾‹å­ï¼Œä½†æ˜¯æˆ‘æ˜¯è”æƒ³çŸ©é˜µè¿ç®—å»ç†è§£çš„ï¼Œä¸è¿‡å¯èƒ½ä¸å‡†ç¡®ï¼Œæ„Ÿå…´è¶£å¯ä»¥å»æŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰å…·ä½“ä¾‹å­ï¼‰</p><p>æ‰€ä»¥ä¸€æ—¦ä¸€ä¸ªç¾¤æ»¡è¶³<strong>äº¤æ¢å¾‹</strong>ï¼Œè¿™ä¸ªç¾¤å°±æ˜¯<strong>é˜¿è´å°”ç¾¤</strong>ï¼Œä¹Ÿå«<strong>äº¤æ¢ç¾¤</strong></p><p>äº¤æ¢ç¾¤çš„æ¦‚å¿µåœ¨åé¢æ¤­åœ†æ›²çº¿çš„è¿ç®—ä¸Šä¼šæœ‰æ¯”è¾ƒé‡è¦çš„è¿ç”¨ã€‚ä¸€æ—¦æ»¡è¶³ç»“åˆå¾‹å’Œäº¤æ¢å¾‹ï¼Œé‚£ä¹ˆè¿ç®—æ—¶çš„æ¬¡åºå°±æ²¡é‚£ä¹ˆé‡è¦äº†ï¼Œè¿™æ˜¯<strong>åŸºäºæ¤­åœ†æ›²çº¿çš„DHå¯†é’¥äº¤æ¢</strong>çš„ä¸€ä¸ªé‡è¦åŸºç¡€ã€‚</p><h3 id="äºŒæ¬¡å‰©ä½™"><a href="#äºŒæ¬¡å‰©ä½™" class="headerlink" title="äºŒæ¬¡å‰©ä½™"></a>äºŒæ¬¡å‰©ä½™</h3><blockquote><p><a href="https://oi-wiki.org/math/number-theory/quad-residue/">https://oi-wiki.org/math/number-theory/quad-residue/</a></p></blockquote><p>æ˜¯æ•°è®ºé‡Œé¢è§£åŒä½™æ–¹ç¨‹é‚£é‡Œçš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å®šä¹‰ï¼š</p><p>ä»¤æ•´æ•°aï¼Œpæ»¡è¶³ï¼ˆaï¼Œpï¼‰= 1ï¼Œè‹¥å­˜åœ¨xä½¿å¾—</p><p>$ x^{2} \equiv a\mod p $</p><p>åˆ™ç§°aä¸ºæ¨¡pçš„äºŒæ¬¡å‰©ä½™ï¼Œå¦åˆ™ç§°aä¸ºæ¨¡pçš„äºŒæ¬¡éå‰©ä½™</p><p>è¿™é‡Œé¢è¿˜æ˜¯æœ‰æŒºå¤šæ¦‚å¿µçš„ä¸œè¥¿çš„ï¼Œä½†æ˜¯ä¸Šé¢åšå®¢é‡Œé¢è®²çš„ååˆ†è¯¦ç»†ï¼Œå¯ä»¥çœ‹ä¸€çœ‹</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘åªå¼ºè°ƒä¸€ä¸ªç‰¹æ®Šæƒ…å†µä¸‹çš„æ±‚è§£ï¼Œå³$ p \equiv 3\mod 4 $</p><p>æ»¡è¶³ä¸Šé¢æ‰€è¯´æƒ…å†µï¼Œä¸”æˆ‘ä»¬çŸ¥é“aæ˜¯pçš„äºŒæ¬¡å‰©ä½™ï¼ˆæ€ä¹ˆéªŒè¯æ˜¯ä¸æ˜¯äºŒæ¬¡å‰©ä½™å¯ä»¥çœ‹çœ‹é‚£ä¸ªç½‘ç«™é‡Œï¼Œè®²çš„å¾ˆè¯¦ç»†ï¼Œæ•°è®ºæˆ‘æ²¡å­¦å®Œï¼Œæ€•è®²ä¸æ¸…æ¥šï¼‰ï¼Œå°±å¯ä»¥ç”¨ä¸‹å›¾æ–¹æ³•æ¥æ±‚ä¸€ä¸ªè§£ï¼ˆå¯ä»¥æ±‚å‡ºxçš„å€¼ï¼‰</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732103648533-7e560906-4c9c-464a-a188-22d21af569ef.jpeg" alt=""></p><p>æˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹ï¼ˆè‡ªå·±æ¨äº†ä¸€ä¸‹ï¼Œå­—æœ‰ç‚¹ä¸‘ï¼Œæµæ³ªçŒ«çŒ«ï¼‰</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732104617404-6926d99e-b246-4eb0-af0d-9ce5036d251e.jpeg" alt=""></p><p>è¿™é‡Œå› ä¸ºp+1æ˜¯4çš„å€æ•°ï¼ŒæŒ‡æ•°éƒ¨åˆ†å°±æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥ä¼šå¾ˆå¥½ç®—ã€‚å¤§å®¶ä¹Ÿå¯ä»¥è¯•è¯•è‡ªå·±æ¨ä¸€ä¸‹åŠ æ·±ç†è§£</p><p>è‡³äºå…¶ä»–çš„æƒ…å†µæˆ‘è¿˜æ²¡å­¦å®Œï¼ˆæµæ³ªçŒ«çŒ«å¤´ï¼‰ï¼Œæ‹œæ‰˜ï¼Œæ•°è®ºå¤ªéš¾äº†ï¼Œä½†æ˜¯é‚£ä¸ªç½‘ç«™é‡Œé¢çœŸçš„å¾ˆè¯¦ç»†ï¼å¯ä»¥ä»”ç»†ç ”è¯»</p><h2 id="äºŒ-æ¤­åœ†æ›²çº¿å…¥é—¨"><a href="#äºŒ-æ¤­åœ†æ›²çº¿å…¥é—¨" class="headerlink" title="äºŒ. æ¤­åœ†æ›²çº¿å…¥é—¨"></a>äºŒ. æ¤­åœ†æ›²çº¿å…¥é—¨</h2><blockquote><p><a href="https://www.cnblogs.com/Kalafinaian/p/7392505.html">https://www.cnblogs.com/Kalafinaian/p/7392505.html</a></p></blockquote><p>è¦ç ”ç©¶æ¤­åœ†æ›²çº¿å°±è¦çŸ¥é“ç»´å°”ç‰¹æ‹‰æ–¯æ–¹ç¨‹ï¼ˆWeierstrassï¼‰ï¼Œè¿™ä¸ªæ–¹ç¨‹çš„å½¢å¼æŒºå¤æ‚çš„ï¼Œæ„Ÿå…´è¶£å¯ä»¥å»æŸ¥ä¸€ä¸‹ï¼Œç„¶åæˆ‘ä»¬ä¸»è¦è¿ç”¨å®ƒçš„æ™®é€šå½¢å¼ï¼Œå³</p><p>$ y^{2} = x^{3} +ax +b $</p><p>å¤§è‡´å›¾åƒå¦‚ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732106124295-85739cb9-d47b-46fa-ad13-8b30984d7734.jpeg" alt=""></p><p>åƒä»€ä¹ˆæ›²çº¿æ¯ä¸ªç‚¹æ˜¯éå¥‡å¼‚çš„ï¼ˆå…‰æ»‘çš„ï¼‰è¿™æ ·çš„æ€§è´¨æˆ‘å°±ä¸å¼ºè°ƒäº†ï¼Œè¿™é‡Œå…ˆçŸ¥é“é•¿ä»€ä¹ˆæ ·å°±è¡Œ</p><h3 id="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•"><a href="#æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•" class="headerlink" title="æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•"></a>æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•</h3><p>æˆ‘ä»¬çŸ¥é“æ¤­åœ†æ›²çº¿é•¿ä»€ä¹ˆæ ·å­åï¼Œå°±ä¼šæœŸæœ›åœ¨ä¸Šé¢åšä¸€äº›è¿ç®—ï¼Œè€Œå®ƒç¡®å®ä¹Ÿæä¾›äº†ç‚¹åŠ æ³•è¿ç®—ã€‚å…¶åŸç†æ˜¯</p><p>å‡è®¾A=ï¼ˆx1ï¼Œy1ï¼‰B=ï¼ˆx2ï¼Œy2ï¼‰æ˜¯æ›²çº¿ä¸Šçš„ä¸¤ä¸ªç‚¹</p><p>é‚£ä¹ˆP + Qçš„ç»“æœï¼Œå°±æ˜¯<strong>PQè¿çº¿</strong>ä¸æ¤­åœ†æ›²çº¿çš„äº¤ç‚¹<strong>R</strong>â€˜å…³äºxè½´çš„<strong>å¯¹ç§°ç‚¹R</strong>ï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732106828572-99020cec-0105-4fc8-8f25-61689f557c4c.jpeg" alt=""></p><p>å€˜è‹¥æ˜¯A + Aï¼Œåˆ™æˆ‘ä»¬è€ƒè™‘<strong>Aç‚¹çš„åˆ‡çº¿</strong>ï¼Œåˆ‡çº¿ä¸æ¤­åœ†æ›²çº¿çš„äº¤ç‚¹Râ€™å…³äºxè½´çš„<strong>å¯¹ç§°ç‚¹R</strong>å³ä¸ºç»“æœï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732106983277-08aef9d8-3a9a-4f68-85ba-5fca4c0f413f.jpeg" alt=""></p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„è®¡ç®—æ–¹æ³•</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1732110476331-aeff5e4d-b778-4574-bc3e-4796656c3024.png" alt=""></p><h3 id="å•ä½å…ƒå’Œé€†å…ƒ"><a href="#å•ä½å…ƒå’Œé€†å…ƒ" class="headerlink" title="å•ä½å…ƒå’Œé€†å…ƒ"></a>å•ä½å…ƒå’Œé€†å…ƒ</h3><p>æˆ‘ä»¬çŸ¥é“äº†æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•è¿ç®—åï¼Œæˆ‘ä»¬ä¼šæœŸæœ›å®ƒå…·å¤‡ç¾¤å±æ€§ï¼Œä»¥ä¾¿äºæˆ‘ä»¬ç ”ç©¶ï¼Œè¿™å°±è¦æ‰¾åˆ°ä¸€ä¸ªå•ä½å…ƒOï¼Œä½¿å¾—</p><p>$ P +O=P $</p><p>ä½†æˆ‘ä»¬ä¼šå‘ç°æ²¡æœ‰ä¸€ä¸ªç‚¹æ˜¯æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è§„å®šä¸€ä¸ªæ— ç©·è¿œå¤„çš„æŠ½è±¡ç‚¹ä¸ºå•ä½å…ƒOï¼ˆå¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªç‚¹å’Œæ— ç©·è¿œå¤„ç‚¹çš„è¿çº¿ä¸æ›²çº¿çš„äº¤ç‚¹è¿˜æ˜¯è¿™ä¸ªç‚¹ï¼Œæ»¡è¶³æ¡ä»¶ï¼‰ã€‚è¿™ä¸ªæ— ç©·è¿œç‚¹å¯ä»¥çœ‹æˆåœ¨yè½´çš„æ­£ï¼ˆè´Ÿï¼‰åŠè½´çš„æ— ç©·è¿œå¤„ã€‚è¿™å°±æœ‰äº†å•ä½å…ƒäº†ã€‚</p><p>æœ‰äº†å•ä½å…ƒåæˆ‘ä»¬æ¥æ‰¾é€†å…ƒï¼Œå³å­˜åœ¨-Pä½¿å¾—</p><p>$ P +ï¼ˆ-Pï¼‰=O $</p><p>å…¶å®å›é¡¾ä¸€ä¸‹ç‚¹åŠ æ³•çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°é€†å…ƒå°±æ˜¯å…³äºxè½´å¯¹ç§°çš„é‚£ä¸ªç‚¹</p><p>ä¾‹å¦‚R=ï¼ˆx3ï¼Œy3ï¼‰é‚£ä¹ˆé€†å…ƒRâ€™=ï¼ˆx3ï¼Œ-y3ï¼‰</p><p>ä¹Ÿå¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œè¿™ä¸¤ä¸ªç‚¹çš„è¿çº¿å°±æ˜¯äº¤åœ¨æ— ç©·è¿œå¤„ï¼Œæ»¡è¶³å®šä¹‰ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹åŠ æ³•æ»¡è¶³äº†ç¾¤çš„æ‰€ä»¥æ€§è´¨ï¼Œæ‰€ä»¥æ»¡è¶³æ¤­åœ†æ›²çº¿çš„æ‰€æœ‰ç‚¹åŠ ä¸Šä¸€ä¸ªæ— ç©·å¤§çš„è™šæ•°ç‚¹Oï¼Œå°±æ„æˆäº†ä¸€ä¸ªç¾¤ã€‚å®é™…æ˜¯ï¼Œè¿™ä¸ªç¾¤ä¹Ÿæ˜¯æ»¡è¶³äº¤æ¢ç‡çš„ï¼Œè€Œæ»¡è¶³äº¤æ¢ç‡çš„ç¾¤æˆ‘ä»¬ç§°ä¹‹ä¸ºé˜¿è´å°”ç¾¤ã€‚</p><p>ç„¶åæˆ‘ä»¬çœŸæ­£ç ”ç©¶çš„æ—¶å€™ï¼Œå…¶å®ä¼šå¸Œæœ›åœ¨ä¸€ä¸ªæœ‰é™åŸŸå†…å»ç ”ç©¶ï¼Œç‰¹åˆ«æ˜¯ç´ æ•°åŸŸï¼Œæ‰€æœ‰æˆ‘ä»¬å¯¹æ–¹ç¨‹å–æ¨¡ï¼Œè¿™æ ·ä»¥åï¼Œæˆ‘ä»¬ç ”ç©¶çš„å°±æ˜¯ä¸€äº›å¯¹ç§°çš„ç‚¹ï¼Œè€Œä¸æ˜¯è¿ç»­çš„çº¿</p><p>å–æ¨¡åé€†å…ƒé‚£é‡Œå°±æœ‰ç‚¹å°åŒºåˆ«å› ä¸º-y = p - y mod pï¼Œæ‰€ä»¥åœ¨æœ‰é™åŸŸä¸Šçš„é€†å…ƒè¡¨ç¤ºæˆ Râ€™ï¼ˆxï¼Œp - yï¼‰</p><h3 id="æ¤­åœ†æ›²çº¿æ„å»ºç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰"><a href="#æ¤­åœ†æ›²çº¿æ„å»ºç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰" class="headerlink" title="æ¤­åœ†æ›²çº¿æ„å»ºç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰"></a>æ¤­åœ†æ›²çº¿æ„å»ºç¦»æ•£å¯¹æ•°é—®é¢˜ï¼ˆECDLPï¼‰</h3><p>å¯¹äºä¸€ä¸ªç»™å®šçš„æ¤­åœ†æ›²çº¿Eï¼Œè€ƒè™‘æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸¤ä¸ªå…ƒç´ På’ŒTï¼ŒDLé—®é¢˜å°±æ˜¯æ‰¾åˆ°æ•´æ•°dï¼Œä½¿å¾—</p><p>$ P+P+\dots+P =dP=T $</p><p>å¾ˆå¤šæ—¶å€™ï¼Œè¿™ä¸ªdå°±æ˜¯ç§é’¥ï¼ˆå¦‚åœ¨ECCåŠ å¯†ä½“ç³»é‡Œï¼‰</p><p>ï¼ˆd*På°±æ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„æ ‡é‡ä¹˜æ³•ï¼Œä¸è¿‡ç†è§£ä¸Šè¿˜æ˜¯è¦å½“æˆç‚¹åŠ æ³•çš„é‡å¤è¿›è¡Œï¼‰</p><p>å¾ˆå¤šæ—¶å€™ï¼ŒçŸ¥é“Tæ¥æ±‚dæ˜¯ååˆ†å›°éš¾çš„ï¼Œç›¸å½“äºä¸€ä¸ªç¦»æ•£å¯¹æ•°é—®é¢˜ã€‚è¿™ç¡®ä¿äº†æ¤­åœ†æ›²çº¿åŠ å¯†çš„å®‰å…¨æ€§ã€‚</p><h3 id="åŸºäºæ¤­åœ†æ›²çº¿çš„DHå¯†é’¥äº¤æ¢"><a href="#åŸºäºæ¤­åœ†æ›²çº¿çš„DHå¯†é’¥äº¤æ¢" class="headerlink" title="åŸºäºæ¤­åœ†æ›²çº¿çš„DHå¯†é’¥äº¤æ¢"></a>åŸºäºæ¤­åœ†æ›²çº¿çš„DHå¯†é’¥äº¤æ¢</h3><p>çŸ¥é“äº†æ¤­åœ†æ›²çº¿ï¼Œæˆ‘ä»¬è¦ç”¨æ¥åšä¸€äº›å’Œå¯†ç æœ‰å…³çš„äº‹æƒ…</p><p>äºæ˜¯Aliceå’ŒBobåå•†åšä¸‹é¢è¿™äº›äº‹</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732114355132-c04e044e-3946-4877-8a2a-275ef34626ed.jpeg" alt=""></p><p>ä¸¤ä¸ªäººå¹¶ç”¨åˆ†åˆ«ç”¨è‡ªå·±éšæœºç”Ÿæˆçš„æ•´æ•°aå’Œbä¸Pï¼ˆå…¬å¼€ï¼‰åšæ ‡é‡ä¹˜æ³•å¾—åˆ°Aï¼ˆå…¬å¼€ï¼‰å’ŒBï¼ˆå…¬å¼€ï¼‰ï¼Œå¹¶æŠŠå¾—åˆ°çš„å€¼åˆ†åˆ«ä¼ ç»™å¯¹æ–¹ã€‚</p><p>Aliceå¾—åˆ°Bå¹¶ç”¨è‡ªå·±ä¸€å¼€å§‹çš„é‚£ä¸ªéšæœºæ•°aä¸Båšæ ‡é‡ä¹˜æ³•ï¼Œå¾—åˆ°Tï¼ŒBobåŒç†ã€‚ä¸¤äººæŠŠå¾—åˆ°çš„Tä½œä¸ºå…±äº«å¯†é’¥ã€‚</p><p>å¯¹äºAliceï¼šT = a <em> ï¼ˆb </em> Pï¼‰</p><p>å¯¹äºBobï¼š  T =  b <em>ï¼ˆa </em> Pï¼‰</p><p>å› ä¸ºæ¤­åœ†æ›²çº¿æ˜¯ä¸€ä¸ªé˜¿è´å°”ç¾¤ï¼Œæ‰€ä»¥è¿ç®—æ¬¡åºå¯¹ç»“æœä¸å½±å“ï¼Œæ‰€ä»¥ä¸¤ä¸ªäººå¾—åˆ°çš„Tç›¸åŒï¼Œè¿™ç¡®ä¿äº†äº¤æ¢çš„å¯è¡Œæ€§</p><p>è¿™ä¸ªè¿‡ç¨‹é‡Œé¢ï¼Œå¤–äººåªå¯èƒ½å¾—åˆ°Pã€Aå’ŒBï¼ˆè¿™ä¸‰ä¸ªæ˜¯å…¬å¼€çš„ï¼‰ï¼Œä½†æ˜¯ä»…ä»…é€šè¿‡è¿™ä¸‰ä¸ªæ˜¯ç®—ä¸å‡ºaå’Œbçš„ï¼ˆå³ç®—ä¸å‡ºTï¼‰ï¼Œè¿™ç¡®ä¿äº†è¿™ä¸ªäº¤æ¢è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚</p><p>è¿™æ ·Aliceå’ŒBobå°±å¯ä»¥ç”¨è¿™ä¸ªè”åˆå¯†é’¥å»åŠ å¯†ä¸€äº›ä¸œè¥¿</p><p>ä¹‹åAliceå’ŒBobè¿›è¡Œäº†æ€è€ƒï¼Œä»–ä»¬è®¤ä¸ºï¼Œæ—¢ç„¶æ¤­åœ†æ›²çº¿æ–¹ç¨‹å·²çŸ¥ï¼Œé‚£å¹²å˜›è¿˜è¦ä¼ é€’yå‘€ï¼Ÿï¼ˆæ¬¸ï¼æˆ‘æœ‰ä¸€ä¸ªå¥½ä¸»æ„ï¼‰äºæ˜¯ä»–ä»¬è§‰å¾—åªä¼ é€’xå°±å¯ä»¥äº†ï¼Œä»¥å®ç°é«˜æ•ˆä¼ é€’</p><p>äº‹å®ä¸Šåªä¼ é€’xä¹Ÿç¡®å®æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬è€ƒè™‘æŠŠå·²çŸ¥çš„xå€¼ä»£å…¥æ›²çº¿æ–¹ç¨‹å°±å¯ä»¥å¾—åˆ°    y<sup>2</sup> = k mod p    çš„å½¢å¼</p><p>å…¶ä¸­kæ˜¯å¸¦å…¥xåçš„ç®—å‡ºå€¼ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªäºŒæ¬¡å‰©ä½™é—®é¢˜ï¼ˆæ•°è®ºçš„çŸ¥è¯†ç‚¹ï¼‰ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•è§£å†³çš„é—®é¢˜ï¼ˆè¯¾æœ¬ä¸Šè¿™ä¹ˆè¯´çš„ï¼Œè™½ç„¶åœ¨æˆ‘çœ‹æ¥è¿˜æ˜¯å¾ˆéš¾ï¼‰ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥æ±‚å‡ºyã€‚</p><p>ä½†è¿™é‡Œä¼šæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æœæ•°å¯¹ï¼ˆxï¼Œyï¼‰æ»¡è¶³ä¸Šé¢é‚£ä¸ªå¼å­ï¼Œé‚£ä¹ˆæ˜¾ç„¶çš„ï¼ˆxï¼Œp - yï¼‰ä¹Ÿæ˜¯æ»¡è¶³çš„ï¼Œæ‰€ä»¥å®é™…ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¼ é€’xåæ ‡æ—¶ï¼Œä¼šé™„å¸¦ä¼ é€’ä¸€ä¸ªæŒ‡å®šyçš„å¥‡å¶æ€§çš„æ ‡å¿—ä½ï¼Œä»¥æ­¤æ¥è¾¾åˆ°åŒºåˆ†åˆ°åº•æ˜¯å“ªä¸ªç‚¹ï¼ˆæ„Ÿå…´è¶£å¯ä»¥æŸ¥ä¸€ä¸‹ï¼ŒæŒºå¤æ‚çš„ï¼Œæ²¡çœ‹æ‡‚ï¼‰</p><h2 id="ä¸‰-é¢˜ç›®"><a href="#ä¸‰-é¢˜ç›®" class="headerlink" title="ä¸‰. é¢˜ç›®"></a>ä¸‰. é¢˜ç›®</h2><h3 id="Efficient-Exchange"><a href="#Efficient-Exchange" class="headerlink" title="Efficient Exchange"></a>Efficient Exchange</h3><p><strong>é¢˜ç›®</strong>ï¼š</p><p><code>E: Y2=X3 +497X+1768 mod 9739</code></p><p><code>Calculate the shared secret after Alice sends you x(QA)=4726, with your secret integer nB=6534.</code></p><p><code>Use the file to decode the flag decrypt.py</code></p><p><code>&#123;&#39;iv&#39;: &#39;cd9da9f1c60925922377ea952afc212c&#39;, &#39;encrypted_flag&#39;: &#39;febcbe3a3414a730b125931dccf912d2239f3e969c4334d95ed0ec86f6449ad8&#39;&#125;</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_pkcs7_padded</span>(<span class="params">message</span>):</span><br><span class="line">    padding = message[-message[-<span class="number">1</span>]:]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(padding[i] == <span class="built_in">len</span>(padding) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(padding)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">shared_secret: <span class="built_in">int</span>, iv: <span class="built_in">str</span>, ciphertext: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="comment"># Derive AES key from shared secret</span></span><br><span class="line">    sha1 = hashlib.sha1()</span><br><span class="line">    sha1.update(<span class="built_in">str</span>(shared_secret).encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    key = sha1.digest()[:<span class="number">16</span>]</span><br><span class="line">    <span class="comment"># Decrypt flag</span></span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext)</span><br><span class="line">    iv = <span class="built_in">bytes</span>.fromhex(iv)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_pkcs7_padded(plaintext):</span><br><span class="line">        <span class="keyword">return</span> unpad(plaintext, <span class="number">16</span>).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> plaintext.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shared_secret = ?</span><br><span class="line">iv = ?</span><br><span class="line">ciphertext = ?</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypt_flag(shared_secret, iv, ciphertext))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è€ƒç‚¹</strong>ï¼šäºŒæ¬¡å‰©ä½™ï¼ŒAESè§£å¯†ï¼ŒECDHçš„é«˜æ•ˆä¼ é€’</p><p>è¿™é‡Œä¸»è¦è€ƒå¯Ÿå¯¹ECDHçš„é«˜æ•ˆä¼ é€’çš„ç†è§£ï¼ŒAliceå’ŒBobè®¤ä¸ºï¼Œæ¤­åœ†æ›²çº¿æ–¹ç¨‹å·²çŸ¥ï¼Œé‚£å¹²å˜›è¿˜è¦ä¼ é€’yå‘€ï¼Ÿï¼ˆæ¬¸ï¼æˆ‘æœ‰ä¸€ä¸ªå¥½ä¸»æ„ï¼‰äºæ˜¯ä»–ä»¬è§‰å¾—åªä¼ é€’xå°±å¯ä»¥äº†ã€‚äºæ˜¯Aliceç»™æˆ‘å‘äº†ä¸€ä¸ªxå€¼ï¼Œå¸Œæœ›æˆ‘èƒ½å¤Ÿä»¥æ­¤çŸ¥é“å…±äº«å¯†é’¥ã€‚å¹¶ä¸”Aliceç”¨å…±äº«å¯†é’¥é€šè¿‡AESåŠ å¯†äº†flag</p><p>äº‹å®ä¸Šåªä¼ é€’xä¹Ÿç¡®å®æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬è€ƒè™‘æŠŠå·²çŸ¥çš„xå€¼ä»£å…¥æ›²çº¿æ–¹ç¨‹å°±å¯ä»¥å¾—åˆ°    y2 = k mod p    çš„å½¢å¼</p><p>å…¶ä¸­kæ˜¯å¸¦å…¥xåçš„ç®—å‡ºå€¼ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªäºŒæ¬¡å‰©ä½™é—®é¢˜ï¼ˆæ•°è®ºçš„çŸ¥è¯†ç‚¹ï¼‰ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•è§£å†³çš„é—®é¢˜ï¼ˆè¯¾æœ¬ä¸Šè¿™ä¹ˆè¯´çš„ï¼Œè™½ç„¶åœ¨æˆ‘çœ‹æ¥è¿˜æ˜¯å¾ˆéš¾ï¼‰ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥æ±‚å‡ºy</p><p>ä½†è¿™é‡Œä¼šæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æœæ•°å¯¹ï¼ˆxï¼Œyï¼‰æ»¡è¶³ä¸Šé¢é‚£ä¸ªå¼å­ï¼Œé‚£ä¹ˆæ˜¾ç„¶çš„ï¼ˆxï¼Œp - yï¼‰ä¹Ÿæ˜¯æ»¡è¶³çš„ï¼Œæ‰€ä»¥å®é™…ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¼ é€’xåæ ‡æ—¶ï¼Œä¼šé™„å¸¦ä¼ é€’ä¸€ä¸ªæŒ‡å®šyçš„å¥‡å¶æ€§çš„æ ‡å¿—ä½ï¼Œä»¥æ­¤æ¥è¾¾åˆ°åŒºåˆ†åˆ°åº•æ˜¯å“ªä¸ªç‚¹ï¼ˆæ„Ÿå…´è¶£å¯ä»¥æŸ¥ä¸€ä¸‹ï¼ŒæŒºå¤æ‚çš„ï¼Œæ²¡çœ‹æ‡‚ï¼‰</p><p>ä¸è¿‡è¿™é“é¢˜ä¼šç›¸å¯¹ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ååªç”¨xæ¥åšæ–‡ç« ï¼Œæ‰€ä»¥yçš„å€¼æˆ‘ä»¬ä¸å…³å¿ƒï¼Œé‚£ä¹ˆå¯¹äºåŒä¸€ä¸ªxï¼Œå³ä½¿ä¸¤ä¸ªäººæœ€åç®—å‡ºæ¥çš„yä¸ä¸€æ ·ï¼ˆä¸€ä¸ªæ˜¯yï¼Œä¸€ä¸ªæ˜¯p-yï¼‰ï¼Œç»è¿‡è¿ç®—åä¹Ÿä¸ä¼šå½±å“xçš„å€¼ï¼ˆå¯èƒ½ç”»ä¸ªå›¾ä¼šå¥½ç†è§£ä¸€ç‚¹ï¼Œä¸¤ä¸ªå¯¹ç§°çš„ç‚¹ï¼Œç”»æ–œç‡ï¼Œä¸æ›²çº¿çš„äº¤ç‚¹çš„xè¿˜æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»»æ„æ±‚å‡ºä¸€ä¸ªyæ¥è¿›è¡Œè®¡ç®—å°±è¡Œ</p><p>ç°åœ¨æ¥è¿›è¡Œyçš„è®¡ç®—ï¼Œé¢˜ç›®ç»™äº†æç¤ºp = 3 mod 4ï¼Œè¿™å°±å¯ä»¥è¿ç”¨äºŒæ¬¡å‰©ä½™çš„çŸ¥è¯†ç‚¹æ¥è§£å†³ï¼Œä¸‹é¢æ˜¯åŸç†å›¾</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1732085889491-3c78c1ef-668a-4c38-af7c-ba3b30ef22a4.jpeg" alt=""></p><p>è¿™é‡Œç›´æ¥ç”¨</p><p>$ y = a^\frac{p+1}{4}\mod p $</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥éå†pï¼ˆéå†å®Œæ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªè§£ï¼‰ï¼Œå› ä¸ºè¿™é¢˜pç¡®å®ä¸å¤§ï¼Œä¸¤ä¸ªåŠæ³•éƒ½è¡Œï¼Œéƒ½å¯ä»¥æ±‚pï¼ˆæˆ‘ä¸€å¼€å§‹ç”¨çš„ç¬¬äºŒä¸ªï¼Œè§‰å¾—ä¸æ˜¯é¢„æœŸè§£æ³•æ‰å»æŸ¥çš„ç¬¬ä¸€ä¸ªï¼‰ï¼Œæ±‚å‡ºyäº†å°±æ²¡ä»€ä¹ˆéš¾åº¦äº†ï¼Œå¥—é‚£ä¸ªè§£å¯†æ–‡ä»¶å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_pkcs7_padded</span>(<span class="params">message</span>):</span><br><span class="line">    padding = message[-message[-<span class="number">1</span>]:]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(padding[i] == <span class="built_in">len</span>(padding) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(padding)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">shared_secret: <span class="built_in">int</span>, iv: <span class="built_in">str</span>, ciphertext: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="comment"># Derive AES key from shared secret</span></span><br><span class="line">    sha1 = hashlib.sha1()</span><br><span class="line">    sha1.update(<span class="built_in">str</span>(shared_secret).encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    key = sha1.digest()[:<span class="number">16</span>]</span><br><span class="line">    <span class="comment"># Decrypt flag</span></span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext)</span><br><span class="line">    iv = <span class="built_in">bytes</span>.fromhex(iv)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_pkcs7_padded(plaintext):</span><br><span class="line">        <span class="keyword">return</span> unpad(plaintext, <span class="number">16</span>).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> plaintext.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">9739</span></span><br><span class="line">y = <span class="built_in">int</span>(((<span class="number">4726</span>**<span class="number">3</span>+<span class="number">497</span>*<span class="number">4726</span>+<span class="number">1768</span>)**((p+<span class="number">1</span>)//<span class="number">4</span>))%p)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line">E = EllipticCurve(GF(<span class="number">9739</span>),[<span class="number">497</span>,<span class="number">1768</span>])</span><br><span class="line">P = E([<span class="number">4726</span>,<span class="number">6287</span>])</span><br><span class="line">shared_secret = (<span class="number">6534</span>*P)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(shared_secret)</span><br><span class="line"></span><br><span class="line">iv = <span class="string">&#x27;cd9da9f1c60925922377ea952afc212c&#x27;</span></span><br><span class="line">ciphertext = <span class="string">&#x27;febcbe3a3414a730b125931dccf912d2239f3e969c4334d95ed0ec86f6449ad8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypt_flag(shared_secret, iv, ciphertext))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># crypto&#123;3ff1c1ent_k3y_3xch4ng3&#125;</span></span><br></pre></td></tr></table></figure><p><strong>flag</strong>ï¼šcrypto{3ff1c1ent_k3y_3xch4ng3}</p><h2 id="å››-æ€»ç»“"><a href="#å››-æ€»ç»“" class="headerlink" title="å››. æ€»ç»“"></a>å››. æ€»ç»“</h2><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹æ¤­åœ†æ›²çº¿å°±æœ‰äº†ç®€å•è®¤è¯†ï¼Œä½†å…¶å®è¿˜å¹¶æ²¡æœ‰æ¥è§¦åˆ°çœŸæ­£çš„ä¸€äº›åŠ å¯†ç®—æ³•ï¼Œæ¯”å¦‚è¯´ECCï¼ˆä½†æ˜¯åŸç†æ‡‚äº†è¿™ä¸ªä¹Ÿå°±å¾ˆå¥½ç†è§£äº†ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ï¼‰ã€‚è€Œä¸”æ¤­åœ†æ›²çº¿åŠ å¯†ä¹Ÿä¸æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œåé¢è¿˜è¦å­¦ä¹ å„ç§æ”»å‡»æ–¹å¼ï¼ˆåƒä¹‹å‰æˆ‘ç¥åˆ°çš„å…‰æ»‘æ•°æ”»å‡»ï¼‰ï¼Œæ€»çš„æ¥è¯´ï¼Œé“é˜»ä¸”é•¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> æ¤­åœ†æ›²çº¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ¼å…¥é—¨</title>
      <link href="/2024/11/15/%E6%A0%BC%E5%85%A5%E9%97%A8/"/>
      <url>/2024/11/15/%E6%A0%BC%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¼å…¥é—¨"><a href="#æ ¼å…¥é—¨" class="headerlink" title="æ ¼å…¥é—¨"></a>æ ¼å…¥é—¨</h1><p>è¿™ä¸¤å‘¨å°±æ˜¯å­¦ä¹ äº†ä¸€äº›æ ¼çš„åŸºæœ¬çŸ¥è¯†ï¼Œå› ä¸ºä¸´è¿‘æœŸä¸­è€ƒï¼Œå­¦çš„æœ‰ç‚¹ä»“ä¿ƒï¼Œä½†æ€»ç®—æ˜¯äº†è§£äº†ä¸€ç‚¹ï¼Œæˆ‘æŠŠå­¦åˆ°çŸ¥è¯†ç‚¹ä¹Ÿå†™äº†å†™ï¼Œä½œä¸šçš„è§£é¢˜æ€è·¯ä¼šæ”¾åœ¨åé¢é¢˜ç›®è¿ç”¨é‚£é‡Œï¼Œå¯ä»¥è·³è½¬å»çœ‹</p><h2 id="ä¸€-é¢„å¤‡çŸ¥è¯†"><a href="#ä¸€-é¢„å¤‡çŸ¥è¯†" class="headerlink" title="ä¸€. é¢„å¤‡çŸ¥è¯†"></a>ä¸€. é¢„å¤‡çŸ¥è¯†</h2><p>è¦å­¦ä¹ æ ¼ï¼Œæ˜¯å¾—æœ‰çº¿æ€§ä»£æ•°çš„çŸ¥è¯†æ‰è¡Œçš„ã€‚ï¼ˆåæ­£æˆ‘çœ‹åˆ°é‚£äº›çŸ©é˜µå‘é‡ä»€ä¹ˆçš„å°±å›å¿†èµ·ä¸Šå­¦æœŸè¢«çº¿ä»£æ”¯é…çš„ææƒ§ï¼‰å› ä¸ºæˆ‘ä¸Šå­¦æœŸçº¿ä»£å­¦çš„ä¹Ÿä¸å¥½ï¼Œå¿˜çš„ä¹Ÿå·®ä¸å¤šäº†ï¼ŒåŠ ä¸Šè¿™é‡Œç¯‡å¹…ä¹Ÿæœ‰é™ï¼Œæˆ‘ä¹Ÿåªèƒ½ç‚¹ä¸€ä¸‹cryptohackä¸Šé¢æåˆ°çš„ä¸€äº›çº¿ä»£çŸ¥è¯†ï¼Œç›®å‰æ¥çœ‹å¤Ÿç”¨ï¼Œä¸è¿‡å¼ºçƒˆå»ºè®®ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹çº¿ä»£ã€‚</p><h3 id="å‘é‡å’Œå‘é‡ç©ºé—´"><a href="#å‘é‡å’Œå‘é‡ç©ºé—´" class="headerlink" title="å‘é‡å’Œå‘é‡ç©ºé—´"></a>å‘é‡å’Œå‘é‡ç©ºé—´</h3><p>ä»¥äºŒç»´å‘é‡ç©ºé—´ä¸¾ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„å–ä¸€ä¸ªç‚¹Aï¼Œè¿æ¥åŸç‚¹Oå’ŒAç‚¹ï¼Œè¿™å°±æ„æˆæˆäº†ä¸€ä¸ªå‘é‡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨Aç‚¹çš„åæ ‡æ¥è¡¨ç¤ºè¿™ä¸ªå‘é‡,å°±åƒè¿™æ ·<strong>v=</strong>(x,y)</p><p>å‘é‡æ»¡è¶³åŠ å‡ã€æ•°ä¹˜å’Œç‚¹ç§¯è¿ç®—ï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼ˆåŠ ç²—è¡¨ç¤ºå‘é‡ï¼‰</p><p><strong>v</strong>=(a , b)ï¼Œ<strong>w</strong>=(c , d)</p><p><strong>v</strong> + <strong>w</strong> = ï¼ˆa + cï¼Œb + dï¼‰ ï¼ˆå‡æ³•åŒç†ï¼‰</p><p>c * <strong>w </strong>= ï¼ˆc * aï¼Œ c * b ï¼‰      ï¼ˆæ•°ä¹˜ï¼‰</p><p><strong>v</strong> * <strong>w</strong> = a * c + b * d        ï¼ˆç‚¹ç§¯ï¼‰</p><p>å¤šç»´æ˜¯åŒç†çš„</p><p>ç„¶åå‘é‡è¿˜åˆ†è¡Œå‘é‡å’Œåˆ—å‘é‡ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºè¡Œå‘é‡å°±æ˜¯åœ¨çº¸ä¸Šæ¨ªç€å†™çš„å‘é‡ï¼ˆç¡®ä¿¡ï¼‰ï¼Œåˆ—å‘é‡å°±æ˜¯åœ¨çº¸ä¸Šç«–ç€å†™çš„å‘é‡ï¼ˆç¡®ä¿¡ï¼‰</p><h3 id="å‘é‡å¤§å°å’ŒåŸº"><a href="#å‘é‡å¤§å°å’ŒåŸº" class="headerlink" title="å‘é‡å¤§å°å’ŒåŸº"></a>å‘é‡å¤§å°å’ŒåŸº</h3><p>$ \begin{Vmatrix}v\ \end{Vmatrix} $ç”¨æ¥è¡¨ç¤ºå‘é‡çš„é•¿åº¦ï¼Œå…¶å¤§å°æ˜¯$ \begin{align}<br>\sqrt{v*v}<br>\end{align} $(é«˜ä¸­åº”è¯¥å°±æœ‰è¿™ä¸ªçŸ¥è¯†ç‚¹çš„)</p><p>è¿™é‡Œè¿˜æœ‰ä¸€äº›å…³äºçº¿æ€§ç‹¬ç«‹çš„çŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚å‘é‡ç©ºé—´é‡Œæœ‰ä¸€ç»„å‘é‡$ v_i $</p><p>æ»¡è¶³æ–¹ç¨‹$ \begin{align} a_1â‹…v_1+a_2â‹…v_2+â€¦+a_kâ‹…v_k=0 \end{align} $</p><p>å½“$ a_i<br> $å…¨ä¸ºé›¶æ—¶ç­‰å¼æ‰æˆç«‹ï¼Œé‚£ä¹ˆè¿™kä¸ªå‘é‡å°±æ˜¯çº¿æ€§æ— å…³çš„ï¼Œåä¹‹çº¿æ€§ç›¸å…³</p><p>è€Œå‘é‡ç©ºé—´çš„åŸºåº•ä¼šè¦æ±‚æ˜¯ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ï¼Œå½“æˆ‘ä»¬æœ‰äº†è¿™ä¸€ç»„å‘é‡åŸºï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªåŸºåº•æ¥è¡¨ç¤ºè¿™ä¸ªå‘é‡ç©ºé—´ä¸­çš„ä»»æ„å‘é‡</p><p>æ‹¿äºŒç»´ç©ºé—´ä¸¾ä¾‹</p><p>$ \begin{align} i=(0,1)\end{align} $ $ \begin{align} j = (1,0)\end{align} $å°±æ˜¯ä¸€ç»„çº¿æ€§æ— å…³çš„åŸºåº•ï¼Œè¿™ä¸¤ä¸ªå‘é‡å°±å¯ä»¥è¡¨ç¤ºæ•´ä¸ªäºŒç»´å¹³é¢</p><p>å…¶å®äº†è§£ä¸€ä¸‹çŸ©é˜µä¼šæ›´æœ‰å¸®åŠ©ï¼Œä½†æ˜¯æˆ‘å°±ä¸ä»‹ç»äº†ï¼ˆæœ‰è¯•ç€æƒ³å†™ä¸€ä¸‹ï¼Œä½†æ˜¯å‘ç°è®²ä¸æ¸…æ¥šï¼Œè¿˜æ˜¯ç•™ç»™å¤§å®¶çš„çº¿ä»£è€å¸ˆå§ï¼‰</p><p><a href="https://www.bilibili.com/video/BV1aW411Q7x1/?spm_id_from=333.1007.top_right_bar_window_custom_collection.content.click&amp;vd_source=a01a62f772bf2e577e11004dfef0bde1">çº¿ä»£è¯¾ç¨‹</a>ï¼ˆæ”¾ä¸€ä¸ªå®‹æµ©è€å¸ˆçº¿ä»£è¯¾çš„é“¾æ¥å§ï¼‰</p><h3 id="æ–½å¯†ç‰¹æ­£äº¤åŒ–"><a href="#æ–½å¯†ç‰¹æ­£äº¤åŒ–" class="headerlink" title="æ–½å¯†ç‰¹æ­£äº¤åŒ–"></a>æ–½å¯†ç‰¹æ­£äº¤åŒ–</h3><p>è¿™ä¸ªä¸œè¥¿æ„Ÿè§‰åªå¯æ„ä¼šä¸å¯è¨€ä¼ äº†ï¼Œæˆ‘å°±æ”¾ä¸ªå›¾ï¼Œ<del>å¤§å®¶è‡ªå·±æ‚Ÿå§</del>ï¼ˆä¸»è¦æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåªä¼šå¥—å…¬å¼ï¼‰</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730734509235-c52c5bf3-4af8-4401-9542-e0c44579ad40.png" alt=""></p><p>è¿™ä¸ªæ­£äº¤åŒ–å°±æ˜¯å¯ä»¥æ„é€ ä¸€ä¸ªæ­£äº¤åŸºï¼Œæ­£äº¤çš„æ¦‚å¿µå°±æ˜¯å‘é‡ç›¸äº’å‚ç›´ï¼Œä¸Šé¢æˆ‘ä¸¾çš„äºŒç»´ç©ºé—´çš„åŸºåº•å°±æ˜¯ä¸€ç»„æ­£äº¤åŸºï¼Œå› ä¸ºç‚¹ä¹˜ä¸ºé›¶ï¼ˆä¸¤ä¸ªå‘é‡å‚ç›´ï¼Œç‚¹ä¹˜ä¸ºé›¶ï¼‰</p><p>æ­£äº¤åŒ–ä¼šæœ‰æŒºå¤šå¥½å¤„çš„ï¼ˆåº”è¯¥ï¼Œåæ­£æ²¡å­¦æ‡‚ï¼Œå°±ä¼šå¥—å…¬å¼ï¼‰</p><p>è¿™ä¸ªå°±æ˜¯è§£å†³ä¸€ä¸‹crypto hackä¸Šçš„ä¸€é“é¢˜ï¼Œå…¶ä»–åœ°æ–¹å¥½åƒå’Œé‚£ä¸ªé«˜æ–¯æ™¶æ ¼è§„çº¦æœ‰ç‚¹åƒï¼Œä½†é‚£é‡Œæˆ‘ä»¬ä¼šå››èˆäº”å…¥ï¼Œæ‰€ä»¥è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„</p><p>ä¸‹é¢æ”¾ä¸€ä¸ªæ±‚è§£ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sympy.matrices <span class="keyword">import</span> Matrix, GramSchmidt</span><br><span class="line">l = [Matrix([<span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, -<span class="number">1</span>]), Matrix([<span class="number">2</span>, <span class="number">1</span>, -<span class="number">3</span>, <span class="number">4</span>]), Matrix([<span class="number">1</span>, <span class="number">0</span>, -<span class="number">2</span>, <span class="number">7</span>]), Matrix([<span class="number">6</span>, <span class="number">2</span>, <span class="number">9</span>, -<span class="number">5</span>])]</span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šå°†æ•°æ®è½¬ä¸ºMatrixæ ¼å¼ï¼Œå¦åˆ™è°ƒç”¨GramSchmidtå‡½æ•°ä¼šæŠ¥é”™ï¼</span></span><br><span class="line"><span class="comment"># è¿”å›æœªå•ä½åŒ–ç»“æœ</span></span><br><span class="line">o1 = GramSchmidt(l) <span class="comment"># æ³¨æ„ï¼šorthonormalé»˜è®¤ä¸ºFalseï¼Œä¸æ‰§è¡Œå•ä½åŒ–æ“ä½œ</span></span><br><span class="line"><span class="built_in">print</span>(o1)</span><br><span class="line"><span class="comment"># è¿”å›å•ä½åŒ–ç»“æœ</span></span><br><span class="line">o2 = GramSchmidt(l,orthonormal=<span class="literal">True</span>) <span class="comment"># æ³¨æ„ï¼šorthonormalè®¾ä¸ºTrueï¼Œæ‰§è¡Œå•ä½åŒ–æ“ä½œ</span></span><br><span class="line"><span class="built_in">print</span>(o2)</span><br></pre></td></tr></table></figure><h2 id="äºŒ-æ ¼çš„åˆæ­¥è®¤è¯†"><a href="#äºŒ-æ ¼çš„åˆæ­¥è®¤è¯†" class="headerlink" title="äºŒ. æ ¼çš„åˆæ­¥è®¤è¯†"></a>äºŒ. æ ¼çš„åˆæ­¥è®¤è¯†</h2><blockquote><p>å‚è€ƒæ–‡æ¡£</p><p><a href="https://tover.xyz/p/LLL-attack-equation/">æ ¼æ”»å‡»ä¹‹å°æœªçŸ¥æ•°æ–¹ç¨‹æ±‚è§£å…¥é—¨â€”â€”åŸç†ä¸ä¾‹å­ | Toverâ€™s Blog</a></p><p>è¿™ä¸ªåšå®¢é‡Œè®²çš„çœŸçš„å¾ˆå¥½ï¼</p></blockquote><h3 id="æ ¼å®šä¹‰"><a href="#æ ¼å®šä¹‰" class="headerlink" title="æ ¼å®šä¹‰"></a>æ ¼å®šä¹‰</h3><p>è¿™é‡Œå…ˆæ”¾ä¸€ä¸ªè¯¾æœ¬ä¸Šçš„å®šä¹‰</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1731031878819-11983b36-e144-4468-acf9-e5961f9a255a.jpeg" alt=""></p><p>å¯èƒ½çœ‹èµ·æ¥æ¯”è¾ƒéš¾æ‡‚ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ä»ä¸Šé¢é‚£ä¸ªäºŒç»´å¹³é¢å‡ºå‘ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ç»„åŸºåº•æ¥è¡¨ç¤ºæ•´ä¸ªäºŒç»´å¹³é¢ï¼ˆåŸºåº•ä¸å”¯ä¸€ï¼‰ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡æŠŠè¿™ä¸¤ä¸ªå‘é‡ä¹˜ä»¥ä¸åŒçš„ç³»æ•°åç›¸åŠ å¾—åˆ°çš„ï¼Œé‚£ä¹ˆæƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¦‚æœä»¤ç³»æ•°åªä¸ºæ•´æ•°ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªåŸºåº•ï¼Œå°±åªèƒ½å¾—åˆ°ç©ºé—´é‡Œçš„ä¸€äº›ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå°±æ˜¯ä¸€ä¸ªæ•´æ•°æ ¼</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1731033008919-7ec8338d-05df-4c71-8650-b0c08eb23041.png" alt=""></p><p>æˆ‘ä»¬æŠŠåŸºåº•å†™æˆä¸€ä¸ªçŸ©é˜µï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°ä¸Šé¢å®šä¹‰é‡Œçš„å†™æ³•ï¼ŒåŒæ—¶è¿™ä¸ªçŸ©é˜µçš„<strong>è¡Œåˆ—å¼</strong>çš„å€¼ï¼Œå«åšè¿™ä¸ª<strong>åŸºæœ¬åŸŸçš„å®¹ç§¯</strong></p><p>åŒæ—¶å¦‚æœæˆ‘ä»¬æ‰©å±•åˆ°nç»´å‘é‡ç©ºé—´ï¼Œå°±æ˜¯å®šä¹‰é‡Œçš„è¡¨ç¤º</p><h3 id="æ ¼å¸¸è§é—®é¢˜"><a href="#æ ¼å¸¸è§é—®é¢˜" class="headerlink" title="æ ¼å¸¸è§é—®é¢˜"></a>æ ¼å¸¸è§é—®é¢˜</h3><p>é€šè¿‡ä¸Šé¢æˆ‘ä»¬ç®€å•äº†è§£äº†ä¸€ä¸‹æ ¼æ˜¯ä»€ä¹ˆï¼Œé•¿ä»€ä¹ˆæ ·ï¼Œé‚£ä¹ˆå°±è¦è€ƒè™‘èƒ½æ‹¿å®ƒå¹²ä»€ä¹ˆ</p><p>è¿™å°±å¾—æä¸€ä¸‹æ ¼ä¸Šçš„ä¸¤ä¸ªå¸¸è§é—®é¢˜ï¼Œä¸€ä¸ªæ˜¯æœ€çŸ­å‘é‡é—®é¢˜ï¼ˆSVPï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯æœ€è¿‘å‘é‡é—®é¢˜ï¼ˆCVPï¼‰</p><p>SVPæ˜¯æŒ‡æˆ‘ä»¬è¦åœ¨æ ¼Lä¸Šæ‰¾åˆ°ä¸€ä¸ªæœ€çŸ­çš„éé›¶å‘é‡$ v $ï¼Œä½¿å¾—$ \begin{Vmatrix}v\ \end{Vmatrix} $æœ€å°</p><p>å¯èƒ½åœ¨äºŒç»´ç©ºé—´é‡Œä½ ä¸€ä¸‹å°±å¯ä»¥çœ‹å‡ºæ¥å“ªä¸ªæ˜¯æœ€çŸ­çš„å‘é‡ï¼Œä½†æ˜¯ä¸€æ—¦æ‰©å±•åˆ°å¤šç»´æ—¶ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå›°éš¾çš„é—®é¢˜äº†ã€‚è¿™é‡Œè¡¥ä¸€ä¸ªè¯¾æœ¬ä¸Šçœ‹åˆ°çš„å­˜åœ¨æ€§å®šç†ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹ä¸€ä¸‹</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42554774/1731034540889-80fdac9a-282b-49e1-b5ab-8cbfa0c984fe.jpeg" alt=""></p><p>é‚£ä¹ˆä¸ºäº†æ‰¾åˆ°è¿™ä¸ªæœ€çŸ­å‘é‡ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹è§„çº¦</p><h4 id="é«˜æ–¯æ ¼åŸºè§„çº¦"><a href="#é«˜æ–¯æ ¼åŸºè§„çº¦" class="headerlink" title="é«˜æ–¯æ ¼åŸºè§„çº¦"></a>é«˜æ–¯æ ¼åŸºè§„çº¦</h4><p>è¿™ä¸ªæ˜¯é€‚ç”¨äºäºŒç»´å¹³é¢ï¼Œé€šè¿‡ç®—æ³•å¯ä»¥æ‰¾åˆ°äºŒç»´å¹³é¢é‡Œçš„æœ€çŸ­å‘é‡ï¼Œæ„Ÿè§‰æ˜¯LLLçš„ç‰¹æ®Šæƒ…å†µï¼ˆå› ä¸ºå¥½åƒsageä¸Šç”¨LLLçš„ç®—æ³•ä¹Ÿå¯ä»¥è§£è¿™ä¸ªï¼‰ï¼Œä¸‹é¢æ”¾ä¸ªç®—æ³•å›¾</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1731034151787-c932dad2-cf3a-40a6-bd0a-392a94db460c.png" alt=""></p><p>å¦‚æœä½ ä»”ç»†çœ‹ä¸€ä¸‹çš„è¯å°±ä¼šå‘ç°è¿™ä¸ªç®—æ³•å’Œé‚£ä¸ªæ–½å¯†ç‰¹æ­£äº¤åŒ–æ˜¯æœ‰ä¸€ç‚¹åƒçš„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“åœ¨æ–½å¯†ç‰¹æ­£äº¤åŒ–é‡Œï¼Œmä¸ä¸€å®šæ˜¯æ•´æ•°ï¼Œè¿™å°±ä¼šå¯¼è‡´å¾—åˆ°çš„å‘é‡ä¸åœ¨æ ¼é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹må››èˆäº”å…¥å–æ•´ï¼Œè¿™æ ·æ¥å¾—åˆ°</p><h4 id="LLLæ ¼åŸºè§„çº¦"><a href="#LLLæ ¼åŸºè§„çº¦" class="headerlink" title="LLLæ ¼åŸºè§„çº¦"></a>LLLæ ¼åŸºè§„çº¦</h4><p>åŸç†å…¶å®æ„Ÿè§‰å·®ä¸äº†å¤ªå¤šï¼Œå°±æ˜¯å»æ‰¾æœ€çŸ­å‘é‡</p><p>è¿™é‡Œçš„è¿ç”¨å°±æ˜¯æ ¹æ®å…³ç³»æ‰¾åˆ°ä¸€ä¸ªåŸºåº•çš„çŸ©é˜µï¼ŒçŸ©é˜µä¸­æ‰€æœ‰æ•°æ˜¯å·²çŸ¥çš„ï¼Œç„¶åæˆ‘ä»¬è¦æ±‚è§£çš„å‘é‡ï¼ˆè¦æ±‚è§£çš„æœªçŸ¥æ•°æ„æˆçš„å‘é‡ï¼‰æ˜¯ä¸€äº›æ•°ä½œç”¨åœ¨è¿™ä¸ªçŸ©é˜µåå¾—åˆ°ï¼Œè¿™ä¸ªå‘é‡å°±åœ¨æ ¼ä¸Šï¼Œç„¶åæˆ‘ä»¬æœŸæœ›è¿™ä¸ªå‘é‡æ˜¯æœ€çŸ­å‘é‡ï¼Œä»¥æ­¤æ¥æ±‚è§£æœªçŸ¥æ•°ï¼Œä¸‹é¢æ”¾ä¸€ä¸ªnewstaræ—¶å€™ç”¨è¿‡çš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># sage</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">#from tqdm import *</span><br><span class="line"> </span><br><span class="line">a = 134812492661960841508904741709490501744478747431860442812349873283670029478557996515894514952323891966807395438595833662645026902457124893765483848187664404810892289353889878515048084718565523356944401254704006179297186883488636493997227870769852726117603572452948662628907410024781493099700499334357552050587</span><br><span class="line">b = 1522865915656883867403482317171460381324798227298365523650851184567802496240011768078593938858595296724393891397782658816647243489780661999411811900439319821784266117539188498407648397194849631941074737391852399318951669593881907935220986282638388656503090963153968254244131928887025800088609341714974103921219202972691321661198135553928411002184780139571149772037283749086504201758438589417378336940732926352806256093865255824803202598635567105242590697162972609</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">mat = [[b,0],[a,1]]</span><br><span class="line">M = Matrix(ZZ,mat)</span><br><span class="line">qq,pp= M.LLL()[0]   # æœ€çŸ­å‘é‡</span><br><span class="line"> </span><br><span class="line">print(pp)</span><br><span class="line">print(qq)</span><br></pre></td></tr></table></figure><p>ç„¶è€Œè¦è¿ç”¨LLLç®—æ³•æ˜¯æœ‰æ¡ä»¶çš„ï¼Œå°±æ˜¯æˆ‘ä»¬è¦é€šè¿‡è¿™ä¸ªç®—æ³•æ¥æ±‚æœ€çŸ­å‘é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ±‚çš„å‘é‡èµ·ç å¾—æ˜¯æœ€çŸ­å‘é‡ï¼Œè¿™å°±å¾—çœ‹ä¸€ä¸‹ä¸Šé¢çš„æœ€çŸ­å‘é‡å­˜åœ¨å®šç†ï¼Œæˆ‘ä»¬è¦æ±‚è§£çš„å‘é‡é•¿åº¦æ»¡è¶³æ¡ä»¶åæ‰æ˜¯æœ€çŸ­å‘é‡ï¼Œæ‰å¯ä»¥ç”¨LLLç®—æ³•ï¼Œç„¶åæ ¼çš„ç»´æ•°ä¹Ÿä¸èƒ½å¤ªé«˜ï¼Œä¸ç„¶å‡†ç¡®åº¦ä¸é«˜ï¼Œè€—æ—¶ä¹Ÿä¼šé•¿ã€‚</p><p>å…·ä½“è§£ä¸€ä¸‹é¢˜åº”è¯¥å°±èƒ½ç†è§£ï¼Œå¯ä»¥å¾€åçœ‹</p><h2 id="ä¸‰-é¢˜ç›®åŠè¿ç”¨"><a href="#ä¸‰-é¢˜ç›®åŠè¿ç”¨" class="headerlink" title="ä¸‰. é¢˜ç›®åŠè¿ç”¨"></a>ä¸‰. é¢˜ç›®åŠè¿ç”¨</h2><p>æˆ‘ä»¬æ¥å…·ä½“åˆ†æä¸€ä¸‹ä¸‹é¢è¿™ä¸€é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Tools.scripts.var_access_benchmark <span class="keyword">import</span> make_nonlocal_writer</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;crypto&#123;?????????????????????&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    upper_bound = <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>))</span><br><span class="line">    lower_bound = <span class="built_in">int</span>(math.sqrt(q // <span class="number">4</span>))</span><br><span class="line">    f = random.randint(<span class="number">2</span>, upper_bound)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        g = random.randint(lower_bound, upper_bound)</span><br><span class="line">        <span class="keyword">if</span> math.gcd(f, g) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (inverse(f, q)*g) % q</span><br><span class="line">    <span class="keyword">return</span> (q, h), (f, g)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">q, h, m</span>):</span><br><span class="line">    <span class="keyword">assert</span> m &lt; <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>))</span><br><span class="line">    r = random.randint(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(q // <span class="number">2</span>)))</span><br><span class="line">    e = (r*h + m) % q</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">q, h, f, g, e</span>):</span><br><span class="line">    a = (f*e) % q</span><br><span class="line">    m = (a*inverse(f, g)) % g</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public, private = gen_key()</span><br><span class="line">q, h = public</span><br><span class="line">f, g = private</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">e = encrypt(q, h, m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Public key: <span class="subst">&#123;(q,h)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Encrypted Flag: <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘åœ¨newstarçš„æ—¶å€™æœ‰ç®€å•çœ‹çœ‹æ ¼ï¼Œé‚£ä¸ªæ—¶å€™è®¤è¯†ä¸å¤Ÿå…¨é¢ï¼Œä»¥ä¸ºåªè¦æ„é€ å‡ºä¸€ä¸ªçŸ©é˜µå°±è¡Œï¼Œæ‰€æœ‰ä¸‹é¢åˆ†äº«ä¸€ä¸ªé”™è¯¯æ€è·¯</p><p>å°±æ˜¯æˆ‘ä¸€çœ‹åˆ°å°±å®šç›åœ¨e = (r*h + m) % qè¿™ä¸ªå¼å­ä¸Š</p><p>ç„¶åe - m = q*k + r*h</p><p>æ‰€ä»¥$ \begin{align}(k,r)\begin{pmatrix}q&amp;0 \\ h&amp;1 \end{pmatrix} =(e-m,r)\end{align} $</p><p>æˆ‘ä»¬å†™æˆ  v*B = w</p><p><del>æƒ³ç€è¿™ä¸ªå¼å­æ„é€ å‡ºæ ¼ï¼Œç›´æ¥æ±‚æ˜æ–‡ï¼Œç®€å•ç®€å•</del></p><p>ä½†æ˜¯è¿™ä¸ªæ€è·¯æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºæ²¡æœ‰è€ƒè™‘æˆ‘ä»¬é€šè¿‡ï¼ˆkï¼Œrï¼‰ä½œç”¨åˆ°çŸ©é˜µåå¾—åˆ°çš„è¿™ä¸ªå‘é‡åˆ°åº•æ˜¯ä¸æ˜¯æœ€çŸ­å‘é‡</p><p>æˆ‘ä»¬å¯ä»¥ç®—ä¸€ä¸‹$ \begin{Vmatrix}w\ \end{Vmatrix} $å’Œ$ \sqrt2{det(B)}^\frac{1}{2} $ï¼ˆæ ¹æ®ä¸Šé¢æœ€çŸ­å‘é‡å­˜åœ¨å®šç†æ¯”è¾ƒä¸€ä¸‹ï¼Œå°±å¯ä»¥åˆ¤æ–­wæ˜¯ä¸æ˜¯æœ€çŸ­å‘é‡ï¼‰ï¼Œå…¶å®è¿™é‡Œæ²¡æœ‰æ˜æ˜¾çš„ç®—å‡ºå€¼ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“mï¼Œä½†å¤§æ¦‚ç‡è¿™ä¸ªwçš„é•¿åº¦æ˜¯å¤§çš„ï¼‰æ‰€ä»¥å¤§å°éƒ½ä¸çŸ¥é“ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•åˆ¤æ–­wæ˜¯ä¸æ˜¯æœ€çŸ­å‘é‡ï¼Œæ‰€æœ‰LLLè§„çº¦æ±‚å‡ºæ¥çš„ä¸æ˜¯wã€‚è¿™é‡Œæ ¹æœ¬è¿˜æ˜¯å› ä¸ºæˆ‘è¿èƒŒè¿™ç§é¢˜ç›®çš„åˆè¡·ï¼Œå°±æ˜¯æœ¬æ¥æ˜¯ç”¨æ ¼æ”»å‡»æ±‚å°æœªçŸ¥æ•°ï¼Œä½†æ˜¯æˆ‘æ±‚çš„ä¸æ˜¯å°æœªçŸ¥æ•°</p><p><strong>ä¸Šé¢é”™è¯¯æ€è·¯å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸æ˜¯æ‰€æœ‰çš„å¼å­éƒ½å¯ä»¥é€šè¿‡æ„é€ æ ¼æ¥æ±‚è§£ï¼Œåªæœ‰å½“æˆ‘ä»¬è¦æ±‚è§£çš„æœªçŸ¥æ•°æ‰€æ„æˆçš„å‘é‡æ°å¥½åœ¨æ ¼ä¸Šï¼Œä¸”è¿™ä¸ªå‘é‡æ°å¥½æ˜¯æœ€çŸ­å‘é‡æ—¶ï¼ˆå°æœªçŸ¥æ•°ï¼‰ï¼Œæ‰å¯ä»¥æ±‚è§£</strong></p><p>é‚£ä¹ˆä¸‹é¢æ¥çœ‹æ­£ç¡®åšæ³•</p><p>æ—¢ç„¶ä¸Šé¢é‚£ä¸ªå¼å­æ„é€ å‡ºæ¥çš„æ ¼ä¸å¯¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è½¬æˆ˜å¦ä¸€ä¸ªå¼å­</p><p>h = (inverse(f, q)*g) % q</p><p>å³ h = k * q + f<sup> -1</sup> * g modï¼ˆqï¼‰</p><p>è¿™ä¹ˆçœ‹æœ‰ä¸ªfå…³äºqçš„é€†å…ƒï¼Œé‚£ä¹ˆä¸¤è¾¹ä¹˜ä¸ªfï¼Œå¾—åˆ°</p><p>h * f = k * q * f + g  </p><p>æˆ‘ä»¬è¯•ç€ç§»é¡¹å¾—åˆ° g = h*f + k<sub>1</sub> *q*f   ï¼ˆä¸ºä»€ä¹ˆè¦ç§»é¡¹ï¼Ÿå› ä¸ºæˆ‘ä»¬è¦æŠŠå·²çŸ¥çš„ä¸¤ä¸ªæ•°hå’Œqæ”¾åœ¨ä¸€è¾¹ï¼Œæ¥æ„é€ çŸ©é˜µï¼‰</p><p>è¿™ä¸ªæ—¶å€™å°±å¾ˆæ¸…æ™°äº†ï¼ŒåŠ ä¸Š  kf * 0 + f = f ï¼ˆæ„Ÿè§‰æ˜¯ä¸€ç±»æ¯”è¾ƒå›ºå®šçš„å¼å­ï¼Œä¸€ä¸ªæ’ç­‰å¼ï¼Œæ–¹ä¾¿æ„é€ çŸ©é˜µï¼‰è¿™ä¸ªå¼å­å°±å¯ä»¥å¾—åˆ°</p><p>$ \begin{align}(k_1f,f) \begin{pmatrix} q&amp;0 \\ h&amp;1 \end{pmatrix} =(g,f)\end{align} $</p><p>æˆ‘ä»¬å†™æˆ  v*B = w</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†éªŒè¯ä¸€ä¸‹$ \left \| w \right \| = \sqrt{f^{2} * g^{2}} ï¼œ\sqrt{(\frac{q}{2})^{2} *(\frac{q}{2})^{2}  } ï¼œ\sqrt{2}\sqrt{q}ï¼œ\sqrt{2} det(B)^{\frac{1}{2} } $</p><p>få’Œgå°äºqçš„ä¸€åŠåº”è¯¥æ˜¯æ˜¾ç„¶çš„ï¼Œå› ä¸ºé¢˜ç›®å®šä¹‰çš„æ—¶å€™å°±æ˜¯å°äºçš„ï¼Œä¸ç†è§£å¯ä»¥è¿”å›å»å†çœ‹ä¸€ä¸‹é¢˜ç›®å®šä¹‰få’Œgé‚£é‡Œ</p><p>è¿™ä¸ªæ—¶å€™wå¤§æ¦‚ç‡å°±æ˜¯æœ€å°å‘é‡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è¿ç”¨LLLæ ¼çº§è§„çº¦å°±å¯ä»¥æ±‚å‡ºwï¼Œå³å¯†é’¥ï¼Œç„¶åé€šè¿‡è§£å¯†ä»£ç ï¼ˆé¢˜ç›®å·²ç»™ï¼‰å°±å¯ä»¥æ±‚å‡ºæ˜æ–‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from tqdm import *</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mat = [[b,<span class="number">0</span>],[a,<span class="number">1</span>]]</span><br><span class="line">M = Matrix(ZZ,mat)</span><br><span class="line">g,f= M.LLL()[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">q, h, f, g, e</span>):</span><br><span class="line">    a = (f*e) % q</span><br><span class="line">    m = (a*inverse(f, g)) % g</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">    </span><br><span class="line">Publickey=(<span class="number">7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257</span>, <span class="number">2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800</span>)</span><br><span class="line">q = Publickey[<span class="number">0</span>]</span><br><span class="line">h = Publickey[<span class="number">1</span>]</span><br><span class="line">e = <span class="number">5605696495253720664142881956908624307570671858477482119657436163663663844731169035682344974286379049123733356009125671924280312532755241162267269123486523</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = <span class="number">43997957885147078115851147456370880089696256470389782348293341937915504254589</span></span><br><span class="line"></span><br><span class="line">f = <span class="number">47251817614431369468151088301948722761694622606220578981561236563325808178756</span></span><br><span class="line"></span><br><span class="line">m =decrypt(q, h, f, g, e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥è§£å‡ºæ˜æ–‡äº†</p><h2 id="å››-æ€»ç»“"><a href="#å››-æ€»ç»“" class="headerlink" title="å››. æ€»ç»“"></a>å››. æ€»ç»“</h2><p>æœ€åç®€å•æ€»ç»“ä¸€ä¸‹ç”¨æ ¼è§£å°æœªçŸ¥æ•°æ–¹ç¨‹çš„è¿‡ç¨‹</p><p>é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªå¼å­ï¼Œè½¬åŒ–æˆä¸€ä¸ªå‘é‡ï¼ˆæ„Ÿè§‰å¯ä»¥å«ç³»æ•°å‘é‡ï¼Œå› ä¸ºå°±æ˜¯è¿™ä¸ªå‘é‡ä½œç”¨äºçŸ©é˜µï¼Œä»¥æ­¤æ¥å¾—åˆ°ä¸€ä¸ªåœ¨æ ¼ä¸Šçš„å‘é‡ï¼‰ä¹˜ä»¥ä¸€ä¸ªçŸ©é˜µï¼ˆåŸºåº•ï¼‰ï¼Œå¾—åˆ°å¦ä¸€ä¸ªå‘é‡ï¼ˆæˆ‘ä»¬è¦æ±‚è§£çš„å°æœªçŸ¥æ•°æ‰€æ„æˆçš„å‘é‡ï¼‰çš„å½¢å¼</p><p>ç„¶åå¯ä»¥ç®€å•åˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯æœ€çŸ­å‘é‡ï¼ˆæ ¹æ®æœ€çŸ­å‘é‡å­˜åœ¨å®šç†ï¼‰</p><p>ä¹‹åå°±å¯ä»¥ç”¨LLLè§„çº¦è§£å‡ºæœ€çŸ­å‘é‡ï¼Œè¿™ä¸ªå‘é‡é‡Œçš„å°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„å°æœªçŸ¥æ•°äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> æ ¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ªäººåšå®¢æ­å»º</title>
      <link href="/2024/11/02/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/11/02/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ªäººåšå®¢æ­å»º"><a href="#ä¸ªäººåšå®¢æ­å»º" class="headerlink" title="ä¸ªäººåšå®¢æ­å»º"></a>ä¸ªäººåšå®¢æ­å»º</h1><blockquote><p>å‚è€ƒæ–‡ç« </p><p><a href="https://blog.fiveth.cc/p/bb32/">https://blog.fiveth.cc/p/bb32/</a></p><p><a href="https://www.bilibili.com/video/BV1Ju4m1c7WR/?spm_id_from=333.1007.top_right_bar_window_default_collection.content.click&amp;vd_source=a01a62f772bf2e577e11004dfef0bde1">ã€é›¶æˆæœ¬ã€‘Hexoä¸ªäººåšå®¢æ­å»ºæ•™ç¨‹ | æ— éœ€æœåŠ¡å™¨_å“”å“©å“”å“©_bilibili</a></p></blockquote><p>è®°å½•ä¸€ä¸‹ä¸ªäººåšå®¢çš„æ­å»ºè¿‡ç¨‹ï¼Œæˆ‘çš„æ˜¯Hexoæ¡†æ¶ï¼Œå‚è€ƒçš„å°±æ˜¯ä¸Šé¢çš„è§†é¢‘å’Œåšå®¢ï¼Œä¸­é—´æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œç„¶åæˆ‘çœ‹äº†å¦å¤–ä¸€ä½å¤§ä½¬çš„åšå®¢è§£å†³çš„ï¼Œç­‰åˆ°å…·ä½“æ­¥éª¤å…·ä½“è¯´ï¼Œç„¶åæˆ‘æ­å¥½çš„ç»“æœå°±æ˜¯<a href="https://mondaying.cn">mondaying.cn</a>ï¼ˆå°±æ˜¯ç®€å•æå‡ºæ¥ï¼Œä¸»é¢˜ä»€ä¹ˆçš„è¿˜æ˜¯æ²¡ææ‡‚ï¼‰ï¼Œä¸‹é¢å°±ç®€å•è®²ä¸€ä¸‹è¿‡ç¨‹ã€‚</p><h2 id="ä¸€-å‡†å¤‡å·¥ä½œ"><a href="#ä¸€-å‡†å¤‡å·¥ä½œ" class="headerlink" title="ä¸€. å‡†å¤‡å·¥ä½œ"></a>ä¸€. å‡†å¤‡å·¥ä½œ</h2><blockquote><p>å‚è€ƒæ–‡ç« </p><p><a href="https://www.cnblogs.com/liuqiyun/p/8133904.html">https://www.cnblogs.com/liuqiyun/p/8133904.html</a></p><p><a href="https://www.cnblogs.com/xueweisuoyong/p/11914045.html">https://www.cnblogs.com/xueweisuoyong/p/11914045.html</a></p></blockquote><ol><li>é¦–å…ˆå°±æ˜¯è¦ä¸‹è½½node.js<br> <a href="https://nodejs.org/en">nodeé“¾æ¥</a><br> å°±åˆ°å®˜ç½‘ä¸‹è½½å°±è¡Œï¼Œæˆ‘æ˜¯ä¸‹è½½çš„æŒºé¡ºçš„ï¼Œæ²¡ä»€ä¹ˆå·®æ± ï¼Œç¬¬ä¸€ç¯‡æ–‡ç« è®²çš„æŒºè¯¦ç»†çš„ï¼Œç…§ç€åšå°±è¡Œ</li></ol><ol><li>ç„¶åä¸‹è½½git<br> <a href="https://git-scm.com/downloads">gité“¾æ¥</a><br> ä¹Ÿæ˜¯å®˜ç½‘ä¸‹è½½ï¼Œæˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä¸‹è½½å¾ˆæ…¢ï¼Œå¾—æœ‰å¿«åŠä¸ªå°æ—¶å¤šæ‰ä¸‹è½½å¥½ï¼Œå…¶ä»–æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢æ”¾çš„ç¬¬äºŒç¯‡æ–‡ç« </li></ol><p>ä¸‹è½½å®Œä¸Šé¢ä¸¤ä¸ªåå¯ä»¥æ‰“å¼€cmdæ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯å®‰è£…æˆåŠŸï¼ˆè¾“å…¥ä¸‹å›¾ä¸‰è¡Œä»£ç ï¼‰ï¼ŒæˆåŠŸçš„è¯å°±æ˜¯ä¸‹é¢è¿™ä¸ªç•Œé¢</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730260613488-26cebe87-d4f0-4a1c-9cd4-8e1a9cb4bd68.png" alt=""></p><ol><li>ç„¶åå°±æ˜¯ä¸‹è½½hexo<br> å¾—ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€cmd<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730260734784-72d18db3-7c13-46d9-8a47-1cf5cfb9a0c2.png" alt=""><br> ç„¶åè¾“å…¥ä¸‹é¢è¿™ä¸²ä»£ç ä¸‹è½½hexoï¼Œè¿™é‡Œæˆ‘åšå®Œå¿˜è®°æˆªå±äº†ï¼Œä¸è¿‡æ²¡æŠ¥é”™åº”è¯¥å°±æ˜¯æˆåŠŸäº†ï¼ˆç¡®ä¿¡)</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure><ol><li>æ¥ç€å°±æ˜¯æ³¨å†Œä¸€ä¸ªGitHubè´¦å·ï¼Œè¿™ä¸ªæˆ‘ä¸Šä¸ªå‡æœŸæçš„ï¼Œä¹Ÿå°±æ²¡æˆªå±äº†ï¼Œå¥½åƒä¹ŸæŒºé¡ºçš„ï¼Œå°±æ˜¯å–åå­—é‚£é‡ŒèŠ±äº†æŒºä¹…ï¼ˆä¸ºä»€ä¹ˆæƒ³å–çš„åå­—å…¨è¢«æ³¨å†Œå•Šï¼Œæ¼ï¼‰  </li></ol><h2 id="äºŒ-æ­å»ºä»“åº“"><a href="#äºŒ-æ­å»ºä»“åº“" class="headerlink" title="äºŒ. æ­å»ºä»“åº“"></a>äºŒ. æ­å»ºä»“åº“</h2><p>è¿™é‡Œå°±è¦ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰æ³¨å†Œçš„GitHubè´¦å·ã€‚ä¸»é¡µçš„å·¦è¾¹å°±æœ‰Create repositoryï¼Œç‚¹åå°±æ˜¯ä¸‹å›¾<br><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730262710074-a072ec7b-ab05-4936-bb98-6b3cbe57b849.png" alt=""></p><p>è¿™é‡Œå°±å¾—æ³¨æ„äº†ï¼Œä»“åº“åå¿…é¡»æŒ‰ç…§æ ¼å¼å¡«å†™ï¼Œå³ï¼š<strong>ç”¨æˆ·å.github.io</strong>ï¼Œæ¯”å¦‚æˆ‘çš„ç”¨æˆ·åæ˜¯Mondayingï¼ˆè¿™é‡Œçš„nameå’Œuser nameå¥½åƒæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¾—ç”¨user nameï¼‰ï¼Œé‚£ä¹ˆä»“åº“åå¿…é¡»å¡«Mondaying.github.io</p><p>ä»“åº“ä¹Ÿå¿…é¡»æ˜¯publicçš„ï¼Œç„¶åé‚£ä¸ªAdd a README fileä¹Ÿç‚¹ä¸Šï¼ˆè¿™ä¸ªæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåæ­£è·Ÿç€ç‚¹å°±å¯¹äº†ï¼‰</p><p>ç„¶åå°±åˆ›å»ºå¥½äº†ï¼Œæ”¾ç€å¤‡ç”¨</p><h2 id="ä¸‰-é…ç½®ssh-key"><a href="#ä¸‰-é…ç½®ssh-key" class="headerlink" title="ä¸‰. é…ç½®ssh key"></a>ä¸‰. é…ç½®ssh key</h2><ol><li>åœ¨æ¡Œé¢ç©ºç™½å¤„å³é”®ï¼Œç‚¹æ˜¾ç¤ºæ›´å¤šé€‰é¡¹ï¼Œæ‰“å¼€git bashï¼Œç²˜è´´ä¸‹é¢è¿™ä¸²ä»£ç ï¼Œè®°å¾—æŠŠé‚®ç®±æ”¹æˆè‡ªå·±çš„ï¼Œç„¶åæ•²å››ä¸‹é”®ç›˜</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;é‚®ä»¶åœ°å€&quot;</span><br></pre></td></tr></table></figure><ol><li>ä¹‹åå°±å»Cç›˜ç”¨æˆ·æ–‡ä»¶å¤¹é‡Œçš„æŸä¸ªæ–‡ä»¶å¤¹é‡Œï¼ˆå› ä¸ºå¥½åƒæ¯ä¸ªäººçš„éƒ½ä¸ä¸€æ ·ï¼Œåæ­£æˆ‘å’Œé‚£ä¸ªupä¸»çš„å°±ä¸ä¸€æ ·ï¼Œå¾—æ‰¾ä¸€ä¸‹ï¼‰å»æ‰¾ä¸‹é¢è¿™ä¸ªæ–‡ä»¶å¤¹<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730263737700-ac2180c4-8bd6-41f6-bc1d-99cb4e1f62ee.png" alt=""><br> ç‚¹å¼€é‡Œé¢æ‰¾åˆ°id_rsa.pubæ‰“å¼€ï¼Œå…¨é€‰å¤åˆ¶</li></ol><ol><li>ç„¶åæˆ‘ä»¬æ‰“å¼€GitHubï¼Œæ‰“å¼€Settings</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730264452254-9a4f4209-202a-4001-a148-02e26c07dffd.png" alt=""></p><p>ç‚¹è¿›å»ååœ¨å·¦è¾¹æ‰¾åˆ°SSH and GPG keysï¼Œç„¶åç‚¹å‡»new ssh keyï¼Œtitleé‚£é‡Œéšä¾¿å–åï¼Œkeyé‚£é‡Œç²˜è´´åˆšåˆšå¤åˆ¶çš„ä¸œè¥¿ï¼Œåˆ›å»ºå°±å¯ä»¥äº†<br><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730264596585-f4a79952-4151-4467-9825-9ba0870d06bd.png" alt=""></p><ol><li>å›åˆ°æ¡Œé¢ï¼Œæ‰“å¼€git bashï¼Œè¾“å…¥ä¸‹é¢è¿™ä¸²ä»£ç ï¼ŒéªŒè¯ä¸€ä¸‹æœ‰æ²¡æœ‰æ·»åŠ æˆåŠŸ</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>å›è½¦åè®°å¾—è¾“å…¥yesï¼Œè¿™é‡Œä¹Ÿå¿˜è®°ç»“æœæˆªå±äº†ï¼Œè¿˜æ˜¯æ²¡æŠ¥é”™å°±æˆåŠŸï¼ˆç¡®ä¿¡ï¼‰</p><h2 id="å››-æœ¬åœ°éƒ¨ç½²"><a href="#å››-æœ¬åœ°éƒ¨ç½²" class="headerlink" title="å››. æœ¬åœ°éƒ¨ç½²"></a>å››. æœ¬åœ°éƒ¨ç½²</h2><ol><li><p>é¦–å…ˆé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä½ç½®åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨æ¥æ”¾ç½®åšå®¢æ–‡ä»¶<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730265201600-39609800-8918-4b0f-9836-193245214bd8.png" alt=""><br> æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œåœ¨æ–‡ä»¶å¤¹é‡Œå³é”®æ‰“å¼€git bashï¼Œè¾“å…¥hexo initè¿›è¡Œåˆå§‹åŒ–ï¼ˆå¦‚æœä¸è¡Œå°±è¾“å…¥npx hexo initï¼‰æ³¨æ„ï¼Œè¾“å…¥è¿™è¡Œä»£ç åæ–‡ä»¶å¤¹é‡Œåº”è¯¥å¾—å†’å‡ºæ¥ä¸œè¥¿æ‰å¯¹ï¼Œå°±æ˜¯å¾—æœ‰ä¸€äº›æ–‡ä»¶çš„ï¼Œä½†æ˜¯åƒæˆ‘å°±æ˜¯è¾“å…¥åæ–‡ä»¶å¤¹é‡Œæ²¡æœ‰ä¸œè¥¿ï¼Œè™½ç„¶æ²¡æŠ¥é”™ï¼ˆæˆ‘è®°å¾—å½“æ—¶æ˜¯æ²¡æŠ¥é”™)ï¼Œä½†æ˜¯æ˜¯æœ‰é—®é¢˜çš„ï¼Œæˆ‘çš„è§£å†³æ–¹æ³•ä¹ŸæŒºç®€å•çš„ï¼Œå°±æ˜¯é€€å‡ºå»ï¼Œåˆ é™¤æ–‡ä»¶å¤¹ï¼Œç„¶åé‡æ–°å¼„ï¼Œå¦‚æœæ˜¾ç¤ºæ–‡ä»¶å¤¹è¢«å ç”¨æ— æ³•åˆ é™¤é‚£å°±é‡å¯ç”µè„‘ã€‚<br> åæ­£åé¢å‡ æ­¥ä¹Ÿä¸€æ ·ï¼Œä¸€æ—¦æœ‰é—®é¢˜å°±åˆ é™¤æ–‡ä»¶å¤¹é‡æ–°æ¥ï¼Œå¤šæ¥å‡ æ¬¡å°±å¯ä»¥äº†  </p></li><li><p>è¾“å…¥npx hexo installå®‰è£…  </p></li><li><p>è¾“å…¥npx hexo gç”Ÿæˆ<br> æˆ‘è®°å¾—è¿™é‡Œæˆ‘å¡äº†æŒºä¹…ï¼Œå°±æ˜¯è¾“å…¥åå®ƒå°±æ˜¯æ²¡ååº”ï¼Œä½†æ˜¯å¤šç­‰ä¸€ä¼šå°±æœ‰äº†ï¼Œå¦‚æœè¿‡äº†å¾ˆä¹…éƒ½ä¸è¡Œå°±æŒ‰ä¸Šé¢æ–¹æ³•ï¼Œåˆ é™¤æ–‡æ¡£é‡æ–°æ¥  </p></li><li><p>è¾“å…¥npx hexo sæœ¬åœ°éƒ¨ç½²<br> è¿™ä¹‹åæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä¸€ä¸ªé“¾æ¥ï¼Œæ‰“å¼€å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åšå®¢åœ¨æœ¬åœ°éƒ¨ç½²å•¦ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„åšå®¢äº†ï¼Œè¿™é‡Œè®°å¾—å›åˆ°å‘½ä»¤è¡Œç‚¹ctrl+cåœæ­¢æœ¬åœ°æœåŠ¡å™¨ï¼Œç„¶åå†å…³é—­çª—å£ï¼Œå¦åˆ™ä½ å°±å¾—åˆé‡å¯ä½ çš„ç”µè„‘äº†ï¼ˆæ¼ï¼‰å› ä¸ºä¸è¿™æ ·åé¢å†æ‰“å¼€å°±ä¼šæ˜¾ç¤ºè¢«å ç”¨</p></li></ol><h2 id="äº”-ä¸Šçº¿åšå®¢"><a href="#äº”-ä¸Šçº¿åšå®¢" class="headerlink" title="äº”. ä¸Šçº¿åšå®¢"></a>äº”. ä¸Šçº¿åšå®¢</h2><ol><li><p>é¦–å…ˆç”¨è®°äº‹æœ¬æ‰“å¼€åšå®¢æ–‡ä»¶å¤¹é‡Œçš„ä¸‹é¢è¿™ä¸ªæ–‡ä»¶<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730267044848-ab487849-6676-4475-beef-3aa05005dcb9.png" alt=""><br> å½“ç„¶ç”¨vscodeæ‰“å¼€æ•´ä¸ªæ–‡ä»¶å¤¹å†è¿›è¡Œæ“ä½œæœ€å¥½ï¼Œæˆ‘è¿™é‡Œå›¾ä¸ªæ–¹ä¾¿.  </p></li><li><p>æ‰“å¼€ä¹‹åæ‹–åˆ°æœ€åº•ä¸‹ï¼ŒæŠŠdeployä»¥åŠåé¢çš„å…¨åˆ æ‰ï¼Œå¤åˆ¶ç²˜è´´ä¸‹é¢è¿™æ®µ</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:user name/user name.github.io.git</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure><p>è®°å¾—æŠŠuser nameæ¢æˆæˆ‘ä»¬çš„åå­—</p><ol><li>ç„¶åæ¡Œé¢æ‰“å¼€git bashï¼Œè¾“å…¥npx hexo gç”Ÿæˆ<br> è¿™é‡Œæˆ‘å¼¹äº†ä¸€ä¸ªæŠ¥é”™ï¼Œæ˜¾ç¤ºæ²¡æ‰¾åˆ°gitï¼Œä½†æ˜¯è§†é¢‘é‡Œä¹Ÿæ²¡è®²ä¸ºä»€ä¹ˆ<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730127721025-d9a4a9da-26b8-45fa-a33a-2532af77ec07.png" alt=""><br> ç„¶åæˆ‘åˆæ‰¾åˆ°äº†ä¸€ä½å¤§ä½¬çš„åšå®¢<a href="https://www.fomal.cc/posts/e593433d.html">https://www.fomal.cc/posts/e593433d.html</a>å°±æ˜¯è¿™ç¯‡ï¼Œç„¶åè¾“å…¥ä¸‹é¢è¿™ä¸²ä»£ç å°±å¥½äº†</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><ol><li><p>ç„¶åè¾“å…¥npx hexo dä¸Šä¼ <br> ç„¶åè¿™é‡Œå› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œæ‰€ä»¥è¦å¡«ä¸€ä¸‹é…ç½®ï¼ŒæŒ‰ç…§ä¸‹å›¾è¾“å…¥ä¸¤ä¸ªä»£ç å°±è¡Œï¼Œè®°å¾—æŠŠé‚®ç®±å’Œåå­—æ”¹æˆè‡ªå·±çš„ï¼ˆæˆ‘è®°å¾—ä»£ç å®ƒä¼šæç¤ºä½ ï¼Œä½ åˆ°ä¸Šé¢å¤åˆ¶ä¸‹æ¥æ”¹ä¸€ä¸‹å°±è¡Œï¼‰<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730127867283-0a8ecd95-96ea-49b3-84ed-a6e04bdb5f18.png" alt="">  </p></li><li><p>é…ç½®å®Œäº†ä»¥åå†æ¬¡è¾“å…¥npx hexo dä¸Šä¼ ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªGitHubç™»å½•çª—å£ï¼Œè¿›è¡Œç™»å½•å°±å¯ä»¥äº†<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730128118033-25b37a7d-ad8b-4146-bebb-58dd54e16c2e.png" alt=""><br> æˆåŠŸåå°±æ˜¯ä¸‹å›¾è¿™æ ·<br> <img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730128563189-14de6c61-d288-4f12-8ca0-81a3b3406730.png" alt="">  </p></li><li><p>æˆ‘ä»¬å›åˆ°GitHubä¸Šçœ‹åˆ°ä»“åº“é‚£è¾¹é‚£ä¸ªé»„åœˆåœˆå˜æˆç»¿å‹¾åå°±å¯ä»¥è¾“å…¥é“¾æ¥è®¿é—®äº†</p></li></ol><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730128630964-3e3913b8-4c7c-43ec-8926-cb05b6ecbea5.png" alt=""></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42554774/1730128697211-575a3abb-1d12-4cf2-a2ad-5b43f796b00d.png" alt=""></p><h2 id="å…­-verceléƒ¨ç½²å’Œç»‘å®šåŸŸå"><a href="#å…­-verceléƒ¨ç½²å’Œç»‘å®šåŸŸå" class="headerlink" title="å…­. verceléƒ¨ç½²å’Œç»‘å®šåŸŸå"></a>å…­. verceléƒ¨ç½²å’Œç»‘å®šåŸŸå</h2><blockquote><p><a href="https://www.bilibili.com/video/BV1Ke4y1v7Qr/?spm_id_from=333.1007.top_right_bar_window_history.content.click&amp;vd_source=a01a62f772bf2e577e11004dfef0bde1">ç¬¬2æœŸï¼šVerceléƒ¨ç½²å¹¶ç»‘å®šè‡ªå®šä¹‰åŸŸå+å®‰è£…Butterflyä¸»é¢˜_å“”å“©å“”å“©_bilibili</a></p></blockquote><p>è¿™ä¸€æ­¥å…¶å®ä¹Ÿä¸æ˜¯å¿…é¡»çš„ï¼Œå°±æ˜¯æˆ‘çœ‹è§†é¢‘é‡Œæäº†è·Ÿç€éšä¾¿å¼„çš„ï¼Œå…¶å®æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼Œå› ä¸ºå…¶å®åˆ°ä¸Šé¢ç¬¬äº”æ­¥åšå®¢å°±å·²ç»æ­å¥½äº†ï¼Œè¿™é‡Œæˆ‘å°±ç®€å•è®²è®²æˆ‘å¹²äº†ä»€ä¹ˆï¼Œä¸ç»†è¯´</p><p>ç¬¬ä¸€ä¸ªverceléƒ¨ç½²ï¼Œå¥½åƒæ˜¯ä¼šè®©é€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”vercelå¥½åƒè¿˜å¯ä»¥æå›¾åºŠï¼ˆè™½ç„¶ç°åœ¨è¿˜ä¸å¤ªæ‡‚å›¾åºŠæ˜¯ä»€ä¹ˆï¼‰ï¼Œæ˜¯å¯ä»¥æä¸€ä¸‹çš„ï¼Œè·Ÿç€ä¸Šé¢é‚£ä¸ªè§†é¢‘æ¥å°±è¡Œï¼ŒæŒºç®€å•çš„ï¼Œä¸éš¾</p><p>ç¬¬äºŒä¸ªå°±æ˜¯ç»‘å®šè‡ªå·±çš„åŸŸåï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªåšå®¢å¾—ç»‘å®šä¸€ä¸ªå›½å†…çš„åŸŸåæ‰èƒ½åœ¨å›½å†…è®¿é—®ï¼ˆå¥½åƒæ˜¯ï¼‰ï¼Œç„¶åå°±æ˜¯ä¹°ä¸€ä¸ªï¼Œç»‘ä¸€ä¸‹å°±è¡Œï¼Œä¹ŸæŒºç®€å•çš„ï¼Œä¸Šé¢è§†é¢‘è®²å¾—ä¹Ÿå¾ˆè¯¦ç»†</p><p><strong>è¿™æ ·æˆ‘ä»¬çš„åšå®¢å°±æ­å»ºå¥½å•¦ï¼Œä¹‹åå°±æ˜¯ç¾åŒ–ä»€ä¹ˆçš„ï¼Œå¸Œæœ›å¤§å®¶éƒ½èƒ½é¡ºåˆ©æ­å»ºï¼</strong></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åšå®¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸€ç¯‡æ–‡ç« </title>
      <link href="/2024/10/29/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"/>
      <url>/2024/10/29/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå˜»å˜»"><a href="#è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå˜»å˜»" class="headerlink" title="è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå˜»å˜»"></a>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå˜»å˜»</h2>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
